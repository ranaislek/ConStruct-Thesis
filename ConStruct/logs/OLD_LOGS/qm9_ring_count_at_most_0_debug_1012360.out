torch version: 2.0.1+cu118
/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/torch/cuda/__init__.py:107: UserWarning: CUDA initialization: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero. (Triggered internally at ../c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() > 0
CUDA available: False
CUDA device: None
=== Running Experiment: ring_count_at_most_0_debug ===
Config: debug/edge_deletion/ring_count_at_most/qm9_debug_ring_count_at_most_0
Job ID: 1012360
Node: vgpu5-0
Time: Mon 11 Aug 2025 01:19:10 PM UTC
/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/torch/cuda/__init__.py:546: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/torch/cuda/__init__.py:651: UserWarning: CUDA initialization: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero. (Triggered internally at ../c10/cuda/CUDAFunctions.cpp:109.)
  return torch._C._cuda_getDeviceCount() if nvml_count < 0 else nvml_count
<frozen importlib._bootstrap>:228: RuntimeWarning: to-Python converter for std::pair<double, double> already registered; second conversion method ignored.
[rank: 0] Global seed set to 0
Loading reference metrics.
Edge-deletion transition model (for 'at most' constraints)
[INFO] Early stopping enabled: monitoring 'val/epoch_NLL' with patience 30
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Global seed set to 0
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
[2025-08-11 13:19:19,801][torch.distributed.distributed_c10d][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
[2025-08-11 13:19:19,802][torch.distributed.distributed_c10d][INFO] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
----------------------------------------------------------------------------------------------------
distributed_backend=gloo
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:615: UserWarning: Checkpoint directory checkpoints/qm9_debug_ring_count_at_most_0 exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")

  | Name                  | Type                  | Params
----------------------------------------------------------------
0 | train_loss            | TrainLoss             | 0     
1 | train_metrics         | TrainMolecularMetrics | 0     
2 | val_metrics           | MetricCollection      | 0     
3 | val_nll               | NLL                   | 0     
4 | val_sampling_metrics  | SamplingMetrics       | 0     
5 | test_metrics          | MetricCollection      | 0     
6 | test_nll              | NLL                   | 0     
7 | test_sampling_metrics | SamplingMetrics       | 0     
8 | model                 | GraphTransformer      | 1.9 M 
----------------------------------------------------------------
1.9 M     Trainable params
0         Non-trainable params
1.9 M     Total params
7.446     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Epoch 0: val/epoch_NLL: 137.87 -- val/X_kl: 10.83 -- val/E_kl: 113.67 -- val/charges_kl: 6.89 
Val loss: 137.8676 	 Best val loss:  137.8676

Val epoch 0 ends
Starting epoch 0
[2025-08-11 13:19:20,600][torch.nn.parallel.distributed][INFO] - Reducer buckets have been rebuilt in this iteration.
Train epoch 0 ends
Epoch 0 finished: X: 0.52 -- charges: 0.09 -- E: 0.41 -- y: -1.00 -- 643.6s 
Epoch 0: {'CarbonCE': 0.399, 'NitroCE': 0.238, 'OxyCE': 0.288, 'FluorCE': 0.015} -- {'NoBondCE': 0.343, 'SingleCE': 0.321, 'DoubleCE': 0.068, 'TripleCE': 0.027, 'AromaticCE': 0.005}
Starting epoch 1
Train epoch 1 ends
Epoch 1 finished: X: 0.48 -- charges: 0.08 -- E: 0.39 -- y: -1.00 -- 615.5s 
Epoch 1: {'CarbonCE': 0.373, 'NitroCE': 0.222, 'OxyCE': 0.268, 'FluorCE': 0.01} -- {'NoBondCE': 0.33, 'SingleCE': 0.309, 'DoubleCE': 0.061, 'TripleCE': 0.022, 'AromaticCE': 0.0}
Starting epoch 2
Epoch 2: val/epoch_NLL: 75.46 -- val/X_kl: 3.23 -- val/E_kl: 71.02 -- val/charges_kl: 0.66 
Val loss: 75.4591 	 Best val loss:  75.4591

Sampling start
Sampling a batch with 20 graphs on local rank 0. Saving 20 visualization and 5 full chains.
[2025-08-11 13:51:43,377][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0007s, mode=INCREMENTAL
[2025-08-11 13:51:48,560][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0007s, mode=INCREMENTAL
[2025-08-11 13:51:53,756][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0016s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch2/batch20_GR0/molecule_20_0.gif to wandb
2/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch2/batch20_GR0/molecule_21_0.gif to wandb
3/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch2/batch20_GR0/molecule_22_0.gif to wandb
4/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch2/batch20_GR0/molecule_23_0.gif to wandb
5/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch2/batch20_GR0/molecule_24_0.gif to wandb
Visualizing 20 graphs out of 20
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch2_b20/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch2_b20/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch2_b20/graph_2.png to wandb
Done.
Sampling a batch with 30 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-11 13:52:39,579][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0010s, mode=INCREMENTAL
[2025-08-11 13:52:46,151][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0012s, mode=INCREMENTAL
[2025-08-11 13:52:52,636][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0022s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 74.53 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 2, Kekulize 0, other 0,  -- No error 48
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: CC=NCC(C)OCO C=C(N)C[NH2+]CCCO CC(C)(C#CO)CO N=CNC(O)=C[NH-] N#CN=CNOC=CO COCC(N)=CCC#N CCCC(C)(C)NC=O CCNCOC(C)OC CCC(C)CC(C)CO CCC([NH-])C=CC(=O)O

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 50                     |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 48 (96.0%)             |
+---------------------------+------------------------+
| Invalid Molecules         | 2 (4.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 48/50       | 96.0%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 48/50       | 96.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 48/50       | 96.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 48/50       | 96.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 48/50       | 96.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 48/50       | 96.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 48/50       | 96.0%  |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 48/48       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 48/48       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 48/48       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 48/48       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 48/48       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 48/48       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 48/48       | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 48      | 96.0%        |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 48      | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+------------+
| Metric                    | Value      |
+===========================+============+
| Total Molecules Generated | 50         |
+---------------------------+------------+
| Valid Molecules (RDKit)   | 48 (96.0%) |
+---------------------------+------------+
| Invalid Molecules         | 2 (4.0%)   |
+---------------------------+------------+
| Disconnected Molecules    | 0.0%       |
+---------------------------+------------+
| Average Molecular Weight  | 125.4      |
+---------------------------+------------+
| Average Number of Atoms   | 8.7        |
+---------------------------+------------+
| Average Number of Bonds   | 7.7        |
+---------------------------+------------+
| Average Ring Count        | 0.0        |
+---------------------------+------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+-------------+
| Metric                   | Value       |
+==========================+=============+
| Valid Molecules (RDKit)  | 48 (96.0%)  |
+--------------------------+-------------+
| Unique Molecules         | 48 (100.0%) |
+--------------------------+-------------+
| Novel Molecules          | 48 (100.0%) |
+--------------------------+-------------+
| FCD Score                | 13.444      |
+--------------------------+-------------+
| Average Molecular Weight | 125.4       |
+--------------------------+-------------+
| Average Number of Atoms  | 8.7         |
+--------------------------+-------------+
| Average Number of Bonds  | 7.7         |
+--------------------------+-------------+
| Average Ring Count       | 0.0         |
+--------------------------+-------------+
| Average Ring Length      | 0.0         |
+--------------------------+-------------+
| Average Valency          | 3.5         |
+--------------------------+-------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 96.0%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | -4.0%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+---------------+
| Metric                 | Value         |
+========================+===============+
| Total Sampling Time    | 74.53 seconds |
+------------------------+---------------+
| Average Time per Batch | 37.26 seconds |
+------------------------+---------------+
| Number of Batches      | 2             |
+------------------------+---------------+

================================================================================

================================================================================
Val epoch 2 ends
Metric val/epoch_NLL improved. New best score: 75.459
Train epoch 2 ends
Epoch 2 finished: X: 0.48 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 756.2s 
Epoch 2: {'CarbonCE': 0.368, 'NitroCE': 0.22, 'OxyCE': 0.265, 'FluorCE': 0.01} -- {'NoBondCE': 0.327, 'SingleCE': 0.306, 'DoubleCE': 0.061, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 3
Train epoch 3 ends
Epoch 3 finished: X: 0.48 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 619.3s 
Epoch 3: {'CarbonCE': 0.367, 'NitroCE': 0.219, 'OxyCE': 0.265, 'FluorCE': 0.01} -- {'NoBondCE': 0.326, 'SingleCE': 0.304, 'DoubleCE': 0.06, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 4
Train epoch 4 ends
Epoch 4 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 617.2s 
Epoch 4: {'CarbonCE': 0.366, 'NitroCE': 0.218, 'OxyCE': 0.263, 'FluorCE': 0.009} -- {'NoBondCE': 0.326, 'SingleCE': 0.305, 'DoubleCE': 0.06, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 5
Epoch 5: val/epoch_NLL: 77.07 -- val/X_kl: 3.18 -- val/E_kl: 72.73 -- val/charges_kl: 0.63 
Val loss: 77.0715 	 Best val loss:  75.4591

Sampling start
Sampling a batch with 20 graphs on local rank 0. Saving 20 visualization and 5 full chains.
[2025-08-11 14:25:04,489][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0011s, mode=INCREMENTAL
[2025-08-11 14:25:10,652][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0010s, mode=INCREMENTAL
[2025-08-11 14:25:16,853][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0027s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch5/batch20_GR0/molecule_20_0.gif to wandb
2/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch5/batch20_GR0/molecule_21_0.gif to wandb
3/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch5/batch20_GR0/molecule_22_0.gif to wandb
4/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch5/batch20_GR0/molecule_23_0.gif to wandb
5/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch5/batch20_GR0/molecule_24_0.gif to wandb
Visualizing 20 graphs out of 20
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch5_b20/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch5_b20/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch5_b20/graph_2.png to wandb
Done.
Sampling a batch with 30 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-11 14:26:04,790][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0012s, mode=INCREMENTAL
[2025-08-11 14:26:11,411][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0009s, mode=INCREMENTAL
[2025-08-11 14:26:18,072][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0028s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 79.72 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 0, Kekulize 0, other 0,  -- No error 50
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: C#CCC(C)C=CCO CCCOC(C)CCC CCC(C)(CO)C(C)O NC(O)CO CC(=O)NC(N)=C(C)O CCC(C)CC(C)NC C#CC([NH-])C(O)CCC C#CC([NH-])OC#CC=O CC(=O)C(C)CC[NH3+] N#CC(N)CCCC=O

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 50                     |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 50 (100.0%)            |
+---------------------------+------------------------+
| Invalid Molecules         | 0 (0.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 50          |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 50 (100.0%) |
+---------------------------+-------------+
| Invalid Molecules         | 0 (0.0%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 0.0%        |
+---------------------------+-------------+
| Average Molecular Weight  | 125.9       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.8         |
+---------------------------+-------------+
| Average Number of Bonds   | 7.8         |
+---------------------------+-------------+
| Average Ring Count        | 0.0         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+-------------+
| Metric                   | Value       |
+==========================+=============+
| Valid Molecules (RDKit)  | 50 (100.0%) |
+--------------------------+-------------+
| Unique Molecules         | 50 (100.0%) |
+--------------------------+-------------+
| Novel Molecules          | 50 (100.0%) |
+--------------------------+-------------+
| FCD Score                | 13.698      |
+--------------------------+-------------+
| Average Molecular Weight | 125.9       |
+--------------------------+-------------+
| Average Number of Atoms  | 8.8         |
+--------------------------+-------------+
| Average Number of Bonds  | 7.8         |
+--------------------------+-------------+
| Average Ring Count       | 0.0         |
+--------------------------+-------------+
| Average Ring Length      | 0.0         |
+--------------------------+-------------+
| Average Valency          | 3.6         |
+--------------------------+-------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | 0.0%                                                                  |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 154.24 seconds |
+------------------------+----------------+
| Average Time per Batch | 38.56 seconds  |
+------------------------+----------------+
| Number of Batches      | 4              |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 5 ends
Train epoch 5 ends
Epoch 5 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 767.9s 
Epoch 5: {'CarbonCE': 0.365, 'NitroCE': 0.218, 'OxyCE': 0.263, 'FluorCE': 0.01} -- {'NoBondCE': 0.326, 'SingleCE': 0.305, 'DoubleCE': 0.06, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 6
Train epoch 6 ends
Epoch 6 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 647.1s 
Epoch 6: {'CarbonCE': 0.364, 'NitroCE': 0.216, 'OxyCE': 0.262, 'FluorCE': 0.01} -- {'NoBondCE': 0.325, 'SingleCE': 0.303, 'DoubleCE': 0.06, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 7
Train epoch 7 ends
Epoch 7 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 614.8s 
Epoch 7: {'CarbonCE': 0.364, 'NitroCE': 0.216, 'OxyCE': 0.263, 'FluorCE': 0.009} -- {'NoBondCE': 0.324, 'SingleCE': 0.303, 'DoubleCE': 0.06, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 8
Epoch 8: val/epoch_NLL: 74.14 -- val/X_kl: 3.19 -- val/E_kl: 69.85 -- val/charges_kl: 0.55 
Val loss: 74.1407 	 Best val loss:  74.1407

Sampling start
Sampling a batch with 20 graphs on local rank 0. Saving 20 visualization and 5 full chains.
[2025-08-11 14:58:30,651][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0007s, mode=INCREMENTAL
[2025-08-11 14:58:36,003][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0007s, mode=INCREMENTAL
[2025-08-11 14:58:41,355][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0014s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch8/batch20_GR0/molecule_20_0.gif to wandb
2/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch8/batch20_GR0/molecule_21_0.gif to wandb
3/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch8/batch20_GR0/molecule_22_0.gif to wandb
4/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch8/batch20_GR0/molecule_23_0.gif to wandb
5/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch8/batch20_GR0/molecule_24_0.gif to wandb
Visualizing 20 graphs out of 20
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch8_b20/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch8_b20/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch8_b20/graph_2.png to wandb
Done.
Sampling a batch with 30 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-11 14:59:28,163][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0010s, mode=INCREMENTAL
[2025-08-11 14:59:34,702][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0011s, mode=INCREMENTAL
[2025-08-11 14:59:41,309][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0024s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 75.94 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 1, Kekulize 0, other 0,  -- No error 49
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: CN=C(CO)NC(C)=O CCCC(CC)CCO CC#CC(O)C(=O)CC [CH2+][NH2+]C(C)(CC)CC#N CO[C+](C)CCOC[NH-] CC(O)CC(C)C(=O)O CNCOCNC(C)=N CCOCC(O)C(C)C CCCC(C)(C)CO CC(=N)C(N)=NO

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 50                     |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 49 (98.0%)             |
+---------------------------+------------------------+
| Invalid Molecules         | 1 (2.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 49/50       | 98.0%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 49/49       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 49      | 98.0%        |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 49      | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+------------+
| Metric                    | Value      |
+===========================+============+
| Total Molecules Generated | 50         |
+---------------------------+------------+
| Valid Molecules (RDKit)   | 49 (98.0%) |
+---------------------------+------------+
| Invalid Molecules         | 1 (2.0%)   |
+---------------------------+------------+
| Disconnected Molecules    | 0.0%       |
+---------------------------+------------+
| Average Molecular Weight  | 125.7      |
+---------------------------+------------+
| Average Number of Atoms   | 8.7        |
+---------------------------+------------+
| Average Number of Bonds   | 7.7        |
+---------------------------+------------+
| Average Ring Count        | 0.0        |
+---------------------------+------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+-------------+
| Metric                   | Value       |
+==========================+=============+
| Valid Molecules (RDKit)  | 49 (98.0%)  |
+--------------------------+-------------+
| Unique Molecules         | 49 (100.0%) |
+--------------------------+-------------+
| Novel Molecules          | 49 (100.0%) |
+--------------------------+-------------+
| FCD Score                | 14.664      |
+--------------------------+-------------+
| Average Molecular Weight | 125.7       |
+--------------------------+-------------+
| Average Number of Atoms  | 8.7         |
+--------------------------+-------------+
| Average Number of Bonds  | 7.7         |
+--------------------------+-------------+
| Average Ring Count       | 0.0         |
+--------------------------+-------------+
| Average Ring Length      | 0.0         |
+--------------------------+-------------+
| Average Valency          | 3.5         |
+--------------------------+-------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 98.0%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | -2.0%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 230.18 seconds |
+------------------------+----------------+
| Average Time per Batch | 38.36 seconds  |
+------------------------+----------------+
| Number of Batches      | 6              |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 8 ends
Metric val/epoch_NLL improved by 1.318 >= min_delta = 0.001. New best score: 74.141
Train epoch 8 ends
Epoch 8 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 741.3s 
Epoch 8: {'CarbonCE': 0.363, 'NitroCE': 0.215, 'OxyCE': 0.262, 'FluorCE': 0.009} -- {'NoBondCE': 0.323, 'SingleCE': 0.303, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 9
Train epoch 9 ends
Epoch 9 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 632.2s 
Epoch 9: {'CarbonCE': 0.361, 'NitroCE': 0.215, 'OxyCE': 0.261, 'FluorCE': 0.01} -- {'NoBondCE': 0.323, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 10
Train epoch 10 ends
Epoch 10 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 618.5s 
Epoch 10: {'CarbonCE': 0.361, 'NitroCE': 0.215, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.323, 'SingleCE': 0.302, 'DoubleCE': 0.06, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 11
Epoch 11: val/epoch_NLL: 73.54 -- val/X_kl: 3.18 -- val/E_kl: 69.17 -- val/charges_kl: 0.62 
Val loss: 73.5366 	 Best val loss:  73.5366

Sampling start
Sampling a batch with 20 graphs on local rank 0. Saving 20 visualization and 5 full chains.
[2025-08-11 15:31:44,286][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0009s, mode=INCREMENTAL
[2025-08-11 15:31:49,786][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0012s, mode=INCREMENTAL
[2025-08-11 15:31:56,019][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0020s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch11/batch20_GR0/molecule_20_0.gif to wandb
2/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch11/batch20_GR0/molecule_21_0.gif to wandb
3/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch11/batch20_GR0/molecule_22_0.gif to wandb
4/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch11/batch20_GR0/molecule_23_0.gif to wandb
5/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch11/batch20_GR0/molecule_24_0.gif to wandb
Visualizing 20 graphs out of 20
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch11_b20/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch11_b20/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch11_b20/graph_2.png to wandb
Done.
Sampling a batch with 30 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-11 15:32:42,273][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0011s, mode=INCREMENTAL
[2025-08-11 15:32:48,894][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0011s, mode=INCREMENTAL
[2025-08-11 15:32:55,597][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0027s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 76.59 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 1, Kekulize 0, other 0,  -- No error 49
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: NCCCCOC=O CCC(CO)C(C)C#N C#CC[NH2+]C(C)CC#C C#CC(N)C(CO)[NH2+]C CC(CO)N(C)C=N CCC(C)C(CO)CO CC(=O)COC(C)O C#CC(CO)CC(C)O C[NH2+]CC([NH-])COC=O CCOC(CC)[NH2+]C

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 50                     |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 49 (98.0%)             |
+---------------------------+------------------------+
| Invalid Molecules         | 1 (2.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 49/50       | 98.0%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 49/49       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 49      | 98.0%        |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 49      | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+------------+
| Metric                    | Value      |
+===========================+============+
| Total Molecules Generated | 50         |
+---------------------------+------------+
| Valid Molecules (RDKit)   | 49 (98.0%) |
+---------------------------+------------+
| Invalid Molecules         | 1 (2.0%)   |
+---------------------------+------------+
| Disconnected Molecules    | 0.0%       |
+---------------------------+------------+
| Average Molecular Weight  | 127.2      |
+---------------------------+------------+
| Average Number of Atoms   | 8.8        |
+---------------------------+------------+
| Average Number of Bonds   | 7.8        |
+---------------------------+------------+
| Average Ring Count        | 0.0        |
+---------------------------+------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+-------------+
| Metric                   | Value       |
+==========================+=============+
| Valid Molecules (RDKit)  | 49 (98.0%)  |
+--------------------------+-------------+
| Unique Molecules         | 49 (100.0%) |
+--------------------------+-------------+
| Novel Molecules          | 49 (100.0%) |
+--------------------------+-------------+
| FCD Score                | 14.647      |
+--------------------------+-------------+
| Average Molecular Weight | 127.2       |
+--------------------------+-------------+
| Average Number of Atoms  | 8.8         |
+--------------------------+-------------+
| Average Number of Bonds  | 7.8         |
+--------------------------+-------------+
| Average Ring Count       | 0.0         |
+--------------------------+-------------+
| Average Ring Length      | 0.0         |
+--------------------------+-------------+
| Average Valency          | 3.6         |
+--------------------------+-------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 98.0%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | -2.0%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 306.76 seconds |
+------------------------+----------------+
| Average Time per Batch | 38.35 seconds  |
+------------------------+----------------+
| Number of Batches      | 8              |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 11 ends
Metric val/epoch_NLL improved by 0.604 >= min_delta = 0.001. New best score: 73.537
Train epoch 11 ends
Epoch 11 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 743.6s 
Epoch 11: {'CarbonCE': 0.362, 'NitroCE': 0.215, 'OxyCE': 0.262, 'FluorCE': 0.009} -- {'NoBondCE': 0.323, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 12
Train epoch 12 ends
Epoch 12 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 647.6s 
Epoch 12: {'CarbonCE': 0.36, 'NitroCE': 0.214, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 13
Train epoch 13 ends
Epoch 13 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 615.4s 
Epoch 13: {'CarbonCE': 0.36, 'NitroCE': 0.214, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 14
Epoch 14: val/epoch_NLL: 72.20 -- val/X_kl: 3.22 -- val/E_kl: 67.84 -- val/charges_kl: 0.60 
Val loss: 72.2048 	 Best val loss:  72.2048

Sampling start
Sampling a batch with 20 graphs on local rank 0. Saving 20 visualization and 5 full chains.
[2025-08-11 16:05:14,866][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0007s, mode=INCREMENTAL
[2025-08-11 16:05:20,236][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0008s, mode=INCREMENTAL
[2025-08-11 16:05:25,616][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0016s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch20_GR0/molecule_20_0.gif to wandb
2/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch20_GR0/molecule_21_0.gif to wandb
3/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch20_GR0/molecule_22_0.gif to wandb
4/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch20_GR0/molecule_23_0.gif to wandb
5/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch20_GR0/molecule_24_0.gif to wandb
Visualizing 20 graphs out of 20
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch14_b20/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch14_b20/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch14_b20/graph_2.png to wandb
Done.
Sampling a batch with 30 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-11 16:06:12,461][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0011s, mode=INCREMENTAL
[2025-08-11 16:06:18,977][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0013s, mode=INCREMENTAL
[2025-08-11 16:06:25,529][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0012s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 76.00 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 0, Kekulize 0, other 0,  -- No error 50
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: CCC(C)C(O)CC=O C#CCOC([NH-])CC=O CCNC(CO)CCO C[NH2+]CCC(C)C[NH2+]C CC(O)C(C)(C#N)C=O COC(CO)=C(C)C=O COC(C)CCCCO CCC[NH2+]C(C=O)CC NC(=O)NCC(N)CO CC(O)C(C)(C)O

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 50                     |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 50 (100.0%)            |
+---------------------------+------------------------+
| Invalid Molecules         | 0 (0.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 50          |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 50 (100.0%) |
+---------------------------+-------------+
| Invalid Molecules         | 0 (0.0%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 0.0%        |
+---------------------------+-------------+
| Average Molecular Weight  | 126.6       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.8         |
+---------------------------+-------------+
| Average Number of Bonds   | 7.8         |
+---------------------------+-------------+
| Average Ring Count        | 0.0         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+-------------+
| Metric                   | Value       |
+==========================+=============+
| Valid Molecules (RDKit)  | 50 (100.0%) |
+--------------------------+-------------+
| Unique Molecules         | 50 (100.0%) |
+--------------------------+-------------+
| Novel Molecules          | 50 (100.0%) |
+--------------------------+-------------+
| FCD Score                | 14.949      |
+--------------------------+-------------+
| Average Molecular Weight | 126.6       |
+--------------------------+-------------+
| Average Number of Atoms  | 8.8         |
+--------------------------+-------------+
| Average Number of Bonds  | 7.8         |
+--------------------------+-------------+
| Average Ring Count       | 0.0         |
+--------------------------+-------------+
| Average Ring Length      | 0.0         |
+--------------------------+-------------+
| Average Valency          | 3.5         |
+--------------------------+-------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | 0.0%                                                                  |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 382.76 seconds |
+------------------------+----------------+
| Average Time per Batch | 38.28 seconds  |
+------------------------+----------------+
| Number of Batches      | 10             |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 14 ends
Metric val/epoch_NLL improved by 1.332 >= min_delta = 0.001. New best score: 72.205
Train epoch 14 ends
Epoch 14 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 747.0s 
Epoch 14: {'CarbonCE': 0.36, 'NitroCE': 0.215, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 15
Train epoch 15 ends
Epoch 15 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 622.7s 
Epoch 15: {'CarbonCE': 0.361, 'NitroCE': 0.214, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 16
slurmstepd-vgpu5-0: error: *** JOB 1012360 ON vgpu5-0 CANCELLED AT 2025-08-11T16:17:42 ***
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
