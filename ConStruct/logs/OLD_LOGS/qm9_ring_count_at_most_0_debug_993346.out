torch version: 2.0.1+cu118
CUDA available: True
CUDA device: NVIDIA RTX A5000
=== Running Experiment: ring_count_at_most_0_debug ===
Config: debug/edge_deletion/ring_count_at_most/qm9_debug_ring_count_at_most_0
Job ID: 993346
Node: vgpu0-1
Time: Sun 10 Aug 2025 09:16:17 PM UTC
<frozen importlib._bootstrap>:228: RuntimeWarning: to-Python converter for std::pair<double, double> already registered; second conversion method ignored.
[rank: 0] Global seed set to 0
Loading reference metrics.
Edge-deletion transition model (for 'at most' constraints)
[INFO] Early stopping enabled: monitoring 'val/epoch_NLL' with patience 30
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Global seed set to 0
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
[2025-08-10 21:16:26,622][torch.distributed.distributed_c10d][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
[2025-08-10 21:16:26,622][torch.distributed.distributed_c10d][INFO] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA RTX A5000') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:615: UserWarning: Checkpoint directory checkpoints/qm9_debug_ring_count_at_most_0 exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                  | Params
----------------------------------------------------------------
0 | train_loss            | TrainLoss             | 0     
1 | train_metrics         | TrainMolecularMetrics | 0     
2 | val_metrics           | MetricCollection      | 0     
3 | val_nll               | NLL                   | 0     
4 | val_sampling_metrics  | SamplingMetrics       | 0     
5 | test_metrics          | MetricCollection      | 0     
6 | test_nll              | NLL                   | 0     
7 | test_sampling_metrics | SamplingMetrics       | 0     
8 | model                 | GraphTransformer      | 1.9 M 
----------------------------------------------------------------
1.9 M     Trainable params
0         Non-trainable params
1.9 M     Total params
7.446     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Epoch 0: val/epoch_NLL: 127.32 -- val/X_kl: 7.40 -- val/E_kl: 108.43 -- val/charges_kl: 5.01 
Val loss: 127.3223 	 Best val loss:  127.3223

Val epoch 0 ends
Starting epoch 0
[2025-08-10 21:16:28,304][torch.nn.parallel.distributed][INFO] - Reducer buckets have been rebuilt in this iteration.
Train epoch 0 ends
Epoch 0 finished: X: 0.52 -- charges: 0.09 -- E: 0.41 -- y: -1.00 -- 399.1s 
Epoch 0: {'CarbonCE': 0.398, 'NitroCE': 0.238, 'OxyCE': 0.287, 'FluorCE': 0.015} -- {'NoBondCE': 0.342, 'SingleCE': 0.32, 'DoubleCE': 0.068, 'TripleCE': 0.027, 'AromaticCE': 0.005}
Starting epoch 1
Train epoch 1 ends
Epoch 1 finished: X: 0.48 -- charges: 0.09 -- E: 0.39 -- y: -1.00 -- 379.8s 
Epoch 1: {'CarbonCE': 0.372, 'NitroCE': 0.222, 'OxyCE': 0.268, 'FluorCE': 0.01} -- {'NoBondCE': 0.33, 'SingleCE': 0.309, 'DoubleCE': 0.062, 'TripleCE': 0.022, 'AromaticCE': 0.0}
Starting epoch 2
Epoch 2: val/epoch_NLL: 74.49 -- val/X_kl: 3.25 -- val/E_kl: 70.00 -- val/charges_kl: 0.69 
Val loss: 74.4947 	 Best val loss:  74.4947

Sampling start
Sampling a batch with 20 graphs on local rank 0. Saving 20 visualization and 5 full chains.
[2025-08-10 21:36:32,516][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0020s, mode=INCREMENTAL
[2025-08-10 21:36:36,942][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0016s, mode=INCREMENTAL
[2025-08-10 21:36:41,379][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0026s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch2/batch20_GR0/molecule_20_0.gif to wandb
2/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch2/batch20_GR0/molecule_21_0.gif to wandb
3/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch2/batch20_GR0/molecule_22_0.gif to wandb
4/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch2/batch20_GR0/molecule_23_0.gif to wandb
5/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch2/batch20_GR0/molecule_24_0.gif to wandb
Visualizing 20 graphs out of 20
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch2_b20/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch2_b20/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch2_b20/graph_2.png to wandb
Done.
Sampling a batch with 30 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-10 21:37:26,350][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0025s, mode=INCREMENTAL
[2025-08-10 21:37:30,950][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0025s, mode=INCREMENTAL
[2025-08-10 21:37:35,580][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0068s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 67.52 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 0, Kekulize 0, other 0,  -- No error 50
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: CCC(C)(C#N)N(C)N CCC(CC)C(O)CO CC(C)(N)C(C#N)C=O CCNC=CC([NH3+])C=O CC=CCC(=O)C([NH3+])O C#CCNNC(=O)C#N C#CC([NH-])N(C)CC=O CC[NH2+]COC(C)C=O CNC=CCOC(C)=O N#CCN=CC=NN=N

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 50                     |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 50 (100.0%)            |
+---------------------------+------------------------+
| Invalid Molecules         | 0 (0.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 50          |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 50 (100.0%) |
+---------------------------+-------------+
| Invalid Molecules         | 0 (0.0%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 0.0%        |
+---------------------------+-------------+
| Average Molecular Weight  | 127.4       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.9         |
+---------------------------+-------------+
| Average Number of Bonds   | 7.9         |
+---------------------------+-------------+
| Average Ring Count        | 0.0         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+-------------+
| Metric                   | Value       |
+==========================+=============+
| Valid Molecules (RDKit)  | 50 (100.0%) |
+--------------------------+-------------+
| Unique Molecules         | 50 (100.0%) |
+--------------------------+-------------+
| Novel Molecules          | 50 (100.0%) |
+--------------------------+-------------+
| FCD Score                | 14.068      |
+--------------------------+-------------+
| Average Molecular Weight | 127.4       |
+--------------------------+-------------+
| Average Number of Atoms  | 8.9         |
+--------------------------+-------------+
| Average Number of Bonds  | 7.9         |
+--------------------------+-------------+
| Average Ring Count       | 0.0         |
+--------------------------+-------------+
| Average Ring Length      | 0.0         |
+--------------------------+-------------+
| Average Valency          | 3.6         |
+--------------------------+-------------+

üß™ CHEMICAL VALIDATION METRICS (ALL Generated Molecules):
+------------------------+--------+----------------------------------------------------+
| Metric                 | Rate   | Description                                        |
+========================+========+====================================================+
| Structurally Valid     | 100.0% | Basic graph structure (atoms > 0, bonds ‚â• 0)       |
+------------------------+--------+----------------------------------------------------+
| Chemically Valid       | 76.0%  | Passes valency, connectivity, and atom type checks |
+------------------------+--------+----------------------------------------------------+
| RDKit Valid            | 100.0% | Can be parsed by RDKit library                     |
+------------------------+--------+----------------------------------------------------+
| Valency Violations     | 24.0%  | Atoms with incorrect valence                       |
+------------------------+--------+----------------------------------------------------+
| Disconnected Molecules | 0.0%   | Molecules with multiple disconnected components    |
+------------------------+--------+----------------------------------------------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | 0.0%                                                                  |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+---------------+
| Metric                 | Value         |
+========================+===============+
| Total Sampling Time    | 67.52 seconds |
+------------------------+---------------+
| Average Time per Batch | 33.76 seconds |
+------------------------+---------------+
| Number of Batches      | 2             |
+------------------------+---------------+

================================================================================

================================================================================
Val epoch 2 ends
Metric val/epoch_NLL improved. New best score: 74.495
Train epoch 2 ends
Epoch 2 finished: X: 0.48 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 491.7s 
Epoch 2: {'CarbonCE': 0.368, 'NitroCE': 0.219, 'OxyCE': 0.265, 'FluorCE': 0.01} -- {'NoBondCE': 0.326, 'SingleCE': 0.305, 'DoubleCE': 0.06, 'TripleCE': 0.022, 'AromaticCE': 0.0}
Starting epoch 3
Train epoch 3 ends
Epoch 3 finished: X: 0.48 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 384.2s 
Epoch 3: {'CarbonCE': 0.368, 'NitroCE': 0.219, 'OxyCE': 0.265, 'FluorCE': 0.01} -- {'NoBondCE': 0.327, 'SingleCE': 0.306, 'DoubleCE': 0.06, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 4
Train epoch 4 ends
Epoch 4 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 383.6s 
Epoch 4: {'CarbonCE': 0.365, 'NitroCE': 0.218, 'OxyCE': 0.263, 'FluorCE': 0.009} -- {'NoBondCE': 0.326, 'SingleCE': 0.305, 'DoubleCE': 0.06, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 5
Epoch 5: val/epoch_NLL: 77.77 -- val/X_kl: 3.22 -- val/E_kl: 73.38 -- val/charges_kl: 0.62 
Val loss: 77.7746 	 Best val loss:  74.4947

Sampling start
Sampling a batch with 20 graphs on local rank 0. Saving 20 visualization and 5 full chains.
[2025-08-10 21:57:32,274][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0017s, mode=INCREMENTAL
[2025-08-10 21:57:36,765][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0018s, mode=INCREMENTAL
[2025-08-10 21:57:41,269][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0034s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch5/batch20_GR0/molecule_20_0.gif to wandb
2/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch5/batch20_GR0/molecule_21_0.gif to wandb
3/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch5/batch20_GR0/molecule_22_0.gif to wandb
4/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch5/batch20_GR0/molecule_23_0.gif to wandb
5/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch5/batch20_GR0/molecule_24_0.gif to wandb
Visualizing 20 graphs out of 20
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch5_b20/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch5_b20/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch5_b20/graph_2.png to wandb
Done.
Sampling a batch with 30 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-10 21:58:24,931][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0026s, mode=INCREMENTAL
[2025-08-10 21:58:29,574][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0026s, mode=INCREMENTAL
[2025-08-10 21:58:34,246][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0049s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 66.50 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 1, Kekulize 0, other 0,  -- No error 49
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: C=CCC(O)CCCO C#CC(C=CCO)CN CCC(C)CC(C)[NH2+]C CC(C)COCNC=O [NH-]C(C=O)OCC=O CCC(CCOC)OC CCCOCOC(C)C C#CC(C)N COC(=N)N(C)C(=N)O CCC(O)CN(C)CC

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 50                     |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 49 (98.0%)             |
+---------------------------+------------------------+
| Invalid Molecules         | 1 (2.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 49/50       | 98.0%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 49/50       | 98.0%  |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 49/49       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 49/49       | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 49      | 98.0%        |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 49      | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+------------+
| Metric                    | Value      |
+===========================+============+
| Total Molecules Generated | 50         |
+---------------------------+------------+
| Valid Molecules (RDKit)   | 49 (98.0%) |
+---------------------------+------------+
| Invalid Molecules         | 1 (2.0%)   |
+---------------------------+------------+
| Disconnected Molecules    | 0.0%       |
+---------------------------+------------+
| Average Molecular Weight  | 127.2      |
+---------------------------+------------+
| Average Number of Atoms   | 8.8        |
+---------------------------+------------+
| Average Number of Bonds   | 7.8        |
+---------------------------+------------+
| Average Ring Count        | 0.0        |
+---------------------------+------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+-------------+
| Metric                   | Value       |
+==========================+=============+
| Valid Molecules (RDKit)  | 49 (98.0%)  |
+--------------------------+-------------+
| Unique Molecules         | 49 (100.0%) |
+--------------------------+-------------+
| Novel Molecules          | 49 (100.0%) |
+--------------------------+-------------+
| FCD Score                | 13.767      |
+--------------------------+-------------+
| Average Molecular Weight | 127.2       |
+--------------------------+-------------+
| Average Number of Atoms  | 8.8         |
+--------------------------+-------------+
| Average Number of Bonds  | 7.8         |
+--------------------------+-------------+
| Average Ring Count       | 0.0         |
+--------------------------+-------------+
| Average Ring Length      | 0.0         |
+--------------------------+-------------+
| Average Valency          | 3.5         |
+--------------------------+-------------+

üß™ CHEMICAL VALIDATION METRICS (ALL Generated Molecules):
+------------------------+--------+----------------------------------------------------+
| Metric                 | Rate   | Description                                        |
+========================+========+====================================================+
| Structurally Valid     | 98.0%  | Basic graph structure (atoms > 0, bonds ‚â• 0)       |
+------------------------+--------+----------------------------------------------------+
| Chemically Valid       | 78.0%  | Passes valency, connectivity, and atom type checks |
+------------------------+--------+----------------------------------------------------+
| RDKit Valid            | 98.0%  | Can be parsed by RDKit library                     |
+------------------------+--------+----------------------------------------------------+
| Valency Violations     | 20.0%  | Atoms with incorrect valence                       |
+------------------------+--------+----------------------------------------------------+
| Disconnected Molecules | 0.0%   | Molecules with multiple disconnected components    |
+------------------------+--------+----------------------------------------------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 98.0%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | -2.0%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 134.01 seconds |
+------------------------+----------------+
| Average Time per Batch | 33.50 seconds  |
+------------------------+----------------+
| Number of Batches      | 4              |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 5 ends
Train epoch 5 ends
Epoch 5 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 489.8s 
Epoch 5: {'CarbonCE': 0.363, 'NitroCE': 0.216, 'OxyCE': 0.261, 'FluorCE': 0.01} -- {'NoBondCE': 0.325, 'SingleCE': 0.304, 'DoubleCE': 0.06, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 6
Train epoch 6 ends
Epoch 6 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 386.3s 
Epoch 6: {'CarbonCE': 0.363, 'NitroCE': 0.217, 'OxyCE': 0.262, 'FluorCE': 0.009} -- {'NoBondCE': 0.325, 'SingleCE': 0.304, 'DoubleCE': 0.06, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 7
Train epoch 7 ends
Epoch 7 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 386.3s 
Epoch 7: {'CarbonCE': 0.362, 'NitroCE': 0.216, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.324, 'SingleCE': 0.303, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 8
Epoch 8: val/epoch_NLL: 73.73 -- val/X_kl: 3.19 -- val/E_kl: 69.43 -- val/charges_kl: 0.56 
Val loss: 73.7274 	 Best val loss:  73.7274

Sampling start
Sampling a batch with 20 graphs on local rank 0. Saving 20 visualization and 5 full chains.
[2025-08-10 22:18:36,792][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0018s, mode=INCREMENTAL
[2025-08-10 22:18:41,276][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0016s, mode=INCREMENTAL
[2025-08-10 22:18:45,776][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0032s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch8/batch20_GR0/molecule_20_0.gif to wandb
2/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch8/batch20_GR0/molecule_21_0.gif to wandb
3/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch8/batch20_GR0/molecule_22_0.gif to wandb
4/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch8/batch20_GR0/molecule_23_0.gif to wandb
5/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch8/batch20_GR0/molecule_24_0.gif to wandb
Visualizing 20 graphs out of 20
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch8_b20/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch8_b20/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch8_b20/graph_2.png to wandb
Done.
Sampling a batch with 30 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-10 22:19:30,075][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0025s, mode=INCREMENTAL
[2025-08-10 22:19:34,736][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0026s, mode=INCREMENTAL
[2025-08-10 22:19:39,405][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0055s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 67.12 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 0, Kekulize 0, other 0,  -- No error 50
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: C#CC=C(N)C(=O)CC COC=N[C+]([NH-])[N-]C=O NC(O)=C=NC(=O)CO C#CC(C=C)CCCC CC(C)CC(CN)CO CCC(O)C(C)(C)CC CC(C)CC(C)CCO CC(C)CNC(C)CN CCC(C)CC=CCO C#CC(CC[NH2+]C)NN

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 50                     |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 50 (100.0%)            |
+---------------------------+------------------------+
| Invalid Molecules         | 0 (0.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 50          |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 50 (100.0%) |
+---------------------------+-------------+
| Invalid Molecules         | 0 (0.0%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 0.0%        |
+---------------------------+-------------+
| Average Molecular Weight  | 123.9       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.7         |
+---------------------------+-------------+
| Average Number of Bonds   | 7.7         |
+---------------------------+-------------+
| Average Ring Count        | 0.0         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+-------------+
| Metric                   | Value       |
+==========================+=============+
| Valid Molecules (RDKit)  | 50 (100.0%) |
+--------------------------+-------------+
| Unique Molecules         | 50 (100.0%) |
+--------------------------+-------------+
| Novel Molecules          | 50 (100.0%) |
+--------------------------+-------------+
| FCD Score                | 14.210      |
+--------------------------+-------------+
| Average Molecular Weight | 123.9       |
+--------------------------+-------------+
| Average Number of Atoms  | 8.7         |
+--------------------------+-------------+
| Average Number of Bonds  | 7.7         |
+--------------------------+-------------+
| Average Ring Count       | 0.0         |
+--------------------------+-------------+
| Average Ring Length      | 0.0         |
+--------------------------+-------------+
| Average Valency          | 3.6         |
+--------------------------+-------------+

üß™ CHEMICAL VALIDATION METRICS (ALL Generated Molecules):
+------------------------+--------+----------------------------------------------------+
| Metric                 | Rate   | Description                                        |
+========================+========+====================================================+
| Structurally Valid     | 100.0% | Basic graph structure (atoms > 0, bonds ‚â• 0)       |
+------------------------+--------+----------------------------------------------------+
| Chemically Valid       | 88.0%  | Passes valency, connectivity, and atom type checks |
+------------------------+--------+----------------------------------------------------+
| RDKit Valid            | 100.0% | Can be parsed by RDKit library                     |
+------------------------+--------+----------------------------------------------------+
| Valency Violations     | 12.0%  | Atoms with incorrect valence                       |
+------------------------+--------+----------------------------------------------------+
| Disconnected Molecules | 0.0%   | Molecules with multiple disconnected components    |
+------------------------+--------+----------------------------------------------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | 0.0%                                                                  |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 201.12 seconds |
+------------------------+----------------+
| Average Time per Batch | 33.52 seconds  |
+------------------------+----------------+
| Number of Batches      | 6              |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 8 ends
Metric val/epoch_NLL improved by 0.767 >= min_delta = 0.001. New best score: 73.727
Train epoch 8 ends
Epoch 8 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 492.4s 
Epoch 8: {'CarbonCE': 0.36, 'NitroCE': 0.215, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 9
Train epoch 9 ends
Epoch 9 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 386.3s 
Epoch 9: {'CarbonCE': 0.362, 'NitroCE': 0.216, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.323, 'SingleCE': 0.303, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 10
Train epoch 10 ends
Epoch 10 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 385.8s 
Epoch 10: {'CarbonCE': 0.36, 'NitroCE': 0.215, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.323, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 11
Epoch 11: val/epoch_NLL: 72.72 -- val/X_kl: 3.18 -- val/E_kl: 68.35 -- val/charges_kl: 0.64 
Val loss: 72.7156 	 Best val loss:  72.7156

Sampling start
Sampling a batch with 20 graphs on local rank 0. Saving 20 visualization and 5 full chains.
[2025-08-10 22:39:41,862][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0018s, mode=INCREMENTAL
[2025-08-10 22:39:46,290][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0016s, mode=INCREMENTAL
[2025-08-10 22:39:50,740][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0044s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch11/batch20_GR0/molecule_20_0.gif to wandb
2/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch11/batch20_GR0/molecule_21_0.gif to wandb
3/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch11/batch20_GR0/molecule_22_0.gif to wandb
4/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch11/batch20_GR0/molecule_23_0.gif to wandb
5/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch11/batch20_GR0/molecule_24_0.gif to wandb
Visualizing 20 graphs out of 20
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch11_b20/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch11_b20/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch11_b20/graph_2.png to wandb
Done.
Sampling a batch with 30 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-10 22:40:35,252][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0028s, mode=INCREMENTAL
[2025-08-10 22:40:39,862][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0023s, mode=INCREMENTAL
[2025-08-10 22:40:44,507][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0057s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 67.10 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 0, Kekulize 0, other 0,  -- No error 50
Some generated smiles: CCC(C)OC([NH-])CC O=CN=N[NH+]=C(O)CO C=NOC(C)(C)CCC COCCC(N)OC=O C=C(C)COCC(C)O CNC(C=O)CCCO CC=C(CC)C(=O)CO CC(O)=C(CN)OC[NH-] CC(CN)COCC=O C#CC(CO)CCC=O

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 50                     |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 50 (100.0%)            |
+---------------------------+------------------------+
| Invalid Molecules         | 0 (0.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 50          |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 50 (100.0%) |
+---------------------------+-------------+
| Invalid Molecules         | 0 (0.0%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 0.0%        |
+---------------------------+-------------+
| Average Molecular Weight  | 127.0       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.9         |
+---------------------------+-------------+
| Average Number of Bonds   | 7.9         |
+---------------------------+-------------+
| Average Ring Count        | 0.0         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+-------------+
| Metric                   | Value       |
+==========================+=============+
| Valid Molecules (RDKit)  | 50 (100.0%) |
+--------------------------+-------------+
| Unique Molecules         | 50 (100.0%) |
+--------------------------+-------------+
| Novel Molecules          | 50 (100.0%) |
+--------------------------+-------------+
| FCD Score                | 13.820      |
+--------------------------+-------------+
| Average Molecular Weight | 127.0       |
+--------------------------+-------------+
| Average Number of Atoms  | 8.9         |
+--------------------------+-------------+
| Average Number of Bonds  | 7.9         |
+--------------------------+-------------+
| Average Ring Count       | 0.0         |
+--------------------------+-------------+
| Average Ring Length      | 0.0         |
+--------------------------+-------------+
| Average Valency          | 3.5         |
+--------------------------+-------------+

üß™ CHEMICAL VALIDATION METRICS (ALL Generated Molecules):
+------------------------+--------+----------------------------------------------------+
| Metric                 | Rate   | Description                                        |
+========================+========+====================================================+
| Structurally Valid     | 100.0% | Basic graph structure (atoms > 0, bonds ‚â• 0)       |
+------------------------+--------+----------------------------------------------------+
| Chemically Valid       | 72.0%  | Passes valency, connectivity, and atom type checks |
+------------------------+--------+----------------------------------------------------+
| RDKit Valid            | 100.0% | Can be parsed by RDKit library                     |
+------------------------+--------+----------------------------------------------------+
| Valency Violations     | 28.0%  | Atoms with incorrect valence                       |
+------------------------+--------+----------------------------------------------------+
| Disconnected Molecules | 0.0%   | Molecules with multiple disconnected components    |
+------------------------+--------+----------------------------------------------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | 0.0%                                                                  |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 268.21 seconds |
+------------------------+----------------+
| Average Time per Batch | 33.53 seconds  |
+------------------------+----------------+
| Number of Batches      | 8              |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 11 ends
Metric val/epoch_NLL improved by 1.012 >= min_delta = 0.001. New best score: 72.716
Train epoch 11 ends
Epoch 11 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 493.0s 
Epoch 11: {'CarbonCE': 0.361, 'NitroCE': 0.216, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.323, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 12
Train epoch 12 ends
Epoch 12 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 390.3s 
Epoch 12: {'CarbonCE': 0.361, 'NitroCE': 0.214, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 13
Train epoch 13 ends
Epoch 13 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 384.9s 
Epoch 13: {'CarbonCE': 0.361, 'NitroCE': 0.215, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 14
Epoch 14: val/epoch_NLL: 72.87 -- val/X_kl: 3.11 -- val/E_kl: 68.64 -- val/charges_kl: 0.58 
Val loss: 72.8705 	 Best val loss:  72.7156

Sampling start
Sampling a batch with 20 graphs on local rank 0. Saving 20 visualization and 5 full chains.
[2025-08-10 23:00:52,786][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0018s, mode=INCREMENTAL
[2025-08-10 23:00:57,266][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0016s, mode=INCREMENTAL
[2025-08-10 23:01:01,720][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0036s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch20_GR0/molecule_20_0.gif to wandb
2/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch20_GR0/molecule_21_0.gif to wandb
3/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch20_GR0/molecule_22_0.gif to wandb
4/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch20_GR0/molecule_23_0.gif to wandb
5/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch20_GR0/molecule_24_0.gif to wandb
Visualizing 20 graphs out of 20
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch14_b20/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch14_b20/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch14_b20/graph_2.png to wandb
Done.
Sampling a batch with 30 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-10 23:01:45,554][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0025s, mode=INCREMENTAL
[2025-08-10 23:01:50,135][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0024s, mode=INCREMENTAL
[2025-08-10 23:01:54,740][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0058s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 66.43 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 0, Kekulize 0, other 0,  -- No error 50
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: [CH2+][NH2+]C(O)CCC=O CCCC(C)([NH3+])C(C)C OCCCCOCCO CCC=CC(C)(C)CC COC(C)(C)C(C)CO CC#CC(=O)C(C)NC CC(C)C(CO)C(C)N CCC(C)[NH+](C)CC CC(=O)NC(C)C#N CCCC(C)(C)OC=O

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 50                     |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 50 (100.0%)            |
+---------------------------+------------------------+
| Invalid Molecules         | 0 (0.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 50          |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 50 (100.0%) |
+---------------------------+-------------+
| Invalid Molecules         | 0 (0.0%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 0.0%        |
+---------------------------+-------------+
| Average Molecular Weight  | 126.2       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.8         |
+---------------------------+-------------+
| Average Number of Bonds   | 7.8         |
+---------------------------+-------------+
| Average Ring Count        | 0.0         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+-------------+
| Metric                   | Value       |
+==========================+=============+
| Valid Molecules (RDKit)  | 50 (100.0%) |
+--------------------------+-------------+
| Unique Molecules         | 50 (100.0%) |
+--------------------------+-------------+
| Novel Molecules          | 50 (100.0%) |
+--------------------------+-------------+
| FCD Score                | 13.967      |
+--------------------------+-------------+
| Average Molecular Weight | 126.2       |
+--------------------------+-------------+
| Average Number of Atoms  | 8.8         |
+--------------------------+-------------+
| Average Number of Bonds  | 7.8         |
+--------------------------+-------------+
| Average Ring Count       | 0.0         |
+--------------------------+-------------+
| Average Ring Length      | 0.0         |
+--------------------------+-------------+
| Average Valency          | 3.6         |
+--------------------------+-------------+

üß™ CHEMICAL VALIDATION METRICS (ALL Generated Molecules):
+------------------------+--------+----------------------------------------------------+
| Metric                 | Rate   | Description                                        |
+========================+========+====================================================+
| Structurally Valid     | 100.0% | Basic graph structure (atoms > 0, bonds ‚â• 0)       |
+------------------------+--------+----------------------------------------------------+
| Chemically Valid       | 82.0%  | Passes valency, connectivity, and atom type checks |
+------------------------+--------+----------------------------------------------------+
| RDKit Valid            | 100.0% | Can be parsed by RDKit library                     |
+------------------------+--------+----------------------------------------------------+
| Valency Violations     | 18.0%  | Atoms with incorrect valence                       |
+------------------------+--------+----------------------------------------------------+
| Disconnected Molecules | 0.0%   | Molecules with multiple disconnected components    |
+------------------------+--------+----------------------------------------------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | 0.0%                                                                  |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 334.63 seconds |
+------------------------+----------------+
| Average Time per Batch | 33.46 seconds  |
+------------------------+----------------+
| Number of Batches      | 10             |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 14 ends
Train epoch 14 ends
Epoch 14 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 495.0s 
Epoch 14: {'CarbonCE': 0.36, 'NitroCE': 0.214, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 15
Train epoch 15 ends
Epoch 15 finished: X: 0.46 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 382.0s 
Epoch 15: {'CarbonCE': 0.359, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 16
Train epoch 16 ends
Epoch 16 finished: X: 0.46 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 387.5s 
Epoch 16: {'CarbonCE': 0.359, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 17
Epoch 17: val/epoch_NLL: 75.46 -- val/X_kl: 3.15 -- val/E_kl: 71.15 -- val/charges_kl: 0.58 
Val loss: 75.4584 	 Best val loss:  72.7156

Sampling start
Sampling a batch with 20 graphs on local rank 0. Saving 20 visualization and 5 full chains.
[2025-08-10 23:21:50,538][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0017s, mode=INCREMENTAL
[2025-08-10 23:21:55,030][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0017s, mode=INCREMENTAL
[2025-08-10 23:21:59,530][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0036s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch17/batch20_GR0/molecule_20_0.gif to wandb
2/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch17/batch20_GR0/molecule_21_0.gif to wandb
3/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch17/batch20_GR0/molecule_22_0.gif to wandb
4/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch17/batch20_GR0/molecule_23_0.gif to wandb
5/5 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch17/batch20_GR0/molecule_24_0.gif to wandb
Visualizing 20 graphs out of 20
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch17_b20/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch17_b20/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch17_b20/graph_2.png to wandb
Done.
Sampling a batch with 30 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-10 23:22:43,727][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0025s, mode=INCREMENTAL
[2025-08-10 23:22:48,319][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0025s, mode=INCREMENTAL
[2025-08-10 23:22:52,946][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0064s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 66.94 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 0, Kekulize 0, other 0,  -- No error 50
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: CC(O)CCC(O)CO CC(O)(C=CCO)CO CC(CO)CC[OH+]CO C=NC(=CCC)NC=N COCC(O)CC#N N#CCCC(O)C=O CC(C#N)[NH+](C)CCO C#CCC(C)C(O)CC CC(C)([NH2+]C=O)C([NH-])O CC(C)CC(C)(C)O

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 50                     |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 50 (100.0%)            |
+---------------------------+------------------------+
| Invalid Molecules         | 0 (0.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 50/50       | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 50/50       | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 50      | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 50          |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 50 (100.0%) |
+---------------------------+-------------+
| Invalid Molecules         | 0 (0.0%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 0.0%        |
+---------------------------+-------------+
| Average Molecular Weight  | 126.7       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.8         |
+---------------------------+-------------+
| Average Number of Bonds   | 7.8         |
+---------------------------+-------------+
| Average Ring Count        | 0.0         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+-------------+
| Metric                   | Value       |
+==========================+=============+
| Valid Molecules (RDKit)  | 50 (100.0%) |
+--------------------------+-------------+
| Unique Molecules         | 50 (100.0%) |
+--------------------------+-------------+
| Novel Molecules          | 50 (100.0%) |
+--------------------------+-------------+
| FCD Score                | 14.412      |
+--------------------------+-------------+
| Average Molecular Weight | 126.7       |
+--------------------------+-------------+
| Average Number of Atoms  | 8.8         |
+--------------------------+-------------+
| Average Number of Bonds  | 7.8         |
+--------------------------+-------------+
| Average Ring Count       | 0.0         |
+--------------------------+-------------+
| Average Ring Length      | 0.0         |
+--------------------------+-------------+
| Average Valency          | 3.5         |
+--------------------------+-------------+

üß™ CHEMICAL VALIDATION METRICS (ALL Generated Molecules):
+------------------------+--------+----------------------------------------------------+
| Metric                 | Rate   | Description                                        |
+========================+========+====================================================+
| Structurally Valid     | 100.0% | Basic graph structure (atoms > 0, bonds ‚â• 0)       |
+------------------------+--------+----------------------------------------------------+
| Chemically Valid       | 82.0%  | Passes valency, connectivity, and atom type checks |
+------------------------+--------+----------------------------------------------------+
| RDKit Valid            | 100.0% | Can be parsed by RDKit library                     |
+------------------------+--------+----------------------------------------------------+
| Valency Violations     | 18.0%  | Atoms with incorrect valence                       |
+------------------------+--------+----------------------------------------------------+
| Disconnected Molecules | 0.0%   | Molecules with multiple disconnected components    |
+------------------------+--------+----------------------------------------------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | 0.0%                                                                  |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 401.56 seconds |
+------------------------+----------------+
| Average Time per Batch | 33.46 seconds  |
+------------------------+----------------+
| Number of Batches      | 12             |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 17 ends
Train epoch 17 ends
Epoch 17 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 488.7s 
Epoch 17: {'CarbonCE': 0.36, 'NitroCE': 0.214, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 18
Train epoch 18 ends
Epoch 18 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 386.2s 
Epoch 18: {'CarbonCE': 0.361, 'NitroCE': 0.215, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.302, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 19
Train epoch 19 ends
Epoch 19 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 382.9s 
Epoch 19: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
`Trainer.fit` stopped: `max_epochs=20` reached.
[rank: 0] Global seed set to 0
You are using a CUDA device ('NVIDIA RTX A5000') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
Test loss: 74.4772
Epoch 20: test/epoch_NLL: 74.4772 -- test/X_kl: 3.1607 -- test/E_kl: 70.1647 -- test/charges_kl: 0.5952 
Sampling start on GR0
Samples to generate: 100 for each of the 1 devices
Samples to save: 50
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 20 full chains.
[2025-08-10 23:36:12,472][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0034s, mode=INCREMENTAL
[2025-08-10 23:36:16,878][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0039s, mode=INCREMENTAL
[2025-08-10 23:36:21,294][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0057s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_50_0.gif to wandb
2/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_51_0.gif to wandb
3/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_52_0.gif to wandb
4/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_53_0.gif to wandb
5/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_54_0.gif to wandb
6/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_55_0.gif to wandb
7/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_56_0.gif to wandb
8/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_57_0.gif to wandb
9/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_58_0.gif to wandb
10/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_59_0.gif to wandb
11/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_60_0.gif to wandb
12/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_61_0.gif to wandb
13/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_62_0.gif to wandb
14/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_63_0.gif to wandb
15/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_64_0.gif to wandb
16/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_65_0.gif to wandb
17/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_66_0.gif to wandb
18/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_67_0.gif to wandb
19/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_68_0.gif to wandb
20/20 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch20/batch50_GR0/molecule_69_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch20_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch20_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_debug_ring_count_at_most_0/epoch20_b50/graph_2.png to wandb
Done.
Sampling a batch with 50 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-10 23:39:02,706][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0035s, mode=INCREMENTAL
[2025-08-10 23:39:07,101][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0037s, mode=INCREMENTAL
[2025-08-10 23:39:11,528][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0088s, mode=INCREMENTAL
Done.
Saving the generated graphs
Saved.
üìä Computing final sampling metrics...
Error messages: AtomValence 0, Kekulize 0, other 0,  -- No error 100
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: CCC(C)C(C)(O)OC CCOCC(CC)CO CCCCC=CC(C)C C#CC(C)[NH+](C)CCO COC(C)(CO)CCO C#CC(C)OC(O)CC CCOCC(C)(O)C=O CCC(C)C(CO)OC CC(C)(C)OC(=O)CO CNC(=O)C(C)C(C)O

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 100                    |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 100 (100.0%)           |
+---------------------------+------------------------+
| Invalid Molecules         | 0 (0.0%)               |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.0%                   |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 0 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 100/100     | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 100/100     | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§1           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§3           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 100/100     | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 100     | 100.0%       |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 100     | 100.0%       |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+--------------+
| Metric                    | Value        |
+===========================+==============+
| Total Molecules Generated | 100          |
+---------------------------+--------------+
| Valid Molecules (RDKit)   | 100 (100.0%) |
+---------------------------+--------------+
| Invalid Molecules         | 0 (0.0%)     |
+---------------------------+--------------+
| Disconnected Molecules    | 0.0%         |
+---------------------------+--------------+
| Average Molecular Weight  | 127.6        |
+---------------------------+--------------+
| Average Number of Atoms   | 8.8          |
+---------------------------+--------------+
| Average Number of Bonds   | 7.8          |
+---------------------------+--------------+
| Average Ring Count        | 0.0          |
+---------------------------+--------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+--------------+
| Metric                   | Value        |
+==========================+==============+
| Valid Molecules (RDKit)  | 100 (100.0%) |
+--------------------------+--------------+
| Unique Molecules         | 100 (100.0%) |
+--------------------------+--------------+
| Novel Molecules          | 100 (100.0%) |
+--------------------------+--------------+
| FCD Score                | 12.805       |
+--------------------------+--------------+
| Average Molecular Weight | 127.6        |
+--------------------------+--------------+
| Average Number of Atoms  | 8.8          |
+--------------------------+--------------+
| Average Number of Bonds  | 7.8          |
+--------------------------+--------------+
| Average Ring Count       | 0.0          |
+--------------------------+--------------+
| Average Ring Length      | 0.0          |
+--------------------------+--------------+
| Average Valency          | 3.5          |
+--------------------------+--------------+

üß™ CHEMICAL VALIDATION METRICS (ALL Generated Molecules):
+------------------------+--------+----------------------------------------------------+
| Metric                 | Rate   | Description                                        |
+========================+========+====================================================+
| Structurally Valid     | 100.0% | Basic graph structure (atoms > 0, bonds ‚â• 0)       |
+------------------------+--------+----------------------------------------------------+
| Chemically Valid       | 80.0%  | Passes valency, connectivity, and atom type checks |
+------------------------+--------+----------------------------------------------------+
| RDKit Valid            | 100.0% | Can be parsed by RDKit library                     |
+------------------------+--------+----------------------------------------------------+
| Valency Violations     | 20.0%  | Atoms with incorrect valence                       |
+------------------------+--------+----------------------------------------------------+
| Disconnected Molecules | 0.0%   | Molecules with multiple disconnected components    |
+------------------------+--------+----------------------------------------------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | 0.0%                                                                  |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 183.50 seconds |
+------------------------+----------------+
| Average Time per Batch | 91.75 seconds  |
+------------------------+----------------+
| Number of Batches      | 2              |
+------------------------+----------------+

================================================================================

================================================================================
All smiles saved on rank 0
Done. Sampling took 185.42 seconds

Test ends.
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Test metric             DataLoader 0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        test/E_kl            70.1646957397461
        test/X_kl           3.1607465744018555
     test/charges_kl         0.595204770565033
     test/epoch_NLL          74.47715759277344
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Experiment completed at Sun 10 Aug 2025 11:39:16 PM UTC
