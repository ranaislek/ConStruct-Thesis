torch version: 2.0.1+cu118
CUDA available: True
CUDA device: NVIDIA RTX A5000
=== Running Experiment: ring_count_at_most_2_thesis ===
Config: thesis/edge_deletion/ring_count_at_most/qm9_thesis_ring_count_at_most_2
Job ID: 1021288
Node: vgpu2-1
Time: Tue 12 Aug 2025 09:07:15 AM UTC
<frozen importlib._bootstrap>:228: RuntimeWarning: to-Python converter for std::pair<double, double> already registered; second conversion method ignored.
[rank: 0] Global seed set to 0
Loading reference metrics.
Edge-deletion transition model (for 'at most' constraints)
[INFO] Early stopping enabled: monitoring 'val/epoch_NLL' with patience 10
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Global seed set to 0
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
[2025-08-12 09:08:07,508][torch.distributed.distributed_c10d][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
[2025-08-12 09:08:07,509][torch.distributed.distributed_c10d][INFO] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA RTX A5000') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                  | Params
----------------------------------------------------------------
0 | train_loss            | TrainLoss             | 0     
1 | train_metrics         | TrainMolecularMetrics | 0     
2 | val_metrics           | MetricCollection      | 0     
3 | val_nll               | NLL                   | 0     
4 | val_sampling_metrics  | SamplingMetrics       | 0     
5 | test_metrics          | MetricCollection      | 0     
6 | test_nll              | NLL                   | 0     
7 | test_sampling_metrics | SamplingMetrics       | 0     
8 | model                 | GraphTransformer      | 3.5 M 
----------------------------------------------------------------
3.5 M     Trainable params
0         Non-trainable params
3.5 M     Total params
13.901    Total estimated model params size (MB)
wandb: Currently logged in as: islekrana (islekrana-universit-di-padova). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.21.1 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /extra/rislek/ConStruct-Thesis/ConStruct/wandb/run-20250812_090810-atnjvsq7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run qm9_thesis_ring_count_at_most_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9
wandb: üöÄ View run at https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9/runs/atnjvsq7
SLURM auto-requeueing enabled. Setting signal handlers.
Epoch 0: val/epoch_NLL: 279.43 -- val/X_kl: 5.66 -- val/E_kl: 254.33 -- val/charges_kl: 14.77 
Val loss: 279.4257 	 Best val loss:  279.4257

Val epoch 0 ends
Starting epoch 0
[2025-08-12 09:08:19,498][torch.nn.parallel.distributed][INFO] - Reducer buckets have been rebuilt in this iteration.
Train epoch 0 ends
Epoch 0 finished: X: 0.53 -- charges: 0.10 -- E: 0.41 -- y: -1.00 -- 124.6s 
Epoch 0: {'CarbonCE': 0.405, 'NitroCE': 0.244, 'OxyCE': 0.293, 'FluorCE': 0.015} -- {'NoBondCE': 0.345, 'SingleCE': 0.322, 'DoubleCE': 0.068, 'TripleCE': 0.027, 'AromaticCE': 0.004}
Starting epoch 1
Train epoch 1 ends
Epoch 1 finished: X: 0.48 -- charges: 0.08 -- E: 0.39 -- y: -1.00 -- 113.1s 
Epoch 1: {'CarbonCE': 0.373, 'NitroCE': 0.223, 'OxyCE': 0.268, 'FluorCE': 0.01} -- {'NoBondCE': 0.33, 'SingleCE': 0.309, 'DoubleCE': 0.061, 'TripleCE': 0.022, 'AromaticCE': 0.0}
Starting epoch 2
Train epoch 2 ends
Epoch 2 finished: X: 0.48 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 112.4s 
Epoch 2: {'CarbonCE': 0.368, 'NitroCE': 0.22, 'OxyCE': 0.265, 'FluorCE': 0.01} -- {'NoBondCE': 0.328, 'SingleCE': 0.307, 'DoubleCE': 0.06, 'TripleCE': 0.022, 'AromaticCE': 0.0}
Starting epoch 3
Train epoch 3 ends
Epoch 3 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 109.9s 
Epoch 3: {'CarbonCE': 0.365, 'NitroCE': 0.217, 'OxyCE': 0.263, 'FluorCE': 0.01} -- {'NoBondCE': 0.325, 'SingleCE': 0.304, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 4
Epoch 4: val/epoch_NLL: 71.10 -- val/X_kl: 3.28 -- val/E_kl: 66.65 -- val/charges_kl: 0.60 
Val loss: 71.0973 	 Best val loss:  71.0973

Val epoch 4 ends
Metric val/epoch_NLL improved. New best score: 71.097
Train epoch 4 ends
Epoch 4 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 126.0s 
Epoch 4: {'CarbonCE': 0.365, 'NitroCE': 0.217, 'OxyCE': 0.263, 'FluorCE': 0.009} -- {'NoBondCE': 0.324, 'SingleCE': 0.303, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 5
Train epoch 5 ends
Epoch 5 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 108.8s 
Epoch 5: {'CarbonCE': 0.363, 'NitroCE': 0.216, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.324, 'SingleCE': 0.303, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 6
Train epoch 6 ends
Epoch 6 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 109.0s 
Epoch 6: {'CarbonCE': 0.364, 'NitroCE': 0.216, 'OxyCE': 0.262, 'FluorCE': 0.009} -- {'NoBondCE': 0.324, 'SingleCE': 0.303, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 7
Train epoch 7 ends
Epoch 7 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 113.7s 
Epoch 7: {'CarbonCE': 0.362, 'NitroCE': 0.216, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.323, 'SingleCE': 0.303, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 8
Train epoch 8 ends
Epoch 8 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 109.4s 
Epoch 8: {'CarbonCE': 0.361, 'NitroCE': 0.214, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 9
Epoch 9: val/epoch_NLL: 68.94 -- val/X_kl: 3.18 -- val/E_kl: 64.61 -- val/charges_kl: 0.59 
Val loss: 68.9402 	 Best val loss:  68.9402

Val epoch 9 ends
Metric val/epoch_NLL improved by 2.157 >= min_delta = 0.003. New best score: 68.940
Train epoch 9 ends
Epoch 9 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 124.7s 
Epoch 9: {'CarbonCE': 0.359, 'NitroCE': 0.213, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 10
Train epoch 10 ends
Epoch 10 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 119.9s 
Epoch 10: {'CarbonCE': 0.36, 'NitroCE': 0.214, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 11
Train epoch 11 ends
Epoch 11 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 109.0s 
Epoch 11: {'CarbonCE': 0.36, 'NitroCE': 0.215, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 12
Train epoch 12 ends
Epoch 12 finished: X: 0.46 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 111.2s 
Epoch 12: {'CarbonCE': 0.359, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 13
Train epoch 13 ends
Epoch 13 finished: X: 0.46 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 111.6s 
Epoch 13: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.301, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 14
Epoch 14: val/epoch_NLL: 70.07 -- val/X_kl: 3.17 -- val/E_kl: 65.74 -- val/charges_kl: 0.61 
Val loss: 70.0687 	 Best val loss:  68.9402

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
[2025-08-12 09:37:21,930][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0056s, mode=INCREMENTAL
[2025-08-12 09:37:28,473][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0056s, mode=INCREMENTAL
[2025-08-12 09:37:35,020][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0054s, mode=INCREMENTAL
[2025-08-12 09:37:41,566][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0055s, mode=INCREMENTAL
[2025-08-12 09:37:48,130][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0062s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch14_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch14_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch14_b50/graph_2.png to wandb
Done.
Sampling a batch with 150 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 09:41:30,308][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0162s, mode=INCREMENTAL
[2025-08-12 09:41:39,080][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0160s, mode=INCREMENTAL
[2025-08-12 09:41:47,859][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0161s, mode=INCREMENTAL
[2025-08-12 09:41:56,500][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0162s, mode=INCREMENTAL
[2025-08-12 09:42:05,307][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0198s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 289.99 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 4, Kekulize 0, other 0,  -- No error 196
DEBUG: Novelty calculation - unique molecules: 196, novel molecules: 191
DEBUG: Novelty percentage: 97.45%
DEBUG: Sample unique SMILES: 'CCCC(ON)=C(C)O'
DEBUG: Is in training set? False
DEBUG: Sample training SMILES: 'CC[C@@H]1[C@H](CC)[C@@H]1OC'
DEBUG: Direct comparison: 'CCCC(ON)=C(C)O' == 'CC[C@@H]1[C@H](CC)[C@@H]1OC'? False
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: CC1(F)COC(C#N)C1 Oc1nonnnc[nH]1 error CC1=CCCCC1F OCC1C2CC(O)C1O2 CC12CC1C(C=O)CN2 Nc1c2ccnc1N=C2 CC=CCC1OCC1O O=CC(C=O)C1COC1 COC(C=O)OC1CC1

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
DEBUG: Available computed_metrics keys: ['val_sampling/NumNodesW1', 'val_sampling/NodeTypesTV', 'val_sampling/EdgeTypesTV', 'val_sampling/Disconnected', 'val_sampling/MeanComponents', 'val_sampling/MaxComponents', 'val_sampling/planarity', 'val_sampling/no_cycles', 'val_sampling/lobster_components', 'val_sampling/generated_deg_hist', 'val_sampling/diff_deg_hist', 'val_sampling/abs_diff_deg_hist', 'val_sampling/ring_count_satisfaction', 'val_sampling/Validity', 'val_sampling/Uniqueness', 'val_sampling/Novelty', 'val_sampling/fcd score']
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 200                    |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 196 (98.00%)           |
+---------------------------+------------------------+
| Invalid Molecules         | 4 (2.00%)              |
+---------------------------+------------------------+
| Disconnected Molecules    | 4.00%                  |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 2 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 18/200      | 9.0%   |            |
+--------------+-------------+--------+------------+
| ‚â§1           | 82/200      | 41.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 180/200     | 90.0%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§3           | 196/200     | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 196/200     | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 196/200     | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 196/200     | 98.0%  |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 18/196      | 9.2%   |            |
+--------------+-------------+--------+------------+
| ‚â§1           | 82/196      | 41.8%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 180/196     | 91.8%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§3           | 196/196     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 196/196     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 196/196     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 196/196     | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 18      | 9.0%         |
+---------+---------+--------------+
| 1       | 64      | 32.0%        |
+---------+---------+--------------+
| 2       | 98      | 49.0%        |
+---------+---------+--------------+
| 3       | 16      | 8.0%         |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 18      | 9.2%         |
+---------+---------+--------------+
| 1       | 64      | 32.7%        |
+---------+---------+--------------+
| 2       | 98      | 50.0%        |
+---------+---------+--------------+
| 3       | 16      | 8.2%         |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 200         |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 196 (98.0%) |
+---------------------------+-------------+
| Invalid Molecules         | 4 (2.0%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 4.0%        |
+---------------------------+-------------+
| Average Molecular Weight  | 122.8       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.8         |
+---------------------------+-------------+
| Average Number of Bonds   | 9.2         |
+---------------------------+-------------+
| Average Ring Count        | 1.6         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+---------------+
| Metric                   | Value         |
+==========================+===============+
| Valid Molecules (RDKit)  | 196 (98.00%)  |
+--------------------------+---------------+
| Unique Molecules         | 196 (100.00%) |
+--------------------------+---------------+
| Novel Molecules          | 191 (97.45%)  |
+--------------------------+---------------+
| FCD Score                | 3.228         |
+--------------------------+---------------+
| Average Molecular Weight | 122.8         |
+--------------------------+---------------+
| Average Number of Atoms  | 8.8           |
+--------------------------+---------------+
| Average Number of Bonds  | 9.2           |
+--------------------------+---------------+
| Average Ring Count       | 1.6           |
+--------------------------+---------------+
| Average Ring Length      | 4.4           |
+--------------------------+---------------+
| Average Valency          | 3.6           |
+--------------------------+---------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 90.0%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 91.8%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | -1.8%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 289.96 seconds |
+------------------------+----------------+
| Average Time per Batch | 144.98 seconds |
+------------------------+----------------+
| Number of Batches      | 2              |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 14 ends
Train epoch 14 ends
Epoch 14 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 428.2s 
Epoch 14: {'CarbonCE': 0.358, 'NitroCE': 0.212, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 15
Train epoch 15 ends
Epoch 15 finished: X: 0.46 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 120.4s 
Epoch 15: {'CarbonCE': 0.359, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.008} -- {'NoBondCE': 0.321, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 16
Train epoch 16 ends
Epoch 16 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 127.0s 
Epoch 16: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 17
Train epoch 17 ends
Epoch 17 finished: X: 0.46 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 114.3s 
Epoch 17: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 18
Train epoch 18 ends
Epoch 18 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 117.5s 
Epoch 18: {'CarbonCE': 0.359, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.3, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 19
Epoch 19: val/epoch_NLL: 70.66 -- val/X_kl: 3.11 -- val/E_kl: 66.40 -- val/charges_kl: 0.60 
Val loss: 70.6627 	 Best val loss:  68.9402

Val epoch 19 ends
Train epoch 19 ends
Epoch 19 finished: X: 0.47 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 126.2s 
Epoch 19: {'CarbonCE': 0.358, 'NitroCE': 0.214, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.3, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 20
Train epoch 20 ends
Epoch 20 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.3s 
Epoch 20: {'CarbonCE': 0.357, 'NitroCE': 0.213, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.299, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 21
Train epoch 21 ends
Epoch 21 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.2s 
Epoch 21: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 22
Train epoch 22 ends
Epoch 22 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 111.6s 
Epoch 22: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 23
Train epoch 23 ends
Epoch 23 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 116.4s 
Epoch 23: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 24
Epoch 24: val/epoch_NLL: 67.96 -- val/X_kl: 3.17 -- val/E_kl: 63.64 -- val/charges_kl: 0.60 
Val loss: 67.9603 	 Best val loss:  67.9603

Val epoch 24 ends
Metric val/epoch_NLL improved by 0.980 >= min_delta = 0.003. New best score: 67.960
Train epoch 24 ends
Epoch 24 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 124.5s 
Epoch 24: {'CarbonCE': 0.357, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 25
Train epoch 25 ends
Epoch 25 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 111.3s 
Epoch 25: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 26
Train epoch 26 ends
Epoch 26 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 112.0s 
Epoch 26: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 27
Train epoch 27 ends
Epoch 27 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 111.8s 
Epoch 27: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 28
Train epoch 28 ends
Epoch 28 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.3s 
Epoch 28: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 29
Epoch 29: val/epoch_NLL: 70.94 -- val/X_kl: 3.10 -- val/E_kl: 66.70 -- val/charges_kl: 0.60 
Val loss: 70.9431 	 Best val loss:  67.9603

Val epoch 29 ends
Train epoch 29 ends
Epoch 29 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 125.5s 
Epoch 29: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 30
Train epoch 30 ends
Epoch 30 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.3s 
Epoch 30: {'CarbonCE': 0.356, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 31
Train epoch 31 ends
Epoch 31 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 109.7s 
Epoch 31: {'CarbonCE': 0.357, 'NitroCE': 0.213, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 32
Train epoch 32 ends
Epoch 32 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 117.8s 
Epoch 32: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 33
Train epoch 33 ends
Epoch 33 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 121.6s 
Epoch 33: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.259, 'FluorCE': 0.008} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 34
Epoch 34: val/epoch_NLL: 69.49 -- val/X_kl: 3.06 -- val/E_kl: 65.28 -- val/charges_kl: 0.59 
Val loss: 69.4854 	 Best val loss:  67.9603

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
[2025-08-12 10:21:10,883][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0039s, mode=INCREMENTAL
[2025-08-12 10:21:15,940][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0041s, mode=INCREMENTAL
[2025-08-12 10:21:21,012][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0041s, mode=INCREMENTAL
[2025-08-12 10:21:26,076][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0039s, mode=INCREMENTAL
[2025-08-12 10:21:31,143][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0044s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch34_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch34_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch34_b50/graph_2.png to wandb
Done.
Sampling a batch with 150 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 10:23:54,704][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0124s, mode=INCREMENTAL
[2025-08-12 10:24:01,546][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0119s, mode=INCREMENTAL
[2025-08-12 10:24:08,372][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0125s, mode=INCREMENTAL
[2025-08-12 10:24:15,195][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0121s, mode=INCREMENTAL
[2025-08-12 10:24:22,025][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0130s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 196.27 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 4, Kekulize 0, other 0,  -- No error 196
DEBUG: Novelty calculation - unique molecules: 196, novel molecules: 182
DEBUG: Novelty percentage: 92.86%
DEBUG: Sample unique SMILES: 'CCC(C#N)C(C)(C)O'
DEBUG: Is in training set? False
DEBUG: Sample training SMILES: 'CC[C@@H]1[C@H](CC)[C@@H]1OC'
DEBUG: Direct comparison: 'CCC(C#N)C(C)(C)O' == 'CC[C@@H]1[C@H](CC)[C@@H]1OC'? False
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: C[NH+]1CC1C1(C)C[NH+]1C C#CC#CC(=O)C1CO1 CC1=C(C)C(O)C=CN1 CCN(C=O)C1CO1 CC1CC12OCC2O COC1(C)COC1C=O OC1CC2CCC1C2O CCOC(C)=O CC1=CCCOC(=O)C1 CC1CC2CCC(O)C12

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
DEBUG: Available computed_metrics keys: ['val_sampling/NumNodesW1', 'val_sampling/NodeTypesTV', 'val_sampling/EdgeTypesTV', 'val_sampling/Disconnected', 'val_sampling/MeanComponents', 'val_sampling/MaxComponents', 'val_sampling/planarity', 'val_sampling/no_cycles', 'val_sampling/lobster_components', 'val_sampling/generated_deg_hist', 'val_sampling/diff_deg_hist', 'val_sampling/abs_diff_deg_hist', 'val_sampling/ring_count_satisfaction', 'val_sampling/Validity', 'val_sampling/Uniqueness', 'val_sampling/Novelty', 'val_sampling/fcd score']
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 200                    |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 196 (98.00%)           |
+---------------------------+------------------------+
| Invalid Molecules         | 4 (2.00%)              |
+---------------------------+------------------------+
| Disconnected Molecules    | 0.50%                  |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 2 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 23/200      | 11.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§1           | 95/200      | 47.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 186/200     | 93.0%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§3           | 196/200     | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 196/200     | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 196/200     | 98.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 196/200     | 98.0%  |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 23/196      | 11.7%  |            |
+--------------+-------------+--------+------------+
| ‚â§1           | 95/196      | 48.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 186/196     | 94.9%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§3           | 196/196     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 196/196     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 196/196     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 196/196     | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 23      | 11.5%        |
+---------+---------+--------------+
| 1       | 72      | 36.0%        |
+---------+---------+--------------+
| 2       | 91      | 45.5%        |
+---------+---------+--------------+
| 3       | 10      | 5.0%         |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 23      | 11.7%        |
+---------+---------+--------------+
| 1       | 72      | 36.7%        |
+---------+---------+--------------+
| 2       | 91      | 46.4%        |
+---------+---------+--------------+
| 3       | 10      | 5.1%         |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 200         |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 196 (98.0%) |
+---------------------------+-------------+
| Invalid Molecules         | 4 (2.0%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 0.5%        |
+---------------------------+-------------+
| Average Molecular Weight  | 123.4       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.8         |
+---------------------------+-------------+
| Average Number of Bonds   | 9.2         |
+---------------------------+-------------+
| Average Ring Count        | 1.4         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+---------------+
| Metric                   | Value         |
+==========================+===============+
| Valid Molecules (RDKit)  | 196 (98.00%)  |
+--------------------------+---------------+
| Unique Molecules         | 196 (100.00%) |
+--------------------------+---------------+
| Novel Molecules          | 182 (92.86%)  |
+--------------------------+---------------+
| FCD Score                | 2.825         |
+--------------------------+---------------+
| Average Molecular Weight | 123.4         |
+--------------------------+---------------+
| Average Number of Atoms  | 8.8           |
+--------------------------+---------------+
| Average Number of Bonds  | 9.2           |
+--------------------------+---------------+
| Average Ring Count       | 1.4           |
+--------------------------+---------------+
| Average Ring Length      | 4.2           |
+--------------------------+---------------+
| Average Valency          | 3.6           |
+--------------------------+---------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 93.0%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 94.9%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | -1.9%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 486.21 seconds |
+------------------------+----------------+
| Average Time per Batch | 121.55 seconds |
+------------------------+----------------+
| Number of Batches      | 4              |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 34 ends
Train epoch 34 ends
Epoch 34 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 326.5s 
Epoch 34: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 35
Train epoch 35 ends
Epoch 35 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 114.1s 
Epoch 35: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 36
Train epoch 36 ends
Epoch 36 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 113.7s 
Epoch 36: {'CarbonCE': 0.356, 'NitroCE': 0.211, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 37
Train epoch 37 ends
Epoch 37 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 113.8s 
Epoch 37: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 38
Train epoch 38 ends
Epoch 38 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.7s 
Epoch 38: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 39
Epoch 39: val/epoch_NLL: 69.08 -- val/X_kl: 3.09 -- val/E_kl: 64.85 -- val/charges_kl: 0.62 
Val loss: 69.0766 	 Best val loss:  67.9603

Val epoch 39 ends
Train epoch 39 ends
Epoch 39 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 127.2s 
Epoch 39: {'CarbonCE': 0.356, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 40
Train epoch 40 ends
Epoch 40 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 111.4s 
Epoch 40: {'CarbonCE': 0.356, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 41
Train epoch 41 ends
Epoch 41 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 111.8s 
Epoch 41: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.259, 'FluorCE': 0.008} -- {'NoBondCE': 0.319, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 42
Train epoch 42 ends
Epoch 42 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 125.9s 
Epoch 42: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 43
Train epoch 43 ends
Epoch 43 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 115.8s 
Epoch 43: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.008} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 44
Epoch 44: val/epoch_NLL: 69.87 -- val/X_kl: 3.06 -- val/E_kl: 65.70 -- val/charges_kl: 0.57 
Val loss: 69.8652 	 Best val loss:  67.9603

Val epoch 44 ends
Train epoch 44 ends
Epoch 44 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 123.4s 
Epoch 44: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 45
Train epoch 45 ends
Epoch 45 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.2s 
Epoch 45: {'CarbonCE': 0.356, 'NitroCE': 0.211, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 46
Train epoch 46 ends
Epoch 46 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 109.9s 
Epoch 46: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.008} -- {'NoBondCE': 0.318, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 47
Train epoch 47 ends
Epoch 47 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.0s 
Epoch 47: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 48
Train epoch 48 ends
Epoch 48 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.5s 
Epoch 48: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 49
Epoch 49: val/epoch_NLL: 70.60 -- val/X_kl: 3.04 -- val/E_kl: 66.40 -- val/charges_kl: 0.59 
Val loss: 70.6014 	 Best val loss:  67.9603

Val epoch 49 ends
Train epoch 49 ends
Epoch 49 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 123.4s 
Epoch 49: {'CarbonCE': 0.354, 'NitroCE': 0.21, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 50
Train epoch 50 ends
Epoch 50 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.9s 
Epoch 50: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.256, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 51
Train epoch 51 ends
Epoch 51 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.5s 
Epoch 51: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.256, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 52
Train epoch 52 ends
Epoch 52 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 111.1s 
Epoch 52: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 53
Train epoch 53 ends
Epoch 53 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 112.4s 
Epoch 53: {'CarbonCE': 0.354, 'NitroCE': 0.21, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 54
Epoch 54: val/epoch_NLL: 71.52 -- val/X_kl: 3.16 -- val/E_kl: 67.21 -- val/charges_kl: 0.61 
Val loss: 71.5183 	 Best val loss:  67.9603

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
[2025-08-12 11:03:01,504][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0039s, mode=INCREMENTAL
[2025-08-12 11:03:06,563][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0041s, mode=INCREMENTAL
[2025-08-12 11:03:11,615][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0041s, mode=INCREMENTAL
[2025-08-12 11:03:16,671][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0044s, mode=INCREMENTAL
[2025-08-12 11:03:21,740][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0050s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch54_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch54_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch54_b50/graph_2.png to wandb
Done.
Sampling a batch with 150 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 11:05:21,256][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0121s, mode=INCREMENTAL
[2025-08-12 11:05:28,004][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0116s, mode=INCREMENTAL
[2025-08-12 11:05:34,767][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0120s, mode=INCREMENTAL
[2025-08-12 11:05:41,540][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0117s, mode=INCREMENTAL
[2025-08-12 11:05:48,332][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0184s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 171.93 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 3, Kekulize 0, other 0,  -- No error 197
DEBUG: Novelty calculation - unique molecules: 197, novel molecules: 187
DEBUG: Novelty percentage: 94.92%
DEBUG: Sample unique SMILES: 'CC12CC(O)C1(C#N)N2'
DEBUG: Is in training set? False
DEBUG: Sample training SMILES: 'CC[C@@H]1[C@H](CC)[C@@H]1OC'
DEBUG: Direct comparison: 'CC12CC(O)C1(C#N)N2' == 'CC[C@@H]1[C@H](CC)[C@@H]1OC'? False
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: CCc1ocnc1NC CC(CO)C(O)C=O N#CC12CN1CC=C2O CC1(N)CNCC12CO2 NC12CC1[NH+](CC=O)C2 C#CC(O)CC(C)(C)C CC1(C#N)NC1C1CC1 CC1(C2CN2)C(=O)C1O CC#CC1=NC=CC1=O O=c1cc(F)oc(=O)[nH]1

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
DEBUG: Available computed_metrics keys: ['val_sampling/NumNodesW1', 'val_sampling/NodeTypesTV', 'val_sampling/EdgeTypesTV', 'val_sampling/Disconnected', 'val_sampling/MeanComponents', 'val_sampling/MaxComponents', 'val_sampling/planarity', 'val_sampling/no_cycles', 'val_sampling/lobster_components', 'val_sampling/generated_deg_hist', 'val_sampling/diff_deg_hist', 'val_sampling/abs_diff_deg_hist', 'val_sampling/ring_count_satisfaction', 'val_sampling/Validity', 'val_sampling/Uniqueness', 'val_sampling/Novelty', 'val_sampling/fcd score']
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 200                    |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 197 (98.50%)           |
+---------------------------+------------------------+
| Invalid Molecules         | 3 (1.50%)              |
+---------------------------+------------------------+
| Disconnected Molecules    | 1.50%                  |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 2 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 17/200      | 8.5%   |            |
+--------------+-------------+--------+------------+
| ‚â§1           | 76/200      | 38.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 180/200     | 90.0%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§3           | 197/200     | 98.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 197/200     | 98.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 197/200     | 98.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 197/200     | 98.5%  |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 17/197      | 8.6%   |            |
+--------------+-------------+--------+------------+
| ‚â§1           | 76/197      | 38.6%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 180/197     | 91.4%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§3           | 197/197     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 197/197     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 197/197     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 197/197     | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 17      | 8.5%         |
+---------+---------+--------------+
| 1       | 59      | 29.5%        |
+---------+---------+--------------+
| 2       | 104     | 52.0%        |
+---------+---------+--------------+
| 3       | 17      | 8.5%         |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 17      | 8.6%         |
+---------+---------+--------------+
| 1       | 59      | 29.9%        |
+---------+---------+--------------+
| 2       | 104     | 52.8%        |
+---------+---------+--------------+
| 3       | 17      | 8.6%         |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 200         |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 197 (98.5%) |
+---------------------------+-------------+
| Invalid Molecules         | 3 (1.5%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 1.5%        |
+---------------------------+-------------+
| Average Molecular Weight  | 123.6       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.8         |
+---------------------------+-------------+
| Average Number of Bonds   | 9.4         |
+---------------------------+-------------+
| Average Ring Count        | 1.6         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+---------------+
| Metric                   | Value         |
+==========================+===============+
| Valid Molecules (RDKit)  | 197 (98.50%)  |
+--------------------------+---------------+
| Unique Molecules         | 197 (100.00%) |
+--------------------------+---------------+
| Novel Molecules          | 187 (94.92%)  |
+--------------------------+---------------+
| FCD Score                | 3.082         |
+--------------------------+---------------+
| Average Molecular Weight | 123.6         |
+--------------------------+---------------+
| Average Number of Atoms  | 8.8           |
+--------------------------+---------------+
| Average Number of Bonds  | 9.4           |
+--------------------------+---------------+
| Average Ring Count       | 1.6           |
+--------------------------+---------------+
| Average Ring Length      | 4.2           |
+--------------------------+---------------+
| Average Valency          | 3.6           |
+--------------------------+---------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 90.0%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 91.4%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | -1.4%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 658.11 seconds |
+------------------------+----------------+
| Average Time per Batch | 109.68 seconds |
+------------------------+----------------+
| Number of Batches      | 6              |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 54 ends
Train epoch 54 ends
Epoch 54 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 309.0s 
Epoch 54: {'CarbonCE': 0.356, 'NitroCE': 0.213, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 55
Train epoch 55 ends
Epoch 55 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 125.9s 
Epoch 55: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.256, 'FluorCE': 0.008} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 56
Train epoch 56 ends
Epoch 56 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 117.6s 
Epoch 56: {'CarbonCE': 0.354, 'NitroCE': 0.211, 'OxyCE': 0.256, 'FluorCE': 0.008} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 57
Train epoch 57 ends
Epoch 57 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 116.9s 
Epoch 57: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 58
Train epoch 58 ends
Epoch 58 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 116.5s 
Epoch 58: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 59
Epoch 59: val/epoch_NLL: 70.62 -- val/X_kl: 3.06 -- val/E_kl: 66.40 -- val/charges_kl: 0.60 
Val loss: 70.6174 	 Best val loss:  67.9603

Val epoch 59 ends
Train epoch 59 ends
Epoch 59 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 123.3s 
Epoch 59: {'CarbonCE': 0.356, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 60
Train epoch 60 ends
Epoch 60 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 122.3s 
Epoch 60: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 61
Train epoch 61 ends
Epoch 61 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 126.2s 
Epoch 61: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.008} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 62
Train epoch 62 ends
Epoch 62 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 120.5s 
Epoch 62: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 63
Train epoch 63 ends
Epoch 63 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 125.3s 
Epoch 63: {'CarbonCE': 0.354, 'NitroCE': 0.211, 'OxyCE': 0.256, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 64
Epoch 64: val/epoch_NLL: 69.34 -- val/X_kl: 3.12 -- val/E_kl: 65.08 -- val/charges_kl: 0.58 
Val loss: 69.3416 	 Best val loss:  67.9603

Val epoch 64 ends
Train epoch 64 ends
Epoch 64 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 135.2s 
Epoch 64: {'CarbonCE': 0.354, 'NitroCE': 0.211, 'OxyCE': 0.256, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 65
Train epoch 65 ends
Epoch 65 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 121.2s 
Epoch 65: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 66
Train epoch 66 ends
Epoch 66 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 112.7s 
Epoch 66: {'CarbonCE': 0.354, 'NitroCE': 0.21, 'OxyCE': 0.256, 'FluorCE': 0.008} -- {'NoBondCE': 0.316, 'SingleCE': 0.296, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 67
Train epoch 67 ends
Epoch 67 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.3s 
Epoch 67: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 68
Train epoch 68 ends
Epoch 68 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 114.0s 
Epoch 68: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.256, 'FluorCE': 0.008} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 69
Epoch 69: val/epoch_NLL: 71.37 -- val/X_kl: 3.07 -- val/E_kl: 67.14 -- val/charges_kl: 0.62 
Val loss: 71.3677 	 Best val loss:  67.9603

Val epoch 69 ends
Train epoch 69 ends
Epoch 69 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 129.4s 
Epoch 69: {'CarbonCE': 0.354, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.008} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 70
Train epoch 70 ends
Epoch 70 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 111.4s 
Epoch 70: {'CarbonCE': 0.356, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 71
Train epoch 71 ends
Epoch 71 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 109.6s 
Epoch 71: {'CarbonCE': 0.354, 'NitroCE': 0.211, 'OxyCE': 0.256, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.296, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 72
Train epoch 72 ends
Epoch 72 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 110.3s 
Epoch 72: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.008} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 73
Train epoch 73 ends
Epoch 73 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 114.0s 
Epoch 73: {'CarbonCE': 0.354, 'NitroCE': 0.21, 'OxyCE': 0.256, 'FluorCE': 0.008} -- {'NoBondCE': 0.316, 'SingleCE': 0.296, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 74
Epoch 74: val/epoch_NLL: 69.59 -- val/X_kl: 3.05 -- val/E_kl: 65.38 -- val/charges_kl: 0.60 
Val loss: 69.5872 	 Best val loss:  67.9603

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
[2025-08-12 11:45:52,542][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0055s, mode=INCREMENTAL
[2025-08-12 11:45:59,051][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0056s, mode=INCREMENTAL
[2025-08-12 11:46:05,568][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0057s, mode=INCREMENTAL
[2025-08-12 11:46:11,638][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0041s, mode=INCREMENTAL
[2025-08-12 11:46:16,745][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0050s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch74_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch74_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch74_b50/graph_2.png to wandb
Done.
Sampling a batch with 150 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 11:47:30,871][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0162s, mode=INCREMENTAL
[2025-08-12 11:47:39,637][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0159s, mode=INCREMENTAL
[2025-08-12 11:47:48,409][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0166s, mode=INCREMENTAL
[2025-08-12 11:47:55,408][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0122s, mode=INCREMENTAL
[2025-08-12 11:48:02,197][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0131s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 135.99 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 2, Kekulize 0, other 0,  -- No error 198
DEBUG: Novelty calculation - unique molecules: 198, novel molecules: 173
DEBUG: Novelty percentage: 87.37%
DEBUG: Sample unique SMILES: 'C#CCC(C)C(=O)C#C'
DEBUG: Is in training set? False
DEBUG: Sample training SMILES: 'CC[C@@H]1[C@H](CC)[C@@H]1OC'
DEBUG: Direct comparison: 'C#CCC(C)C(=O)C#C' == 'CC[C@@H]1[C@H](CC)[C@@H]1OC'? False
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: O=C1C[NH+]2CCOC1C2 CC1=CCC(=O)CC1=O C#CCC#CC(=O)CC CC(=O)C=C(C)CCO Nc1c[nH]cc1NC=O N#CC1(C2CC2O)CO1 CC1=C(O)C(=O)C=C1 CC(=O)C12NC1CC2C COCC12C[NH+]1CC2=O CCOC(=N)OC([NH-])=O

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
DEBUG: Available computed_metrics keys: ['val_sampling/NumNodesW1', 'val_sampling/NodeTypesTV', 'val_sampling/EdgeTypesTV', 'val_sampling/Disconnected', 'val_sampling/MeanComponents', 'val_sampling/MaxComponents', 'val_sampling/planarity', 'val_sampling/no_cycles', 'val_sampling/lobster_components', 'val_sampling/generated_deg_hist', 'val_sampling/diff_deg_hist', 'val_sampling/abs_diff_deg_hist', 'val_sampling/ring_count_satisfaction', 'val_sampling/Validity', 'val_sampling/Uniqueness', 'val_sampling/Novelty', 'val_sampling/fcd score']
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 200                    |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 198 (99.00%)           |
+---------------------------+------------------------+
| Invalid Molecules         | 2 (1.00%)              |
+---------------------------+------------------------+
| Disconnected Molecules    | 3.00%                  |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 2 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 24/200      | 12.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§1           | 94/200      | 47.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 183/200     | 91.5%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§3           | 198/200     | 99.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 198/200     | 99.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 198/200     | 99.0%  |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 198/200     | 99.0%  |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 24/198      | 12.1%  |            |
+--------------+-------------+--------+------------+
| ‚â§1           | 94/198      | 47.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 183/198     | 92.4%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§3           | 198/198     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 198/198     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 198/198     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 198/198     | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 24      | 12.0%        |
+---------+---------+--------------+
| 1       | 70      | 35.0%        |
+---------+---------+--------------+
| 2       | 89      | 44.5%        |
+---------+---------+--------------+
| 3       | 15      | 7.5%         |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 24      | 12.1%        |
+---------+---------+--------------+
| 1       | 70      | 35.4%        |
+---------+---------+--------------+
| 2       | 89      | 44.9%        |
+---------+---------+--------------+
| 3       | 15      | 7.6%         |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 200         |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 198 (99.0%) |
+---------------------------+-------------+
| Invalid Molecules         | 2 (1.0%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 3.0%        |
+---------------------------+-------------+
| Average Molecular Weight  | 122.1       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.7         |
+---------------------------+-------------+
| Average Number of Bonds   | 9.1         |
+---------------------------+-------------+
| Average Ring Count        | 1.5         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+---------------+
| Metric                   | Value         |
+==========================+===============+
| Valid Molecules (RDKit)  | 198 (99.00%)  |
+--------------------------+---------------+
| Unique Molecules         | 198 (100.00%) |
+--------------------------+---------------+
| Novel Molecules          | 173 (87.37%)  |
+--------------------------+---------------+
| FCD Score                | 3.010         |
+--------------------------+---------------+
| Average Molecular Weight | 122.1         |
+--------------------------+---------------+
| Average Number of Atoms  | 8.7           |
+--------------------------+---------------+
| Average Number of Bonds  | 9.1           |
+--------------------------+---------------+
| Average Ring Count       | 1.5           |
+--------------------------+---------------+
| Average Ring Length      | 4.1           |
+--------------------------+---------------+
| Average Valency          | 3.6           |
+--------------------------+---------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 91.5%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 92.4%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | -0.9%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 794.07 seconds |
+------------------------+----------------+
| Average Time per Batch | 99.26 seconds  |
+------------------------+----------------+
| Number of Batches      | 8              |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 74 ends
Monitored metric val/epoch_NLL did not improve in the last 10 records. Best score: 67.960. Signaling Trainer to stop.
Train epoch 74 ends
Epoch 74 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 270.8s 
Epoch 74: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.008} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
[rank: 0] Global seed set to 0
You are using a CUDA device ('NVIDIA RTX A5000') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
wandb: Waiting for W&B process to finish... (success).
wandb: - 27.086 MB of 27.086 MB uploaded (0.000 MB deduped)wandb: \ 27.086 MB of 27.086 MB uploaded (0.000 MB deduped)wandb: | 27.086 MB of 27.086 MB uploaded (0.000 MB deduped)wandb: / 27.086 MB of 27.086 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:                                epoch ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà
wandb:                     train/AromaticCE ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                       train/CarbonCE ‚ñà‚ñÑ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                       train/DoubleCE ‚ñà‚ñÑ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                        train/FluorCE ‚ñà‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                        train/NitroCE ‚ñà‚ñÑ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                       train/NoBondCE ‚ñà‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                          train/OxyCE ‚ñà‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                       train/SingleCE ‚ñà‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                       train/TripleCE ‚ñà‚ñÉ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                     train_epoch/E_CE ‚ñà‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:               train_epoch/charges_CE ‚ñà‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:          train_epoch/epochAromaticCE ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:            train_epoch/epochCarbonCE ‚ñà‚ñÑ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:            train_epoch/epochDoubleCE ‚ñà‚ñÑ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:             train_epoch/epochFluorCE ‚ñà‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:             train_epoch/epochNitroCE ‚ñà‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:            train_epoch/epochNoBondCE ‚ñà‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:               train_epoch/epochOxyCE ‚ñà‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:            train_epoch/epochSingleCE ‚ñà‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:            train_epoch/epochTripleCE ‚ñà‚ñÉ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                     train_epoch/x_CE ‚ñà‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                     train_epoch/y_CE ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                      train_loss/E_CE ‚ñà‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                      train_loss/X_CE ‚ñà‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                train_loss/batch_loss ‚ñÜ‚ñà‚ñÜ‚ñÜ‚ñÑ‚ñÇ‚ñÉ‚ñÜ‚ñÖ‚ñÉ‚ñÖ‚ñÖ‚ñÑ‚ñÜ‚ñá‚ñÖ‚ñÖ‚ñÉ‚ñÜ‚ñÇ‚ñá‚ñÉ‚ñÅ‚ñÑ‚ñÖ‚ñÑ‚ñÇ‚ñÑ‚ñÑ‚ñÅ‚ñÑ‚ñÜ‚ñÖ‚ñÉ‚ñÅ‚ñá‚ñÖ‚ñÜ‚ñÖ‚ñÉ
wandb:                train_loss/charges_CE ‚ñà‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                      train_loss/y_CE ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                             val/E_kl ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                             val/X_kl ‚ñà‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                       val/charges_kl ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                        val/epoch_NLL ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:                    val_ratio/average ‚ñà‚ñÅ‚ñÖ‚ñÑ
wandb:                  val_ratio/fcd score ‚ñà‚ñÅ‚ñÖ‚ñÑ
wandb:                val_sampling/ChargeW1 ‚ñà‚ñÅ‚ñÖ‚ñà
wandb:            val_sampling/Disconnected ‚ñà‚ñÅ‚ñÉ‚ñÜ
wandb:             val_sampling/EdgeTypesTV ‚ñÉ‚ñà‚ñÑ‚ñÅ
wandb:           val_sampling/MaxComponents ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:          val_sampling/MeanComponents ‚ñà‚ñÅ‚ñÉ‚ñÜ
wandb:             val_sampling/NodeTypesTV ‚ñà‚ñà‚ñÅ‚ñÉ
wandb:                 val_sampling/Novelty ‚ñà‚ñÖ‚ñÜ‚ñÅ
wandb:              val_sampling/NumNodesW1 ‚ñÇ‚ñÅ‚ñà‚ñá
wandb:              val_sampling/Uniqueness ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb:               val_sampling/ValencyW1 ‚ñÑ‚ñà‚ñÅ‚ñá
wandb:                val_sampling/Validity ‚ñÅ‚ñÅ‚ñÖ‚ñà
wandb:               val_sampling/fcd score ‚ñà‚ñÅ‚ñÖ‚ñÑ
wandb:      val_sampling/lobster_components ‚ñÇ‚ñà‚ñÅ‚ñà
wandb:               val_sampling/no_cycles ‚ñÇ‚ñà‚ñÅ‚ñà
wandb:               val_sampling/planarity ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: val_sampling/ring_count_satisfaction ‚ñÅ‚ñÅ‚ñÅ‚ñÅ
wandb: 
wandb: Run summary:
wandb:                                epoch 74
wandb:                     train/AromaticCE 0.0
wandb:                       train/CarbonCE 0.35493
wandb:                       train/DoubleCE 0.05769
wandb:                        train/FluorCE 0.00838
wandb:                        train/NitroCE 0.21138
wandb:                       train/NoBondCE 0.31671
wandb:                          train/OxyCE 0.25684
wandb:                       train/SingleCE 0.29684
wandb:                       train/TripleCE 0.02092
wandb:                     train_epoch/E_CE 0.37049
wandb:               train_epoch/charges_CE 0.07928
wandb:          train_epoch/epochAromaticCE 0.0
wandb:            train_epoch/epochCarbonCE 0.35486
wandb:            train_epoch/epochDoubleCE 0.05765
wandb:             train_epoch/epochFluorCE 0.00839
wandb:             train_epoch/epochNitroCE 0.21129
wandb:            train_epoch/epochNoBondCE 0.31666
wandb:               train_epoch/epochOxyCE 0.25687
wandb:            train_epoch/epochSingleCE 0.29681
wandb:            train_epoch/epochTripleCE 0.02091
wandb:                     train_epoch/x_CE 0.4598
wandb:                     train_epoch/y_CE -1.0
wandb:                      train_loss/E_CE 1.85281
wandb:                      train_loss/X_CE 0.45987
wandb:                train_loss/batch_loss 2.40254
wandb:                train_loss/charges_CE 0.15887
wandb:                      train_loss/y_CE -1.0
wandb:                             val/E_kl 65.37858
wandb:                             val/X_kl 3.04542
wandb:                       val/charges_kl 0.60217
wandb:                        val/epoch_NLL 69.5872
wandb:                    val_ratio/average 3.48861
wandb:                  val_ratio/fcd score 3.48861
wandb:                val_sampling/ChargeW1 0.00706
wandb:            val_sampling/Disconnected 3.0
wandb:             val_sampling/EdgeTypesTV 0.07176
wandb:           val_sampling/MaxComponents 2.0
wandb:          val_sampling/MeanComponents 1.03
wandb:             val_sampling/NodeTypesTV 0.01637
wandb:                 val_sampling/Novelty 87.37374
wandb:              val_sampling/NumNodesW1 0.06265
wandb:              val_sampling/Uniqueness 100.0
wandb:               val_sampling/ValencyW1 0.0795
wandb:                val_sampling/Validity 99.0
wandb:               val_sampling/fcd score 3.01031
wandb:      val_sampling/lobster_components 0.115
wandb:               val_sampling/no_cycles 0.115
wandb:               val_sampling/planarity 1.0
wandb: val_sampling/ring_count_satisfaction 1.0
wandb: 
wandb: üöÄ View run qm9_thesis_ring_count_at_most_2 at: https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9/runs/atnjvsq7
wandb: Synced 6 W&B file(s), 280 media file(s), 0 artifact file(s) and 4 other file(s)
wandb: Find logs at: ./wandb/run-20250812_090810-atnjvsq7/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.21.1 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /extra/rislek/ConStruct-Thesis/ConStruct/wandb/run-20250812_114806-92dbqqxq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run qm9_thesis_ring_count_at_most_2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9
wandb: üöÄ View run at https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9/runs/92dbqqxq
Test loss: 69.3689
Epoch 75: test/epoch_NLL: 69.3689 -- test/X_kl: 3.1678 -- test/E_kl: 65.0975 -- test/charges_kl: 0.5483 
Sampling start on GR0
Samples to generate: 2000 for each of the 1 devices
Samples to save: 500
Sampling a batch with 230 graphs on local rank 0. Saving 230 visualization and 100 full chains.
[2025-08-12 11:48:37,983][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0219s, mode=INCREMENTAL
[2025-08-12 11:48:47,442][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0213s, mode=INCREMENTAL
[2025-08-12 11:48:56,922][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0218s, mode=INCREMENTAL
[2025-08-12 11:49:06,347][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0156s, mode=INCREMENTAL
[2025-08-12 11:49:13,634][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0180s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_230_0.gif to wandb
2/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_231_0.gif to wandb
3/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_232_0.gif to wandb
4/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_233_0.gif to wandb
5/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_234_0.gif to wandb
6/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_235_0.gif to wandb
7/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_236_0.gif to wandb
8/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_237_0.gif to wandb
9/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_238_0.gif to wandb
10/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_239_0.gif to wandb
11/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_240_0.gif to wandb
12/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_241_0.gif to wandb
13/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_242_0.gif to wandb
14/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_243_0.gif to wandb
15/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_244_0.gif to wandb
16/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_245_0.gif to wandb
17/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_246_0.gif to wandb
18/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_247_0.gif to wandb
19/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_248_0.gif to wandb
20/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_249_0.gif to wandb
21/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_250_0.gif to wandb
22/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_251_0.gif to wandb
23/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_252_0.gif to wandb
24/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_253_0.gif to wandb
25/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_254_0.gif to wandb
26/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_255_0.gif to wandb
27/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_256_0.gif to wandb
28/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_257_0.gif to wandb
29/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_258_0.gif to wandb
30/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_259_0.gif to wandb
31/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_260_0.gif to wandb
32/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_261_0.gif to wandb
33/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_262_0.gif to wandb
34/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_263_0.gif to wandb
35/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_264_0.gif to wandb
36/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_265_0.gif to wandb
37/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_266_0.gif to wandb
38/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_267_0.gif to wandb
39/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_268_0.gif to wandb
40/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_269_0.gif to wandb
41/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_270_0.gif to wandb
42/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_271_0.gif to wandb
43/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_272_0.gif to wandb
44/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_273_0.gif to wandb
45/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_274_0.gif to wandb
46/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_275_0.gif to wandb
47/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_276_0.gif to wandb
48/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_277_0.gif to wandb
49/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_278_0.gif to wandb
50/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_279_0.gif to wandb
51/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_280_0.gif to wandb
52/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_281_0.gif to wandb
53/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_282_0.gif to wandb
54/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_283_0.gif to wandb
55/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_284_0.gif to wandb
56/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_285_0.gif to wandb
57/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_286_0.gif to wandb
58/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_287_0.gif to wandb
59/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_288_0.gif to wandb
60/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_289_0.gif to wandb
61/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_290_0.gif to wandb
62/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_291_0.gif to wandb
63/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_292_0.gif to wandb
64/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_293_0.gif to wandb
65/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_294_0.gif to wandb
66/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_295_0.gif to wandb
67/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_296_0.gif to wandb
68/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_297_0.gif to wandb
69/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_298_0.gif to wandb
70/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_299_0.gif to wandb
71/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_300_0.gif to wandb
72/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_301_0.gif to wandb
73/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_302_0.gif to wandb
74/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_303_0.gif to wandb
75/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_304_0.gif to wandb
76/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_305_0.gif to wandb
77/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_306_0.gif to wandb
78/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_307_0.gif to wandb
79/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_308_0.gif to wandb
80/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_309_0.gif to wandb
81/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_310_0.gif to wandb
82/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_311_0.gif to wandb
83/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_312_0.gif to wandb
84/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_313_0.gif to wandb
85/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_314_0.gif to wandb
86/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_315_0.gif to wandb
87/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_316_0.gif to wandb
88/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_317_0.gif to wandb
89/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_318_0.gif to wandb
90/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_319_0.gif to wandb
91/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_320_0.gif to wandb
92/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_321_0.gif to wandb
93/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_322_0.gif to wandb
94/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_323_0.gif to wandb
95/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_324_0.gif to wandb
96/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_325_0.gif to wandb
97/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_326_0.gif to wandb
98/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_327_0.gif to wandb
99/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_328_0.gif to wandb
100/100 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch75/batch230_GR0/molecule_329_0.gif to wandb
Visualizing 230 graphs out of 230
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch75_b230/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch75_b230/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch75_b230/graph_2.png to wandb
Done.
Sampling a batch with 230 graphs on local rank 0. Saving 230 visualization and 0 full chains.
[2025-08-12 11:57:02,314][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0162s, mode=INCREMENTAL
[2025-08-12 11:57:09,582][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0156s, mode=INCREMENTAL
[2025-08-12 11:57:16,888][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0158s, mode=INCREMENTAL
[2025-08-12 11:57:24,187][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0159s, mode=INCREMENTAL
[2025-08-12 11:57:31,504][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0187s, mode=INCREMENTAL
Visualizing 230 graphs out of 230
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch75_b460/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch75_b460/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch75_b460/graph_2.png to wandb
Done.
Sampling a batch with 40 graphs on local rank 0. Saving 40 visualization and 0 full chains.
[2025-08-12 11:57:48,544][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0028s, mode=INCREMENTAL
[2025-08-12 11:57:52,952][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0029s, mode=INCREMENTAL
[2025-08-12 11:57:57,356][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0028s, mode=INCREMENTAL
[2025-08-12 11:58:01,799][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0030s, mode=INCREMENTAL
[2025-08-12 11:58:06,210][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0030s, mode=INCREMENTAL
Visualizing 40 graphs out of 40
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch75_b500/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch75_b500/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_count_at_most_2/epoch75_b500/graph_2.png to wandb
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 11:58:15,656][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0161s, mode=INCREMENTAL
[2025-08-12 11:58:22,961][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0160s, mode=INCREMENTAL
[2025-08-12 11:58:30,265][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0158s, mode=INCREMENTAL
[2025-08-12 11:58:37,527][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0158s, mode=INCREMENTAL
[2025-08-12 11:58:44,834][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0177s, mode=INCREMENTAL
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 11:58:52,189][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0158s, mode=INCREMENTAL
[2025-08-12 11:59:01,074][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0218s, mode=INCREMENTAL
[2025-08-12 11:59:10,568][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0227s, mode=INCREMENTAL
[2025-08-12 11:59:20,060][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0222s, mode=INCREMENTAL
[2025-08-12 11:59:29,579][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0244s, mode=INCREMENTAL
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 11:59:38,982][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0223s, mode=INCREMENTAL
[2025-08-12 11:59:47,920][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0159s, mode=INCREMENTAL
[2025-08-12 11:59:55,245][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0160s, mode=INCREMENTAL
[2025-08-12 12:00:02,506][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0160s, mode=INCREMENTAL
[2025-08-12 12:00:09,804][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0196s, mode=INCREMENTAL
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 12:00:17,162][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0161s, mode=INCREMENTAL
[2025-08-12 12:00:24,422][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0158s, mode=INCREMENTAL
[2025-08-12 12:00:31,689][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0163s, mode=INCREMENTAL
[2025-08-12 12:00:38,959][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0160s, mode=INCREMENTAL
[2025-08-12 12:00:46,262][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0192s, mode=INCREMENTAL
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 12:00:54,378][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0226s, mode=INCREMENTAL
[2025-08-12 12:01:03,876][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0225s, mode=INCREMENTAL
[2025-08-12 12:01:11,466][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0156s, mode=INCREMENTAL
[2025-08-12 12:01:18,740][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0155s, mode=INCREMENTAL
[2025-08-12 12:01:26,044][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0176s, mode=INCREMENTAL
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 12:01:33,394][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0160s, mode=INCREMENTAL
[2025-08-12 12:01:40,635][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0157s, mode=INCREMENTAL
[2025-08-12 12:01:47,880][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0157s, mode=INCREMENTAL
[2025-08-12 12:01:55,149][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0164s, mode=INCREMENTAL
[2025-08-12 12:02:02,435][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0184s, mode=INCREMENTAL
Done.
Sampling a batch with 114 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 12:02:08,012][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0080s, mode=INCREMENTAL
[2025-08-12 12:02:13,518][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0082s, mode=INCREMENTAL
[2025-08-12 12:02:19,022][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0081s, mode=INCREMENTAL
[2025-08-12 12:02:24,539][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0079s, mode=INCREMENTAL
[2025-08-12 12:02:30,064][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingCountAtMostProjector: projection_time=0.0093s, mode=INCREMENTAL
Done.
Saving the generated graphs
Saved.
üìä Computing final sampling metrics...
Error messages: AtomValence 16, Kekulize 0, other 0,  -- No error 1984
DEBUG: Novelty calculation - unique molecules: 1970, novel molecules: 1785
DEBUG: Novelty percentage: 90.61%
DEBUG: Sample unique SMILES: 'CC1CC2C(CCO)C12'
DEBUG: Is in training set? False
DEBUG: Sample training SMILES: 'CC[C@@H]1[C@H](CC)[C@@H]1OC'
DEBUG: Direct comparison: 'CC1CC2C(CCO)C12' == 'CC[C@@H]1[C@H](CC)[C@@H]1OC'? False
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: CCC1CC2(CO2)C1=O O=C1OC2CC(O)C2O1 CC1CC1CC(O)C=O CC1C2C(C)C(C)(O)C12 CC1OC12COCC2O CNC(=O)C1NC1C#N OCC1CCC1C1CC1 COCCC(=O)CCO C#CC[NH+]1C2CC1(C)C2 [NH-][CH+]NC12CC1OC2=O

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
DEBUG: Available computed_metrics keys: ['test_sampling/NumNodesW1', 'test_sampling/NodeTypesTV', 'test_sampling/EdgeTypesTV', 'test_sampling/Disconnected', 'test_sampling/MeanComponents', 'test_sampling/MaxComponents', 'test_sampling/planarity', 'test_sampling/no_cycles', 'test_sampling/lobster_components', 'test_sampling/generated_deg_hist', 'test_sampling/diff_deg_hist', 'test_sampling/abs_diff_deg_hist', 'test_sampling/ring_count_satisfaction', 'test_sampling/Validity', 'test_sampling/Uniqueness', 'test_sampling/Novelty', 'test_sampling/fcd score']
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+------------------------+
| Metric                    | Value                  |
+===========================+========================+
| Total Molecules Generated | 2,000                  |
+---------------------------+------------------------+
| Valid Molecules (RDKit)   | 1,984 (99.20%)         |
+---------------------------+------------------------+
| Invalid Molecules         | 16 (0.80%)             |
+---------------------------+------------------------+
| Disconnected Molecules    | 1.65%                  |
+---------------------------+------------------------+
| Constraint Type           | ring_count_at_most ‚â§ 2 |
+---------------------------+------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 211/2000    | 10.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§1           | 883/2000    | 44.1%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 1827/2000   | 91.3%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§3           | 1984/2000   | 99.2%  |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 1984/2000   | 99.2%  |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 1984/2000   | 99.2%  |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 1984/2000   | 99.2%  |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§0           | 211/1984    | 10.6%  |            |
+--------------+-------------+--------+------------+
| ‚â§1           | 883/1984    | 44.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§2           | 1827/1984   | 92.1%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§3           | 1984/1984   | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§4           | 1984/1984   | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 1984/1984   | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 1984/1984   | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING COUNT DISTRIBUTION (ALL Molecules):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 211     | 10.5%        |
+---------+---------+--------------+
| 1       | 672     | 33.6%        |
+---------+---------+--------------+
| 2       | 944     | 47.2%        |
+---------+---------+--------------+
| 3       | 157     | 7.8%         |
+---------+---------+--------------+

üìä CHEMICAL RING COUNT DISTRIBUTION (Valid Molecules Only):
+---------+---------+--------------+
| Rings   | Count   | Percentage   |
+=========+=========+==============+
| 0       | 211     | 10.6%        |
+---------+---------+--------------+
| 1       | 672     | 33.9%        |
+---------+---------+--------------+
| 2       | 944     | 47.6%        |
+---------+---------+--------------+
| 3       | 157     | 7.9%         |
+---------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+---------------+
| Metric                    | Value         |
+===========================+===============+
| Total Molecules Generated | 2,000         |
+---------------------------+---------------+
| Valid Molecules (RDKit)   | 1,984 (99.2%) |
+---------------------------+---------------+
| Invalid Molecules         | 16 (0.8%)     |
+---------------------------+---------------+
| Disconnected Molecules    | 1.6%          |
+---------------------------+---------------+
| Average Molecular Weight  | 123.0         |
+---------------------------+---------------+
| Average Number of Atoms   | 8.8           |
+---------------------------+---------------+
| Average Number of Bonds   | 9.2           |
+---------------------------+---------------+
| Average Ring Count        | 1.5           |
+---------------------------+---------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+----------------+
| Metric                   | Value          |
+==========================+================+
| Valid Molecules (RDKit)  | 1,984 (99.20%) |
+--------------------------+----------------+
| Unique Molecules         | 1,970 (99.29%) |
+--------------------------+----------------+
| Novel Molecules          | 1,785 (90.61%) |
+--------------------------+----------------+
| FCD Score                | 1.320          |
+--------------------------+----------------+
| Average Molecular Weight | 123.0          |
+--------------------------+----------------+
| Average Number of Atoms  | 8.8            |
+--------------------------+----------------+
| Average Number of Bonds  | 9.2            |
+--------------------------+----------------+
| Average Ring Count       | 1.5            |
+--------------------------+----------------+
| Average Ring Length      | 4.3            |
+--------------------------+----------------+
| Average Valency          | 3.6            |
+--------------------------+----------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 91.3%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 92.1%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | -0.7%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 840.23 seconds |
+------------------------+----------------+
| Average Time per Batch | 84.02 seconds  |
+------------------------+----------------+
| Number of Batches      | 10             |
+------------------------+----------------+

================================================================================

================================================================================
All smiles saved on rank 0
Done. Sampling took 861.92 seconds

Test ends.
wandb: Waiting for W&B process to finish... (success).
wandb: - 63.359 MB of 63.359 MB uploaded (0.000 MB deduped)wandb: \ 63.359 MB of 63.359 MB uploaded (0.000 MB deduped)wandb: | 63.359 MB of 63.359 MB uploaded (0.000 MB deduped)wandb: / 63.359 MB of 63.359 MB uploaded (0.000 MB deduped)wandb: - 63.359 MB of 63.359 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:                             test/E_kl ‚ñÅ
wandb:                             test/X_kl ‚ñÅ
wandb:                       test/charges_kl ‚ñÅ
wandb:                        test/epoch_NLL ‚ñÅ
wandb:                    test_ratio/average ‚ñÅ
wandb:                  test_ratio/fcd score ‚ñÅ
wandb:                test_sampling/ChargeW1 ‚ñÅ
wandb:            test_sampling/Disconnected ‚ñÅ
wandb:             test_sampling/EdgeTypesTV ‚ñÅ
wandb:           test_sampling/MaxComponents ‚ñÅ
wandb:          test_sampling/MeanComponents ‚ñÅ
wandb:             test_sampling/NodeTypesTV ‚ñÅ
wandb:                 test_sampling/Novelty ‚ñÅ
wandb:              test_sampling/NumNodesW1 ‚ñÅ
wandb:              test_sampling/Uniqueness ‚ñÅ
wandb:               test_sampling/ValencyW1 ‚ñÅ
wandb:                test_sampling/Validity ‚ñÅ
wandb:               test_sampling/fcd score ‚ñÅ
wandb:      test_sampling/lobster_components ‚ñÅ
wandb:               test_sampling/no_cycles ‚ñÅ
wandb:               test_sampling/planarity ‚ñÅ
wandb: test_sampling/ring_count_satisfaction ‚ñÅ
wandb: 
wandb: Run summary:
wandb:                             test/E_kl 65.09752
wandb:                             test/X_kl 3.16779
wandb:                       test/charges_kl 0.54826
wandb:                        test/epoch_NLL 69.36895
wandb:                    test_ratio/average 1.53024
wandb:                  test_ratio/fcd score 1.53024
wandb:                test_sampling/ChargeW1 0.00466
wandb:            test_sampling/Disconnected 1.65
wandb:             test_sampling/EdgeTypesTV 0.0724
wandb:           test_sampling/MaxComponents 2.0
wandb:          test_sampling/MeanComponents 1.0165
wandb:             test_sampling/NodeTypesTV 0.02144
wandb:                 test_sampling/Novelty 90.60914
wandb:              test_sampling/NumNodesW1 0.00802
wandb:              test_sampling/Uniqueness 99.29435
wandb:               test_sampling/ValencyW1 0.06229
wandb:                test_sampling/Validity 99.2
wandb:               test_sampling/fcd score 1.32044
wandb:      test_sampling/lobster_components 0.1065
wandb:               test_sampling/no_cycles 0.1065
wandb:               test_sampling/planarity 1.0
wandb: test_sampling/ring_count_satisfaction 1.0
wandb: 
wandb: üöÄ View run qm9_thesis_ring_count_at_most_2 at: https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9/runs/92dbqqxq
wandb: Synced 6 W&B file(s), 700 media file(s), 0 artifact file(s) and 4 other file(s)
wandb: Find logs at: ./wandb/run-20250812_114806-92dbqqxq/logs
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Test metric             DataLoader 0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        test/E_kl            65.09751892089844
        test/X_kl            3.16778564453125
     test/charges_kl         0.548260509967804
     test/epoch_NLL          69.36894989013672
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Experiment completed at Tue 12 Aug 2025 12:03:03 PM UTC
