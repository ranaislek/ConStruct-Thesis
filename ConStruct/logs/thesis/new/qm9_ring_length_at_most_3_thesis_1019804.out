torch version: 2.0.1+cu118
CUDA available: True
CUDA device: NVIDIA RTX A5000
=== Running Experiment: ring_length_at_most_3_thesis ===
Config: thesis/edge_deletion/ring_length_at_most/qm9_thesis_ring_length_at_most_3
Job ID: 1019804
Node: vgpu8-0
Time: Tue 12 Aug 2025 02:56:13 AM UTC
<frozen importlib._bootstrap>:228: RuntimeWarning: to-Python converter for std::pair<double, double> already registered; second conversion method ignored.
[rank: 0] Global seed set to 0
Loading reference metrics.
Edge-deletion transition model (for 'at most' constraints)
[INFO] Early stopping enabled: monitoring 'val/epoch_NLL' with patience 10
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Global seed set to 0
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
[2025-08-12 02:56:41,259][torch.distributed.distributed_c10d][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
[2025-08-12 02:56:41,260][torch.distributed.distributed_c10d][INFO] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA RTX A5000') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                  | Params
----------------------------------------------------------------
0 | train_loss            | TrainLoss             | 0     
1 | train_metrics         | TrainMolecularMetrics | 0     
2 | val_metrics           | MetricCollection      | 0     
3 | val_nll               | NLL                   | 0     
4 | val_sampling_metrics  | SamplingMetrics       | 0     
5 | test_metrics          | MetricCollection      | 0     
6 | test_nll              | NLL                   | 0     
7 | test_sampling_metrics | SamplingMetrics       | 0     
8 | model                 | GraphTransformer      | 3.5 M 
----------------------------------------------------------------
3.5 M     Trainable params
0         Non-trainable params
3.5 M     Total params
13.901    Total estimated model params size (MB)
wandb: Currently logged in as: islekrana (islekrana-universit-di-padova). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.21.1 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /extra/rislek/ConStruct-Thesis/ConStruct/wandb/run-20250812_025642-mml1ztsl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run qm9_thesis_ring_length_at_most_3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9
wandb: üöÄ View run at https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9/runs/mml1ztsl
SLURM auto-requeueing enabled. Setting signal handlers.
Epoch 0: val/epoch_NLL: 279.43 -- val/X_kl: 5.66 -- val/E_kl: 254.33 -- val/charges_kl: 14.77 
Val loss: 279.4257 	 Best val loss:  279.4257

Val epoch 0 ends
Starting epoch 0
[2025-08-12 02:56:48,421][torch.nn.parallel.distributed][INFO] - Reducer buckets have been rebuilt in this iteration.
Train epoch 0 ends
Epoch 0 finished: X: 0.53 -- charges: 0.10 -- E: 0.41 -- y: -1.00 -- 74.6s 
Epoch 0: {'CarbonCE': 0.405, 'NitroCE': 0.244, 'OxyCE': 0.293, 'FluorCE': 0.015} -- {'NoBondCE': 0.345, 'SingleCE': 0.322, 'DoubleCE': 0.068, 'TripleCE': 0.027, 'AromaticCE': 0.004}
Starting epoch 1
Train epoch 1 ends
Epoch 1 finished: X: 0.48 -- charges: 0.08 -- E: 0.39 -- y: -1.00 -- 68.4s 
Epoch 1: {'CarbonCE': 0.373, 'NitroCE': 0.223, 'OxyCE': 0.268, 'FluorCE': 0.01} -- {'NoBondCE': 0.33, 'SingleCE': 0.309, 'DoubleCE': 0.061, 'TripleCE': 0.022, 'AromaticCE': 0.0}
Starting epoch 2
Train epoch 2 ends
Epoch 2 finished: X: 0.48 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 54.2s 
Epoch 2: {'CarbonCE': 0.368, 'NitroCE': 0.22, 'OxyCE': 0.265, 'FluorCE': 0.01} -- {'NoBondCE': 0.328, 'SingleCE': 0.307, 'DoubleCE': 0.06, 'TripleCE': 0.022, 'AromaticCE': 0.0}
Starting epoch 3
Train epoch 3 ends
Epoch 3 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 71.0s 
Epoch 3: {'CarbonCE': 0.365, 'NitroCE': 0.217, 'OxyCE': 0.263, 'FluorCE': 0.01} -- {'NoBondCE': 0.325, 'SingleCE': 0.304, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 4
Epoch 4: val/epoch_NLL: 71.10 -- val/X_kl: 3.28 -- val/E_kl: 66.65 -- val/charges_kl: 0.60 
Val loss: 71.0973 	 Best val loss:  71.0973

Val epoch 4 ends
Metric val/epoch_NLL improved. New best score: 71.097
Train epoch 4 ends
Epoch 4 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 81.1s 
Epoch 4: {'CarbonCE': 0.365, 'NitroCE': 0.217, 'OxyCE': 0.263, 'FluorCE': 0.009} -- {'NoBondCE': 0.324, 'SingleCE': 0.303, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 5
Train epoch 5 ends
Epoch 5 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 71.1s 
Epoch 5: {'CarbonCE': 0.363, 'NitroCE': 0.216, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.324, 'SingleCE': 0.303, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 6
Train epoch 6 ends
Epoch 6 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 70.5s 
Epoch 6: {'CarbonCE': 0.364, 'NitroCE': 0.216, 'OxyCE': 0.262, 'FluorCE': 0.009} -- {'NoBondCE': 0.324, 'SingleCE': 0.303, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 7
Train epoch 7 ends
Epoch 7 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 70.5s 
Epoch 7: {'CarbonCE': 0.362, 'NitroCE': 0.216, 'OxyCE': 0.261, 'FluorCE': 0.009} -- {'NoBondCE': 0.323, 'SingleCE': 0.303, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 8
Train epoch 8 ends
Epoch 8 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 70.1s 
Epoch 8: {'CarbonCE': 0.361, 'NitroCE': 0.214, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 9
Epoch 9: val/epoch_NLL: 68.94 -- val/X_kl: 3.18 -- val/E_kl: 64.61 -- val/charges_kl: 0.59 
Val loss: 68.9402 	 Best val loss:  68.9402

Val epoch 9 ends
Metric val/epoch_NLL improved by 2.157 >= min_delta = 0.003. New best score: 68.940
Train epoch 9 ends
Epoch 9 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 77.1s 
Epoch 9: {'CarbonCE': 0.359, 'NitroCE': 0.213, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 10
Train epoch 10 ends
Epoch 10 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 69.8s 
Epoch 10: {'CarbonCE': 0.36, 'NitroCE': 0.214, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 11
Train epoch 11 ends
Epoch 11 finished: X: 0.47 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 73.2s 
Epoch 11: {'CarbonCE': 0.36, 'NitroCE': 0.215, 'OxyCE': 0.26, 'FluorCE': 0.009} -- {'NoBondCE': 0.322, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 12
Train epoch 12 ends
Epoch 12 finished: X: 0.46 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 72.5s 
Epoch 12: {'CarbonCE': 0.359, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.301, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 13
Train epoch 13 ends
Epoch 13 finished: X: 0.46 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 70.3s 
Epoch 13: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.301, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 14
Epoch 14: val/epoch_NLL: 70.07 -- val/X_kl: 3.17 -- val/E_kl: 65.74 -- val/charges_kl: 0.61 
Val loss: 70.0687 	 Best val loss:  68.9402

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
[2025-08-12 03:14:42,744][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0022s, mode=INCREMENTAL
[2025-08-12 03:14:45,362][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0021s, mode=INCREMENTAL
[2025-08-12 03:14:47,980][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0020s, mode=INCREMENTAL
[2025-08-12 03:14:50,602][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0020s, mode=INCREMENTAL
[2025-08-12 03:14:53,231][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0028s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch14/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_length_at_most_3/epoch14_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_length_at_most_3/epoch14_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_length_at_most_3/epoch14_b50/graph_2.png to wandb
Done.
Sampling a batch with 150 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 03:15:25,900][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0061s, mode=INCREMENTAL
[2025-08-12 03:15:29,360][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0059s, mode=INCREMENTAL
[2025-08-12 03:15:32,822][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0059s, mode=INCREMENTAL
[2025-08-12 03:15:36,294][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0061s, mode=INCREMENTAL
[2025-08-12 03:15:39,808][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0117s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 59.73 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 3, Kekulize 0, other 0,  -- No error 197
DEBUG: Novelty calculation - unique molecules: 197, novel molecules: 189
DEBUG: Novelty percentage: 95.94%
DEBUG: Sample unique SMILES: 'N#CCC[NH+]1CC1CO'
DEBUG: Is in training set? False
DEBUG: Sample training SMILES: 'CO[C@@]1(C)C[C@H]2C[C@H]21'
DEBUG: Direct comparison: 'N#CCC[NH+]1CC1CO' == 'CO[C@@]1(C)C[C@H]2C[C@H]21'? False
Some generated smiles: COC(C#N)CC(C)F N=CNC(O)=NON=N CC#CC1CC1C1C[NH2+]1 CC=C(C)C(F)CC NC(CO)C1(O)CC1O CC1(N)CC12CC2C=O CC=NC(=CN)N=CN CC=CCCC(O)CO O=CCCCOCC=O COC(C=O)OC1CC1

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
DEBUG: Available computed_metrics keys: ['val_sampling/NumNodesW1', 'val_sampling/NodeTypesTV', 'val_sampling/EdgeTypesTV', 'val_sampling/Disconnected', 'val_sampling/MeanComponents', 'val_sampling/MaxComponents', 'val_sampling/planarity', 'val_sampling/no_cycles', 'val_sampling/lobster_components', 'val_sampling/generated_deg_hist', 'val_sampling/diff_deg_hist', 'val_sampling/abs_diff_deg_hist', 'val_sampling/ring_length_satisfaction', 'val_sampling/Validity', 'val_sampling/Uniqueness', 'val_sampling/Novelty', 'val_sampling/fcd score']
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+-------------------------+
| Metric                    | Value                   |
+===========================+=========================+
| Total Molecules Generated | 200                     |
+---------------------------+-------------------------+
| Valid Molecules (RDKit)   | 197 (98.50%)            |
+---------------------------+-------------------------+
| Invalid Molecules         | 3 (1.50%)               |
+---------------------------+-------------------------+
| Disconnected Molecules    | 4.00%                   |
+---------------------------+-------------------------+
| Constraint Type           | ring_length_at_most ‚â§ 3 |
+---------------------------+-------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§3           | 197/200     | 98.5%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§4           | 197/200     | 98.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 197/200     | 98.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 197/200     | 98.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§7           | 197/200     | 98.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§8           | 197/200     | 98.5%  |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§3           | 197/197     | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§4           | 197/197     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 197/197     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 197/197     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§7           | 197/197     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§8           | 197/197     | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING LENGTH DISTRIBUTION (ALL Molecules):
+---------------+---------+--------------+
| Ring Length   | Count   | Percentage   |
+===============+=========+==============+
| 0             | 99      | 49.5%        |
+---------------+---------+--------------+
| 3             | 98      | 49.0%        |
+---------------+---------+--------------+

üìä CHEMICAL RING LENGTH DISTRIBUTION (Valid Molecules Only):
+---------------+---------+--------------+
| Ring Length   | Count   | Percentage   |
+===============+=========+==============+
| 0             | 99      | 50.3%        |
+---------------+---------+--------------+
| 3             | 98      | 49.7%        |
+---------------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 200         |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 197 (98.5%) |
+---------------------------+-------------+
| Invalid Molecules         | 3 (1.5%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 4.0%        |
+---------------------------+-------------+
| Average Molecular Weight  | 124.7       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.7         |
+---------------------------+-------------+
| Average Number of Bonds   | 8.3         |
+---------------------------+-------------+
| Average Ring Count        | 0.6         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+---------------+
| Metric                   | Value         |
+==========================+===============+
| Valid Molecules (RDKit)  | 197 (98.50%)  |
+--------------------------+---------------+
| Unique Molecules         | 197 (100.00%) |
+--------------------------+---------------+
| Novel Molecules          | 189 (95.94%)  |
+--------------------------+---------------+
| FCD Score                | 5.758         |
+--------------------------+---------------+
| Average Molecular Weight | 124.7         |
+--------------------------+---------------+
| Average Number of Atoms  | 8.7           |
+--------------------------+---------------+
| Average Number of Bonds  | 8.3           |
+--------------------------+---------------+
| Average Ring Count       | 0.6           |
+--------------------------+---------------+
| Average Ring Length      | 3.0           |
+--------------------------+---------------+
| Average Valency          | 3.5           |
+--------------------------+---------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 98.5%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | -1.5%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+---------------+
| Metric                 | Value         |
+========================+===============+
| Total Sampling Time    | 59.72 seconds |
+------------------------+---------------+
| Average Time per Batch | 29.86 seconds |
+------------------------+---------------+
| Number of Batches      | 2             |
+------------------------+---------------+

================================================================================

================================================================================
Val epoch 14 ends
Train epoch 14 ends
Epoch 14 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 141.4s 
Epoch 14: {'CarbonCE': 0.358, 'NitroCE': 0.212, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 15
Train epoch 15 ends
Epoch 15 finished: X: 0.46 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 71.5s 
Epoch 15: {'CarbonCE': 0.359, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.008} -- {'NoBondCE': 0.321, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 16
Train epoch 16 ends
Epoch 16 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 71.1s 
Epoch 16: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 17
Train epoch 17 ends
Epoch 17 finished: X: 0.46 -- charges: 0.08 -- E: 0.38 -- y: -1.00 -- 55.6s 
Epoch 17: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 18
Train epoch 18 ends
Epoch 18 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 72.4s 
Epoch 18: {'CarbonCE': 0.359, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.3, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 19
Epoch 19: val/epoch_NLL: 70.66 -- val/X_kl: 3.11 -- val/E_kl: 66.40 -- val/charges_kl: 0.60 
Val loss: 70.6627 	 Best val loss:  68.9402

Val epoch 19 ends
Train epoch 19 ends
Epoch 19 finished: X: 0.47 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 73.2s 
Epoch 19: {'CarbonCE': 0.358, 'NitroCE': 0.214, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.321, 'SingleCE': 0.3, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 20
Train epoch 20 ends
Epoch 20 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 66.7s 
Epoch 20: {'CarbonCE': 0.357, 'NitroCE': 0.213, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.299, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 21
Train epoch 21 ends
Epoch 21 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 69.7s 
Epoch 21: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 22
Train epoch 22 ends
Epoch 22 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 73.2s 
Epoch 22: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 23
Train epoch 23 ends
Epoch 23 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 70.4s 
Epoch 23: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 24
Epoch 24: val/epoch_NLL: 67.96 -- val/X_kl: 3.17 -- val/E_kl: 63.64 -- val/charges_kl: 0.60 
Val loss: 67.9603 	 Best val loss:  67.9603

Val epoch 24 ends
Metric val/epoch_NLL improved by 0.980 >= min_delta = 0.003. New best score: 67.960
Train epoch 24 ends
Epoch 24 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 78.7s 
Epoch 24: {'CarbonCE': 0.357, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 25
Train epoch 25 ends
Epoch 25 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 71.8s 
Epoch 25: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 26
Train epoch 26 ends
Epoch 26 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 70.1s 
Epoch 26: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 27
Train epoch 27 ends
Epoch 27 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 68.5s 
Epoch 27: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 28
Train epoch 28 ends
Epoch 28 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 68.4s 
Epoch 28: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 29
Epoch 29: val/epoch_NLL: 70.94 -- val/X_kl: 3.10 -- val/E_kl: 66.70 -- val/charges_kl: 0.60 
Val loss: 70.9431 	 Best val loss:  67.9603

Val epoch 29 ends
Train epoch 29 ends
Epoch 29 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 79.0s 
Epoch 29: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 30
Train epoch 30 ends
Epoch 30 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 70.4s 
Epoch 30: {'CarbonCE': 0.356, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 31
Train epoch 31 ends
Epoch 31 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 63.4s 
Epoch 31: {'CarbonCE': 0.357, 'NitroCE': 0.213, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 32
Train epoch 32 ends
Epoch 32 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 60.0s 
Epoch 32: {'CarbonCE': 0.358, 'NitroCE': 0.213, 'OxyCE': 0.259, 'FluorCE': 0.009} -- {'NoBondCE': 0.32, 'SingleCE': 0.3, 'DoubleCE': 0.059, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 33
Train epoch 33 ends
Epoch 33 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 72.2s 
Epoch 33: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.259, 'FluorCE': 0.008} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 34
Epoch 34: val/epoch_NLL: 69.49 -- val/X_kl: 3.06 -- val/E_kl: 65.28 -- val/charges_kl: 0.59 
Val loss: 69.4854 	 Best val loss:  67.9603

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
[2025-08-12 03:39:12,709][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0020s, mode=INCREMENTAL
[2025-08-12 03:39:15,300][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0021s, mode=INCREMENTAL
[2025-08-12 03:39:17,891][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0021s, mode=INCREMENTAL
[2025-08-12 03:39:20,487][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0021s, mode=INCREMENTAL
[2025-08-12 03:39:23,086][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0039s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_length_at_most_3/epoch34_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_length_at_most_3/epoch34_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_length_at_most_3/epoch34_b50/graph_2.png to wandb
Done.
Sampling a batch with 150 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 03:39:55,493][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0065s, mode=INCREMENTAL
[2025-08-12 03:39:58,934][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0060s, mode=INCREMENTAL
[2025-08-12 03:40:02,427][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0064s, mode=INCREMENTAL
[2025-08-12 03:40:05,916][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0064s, mode=INCREMENTAL
[2025-08-12 03:40:09,421][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0085s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 59.36 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 5, Kekulize 0, other 0,  -- No error 195
DEBUG: Novelty calculation - unique molecules: 194, novel molecules: 180
DEBUG: Novelty percentage: 92.78%
DEBUG: Sample unique SMILES: 'COC(CO)C1CC1O'
DEBUG: Is in training set? False
DEBUG: Sample training SMILES: 'CO[C@@]1(C)C[C@H]2C[C@H]21'
DEBUG: Direct comparison: 'COC(CO)C1CC1O' == 'CO[C@@]1(C)C[C@H]2C[C@H]21'? False
Some generated smiles: C[NH+]1CC1C1(C)C[NH+]1C C#CC#CC(=O)C1CO1 CCNC=CC(O)CC CCN(C=O)C1CO1 CC1CC1C(O)CO CCC(C)(CC=O)OC CCC(C(C)O)C(C)O CCOC(C)=O CCC(=O)OC1CC1C CCCC(O)CC1CC1

================================================================================
üéØ TABLE-BASED CONSTRAINT ANALYSIS
================================================================================
DEBUG: Available computed_metrics keys: ['val_sampling/NumNodesW1', 'val_sampling/NodeTypesTV', 'val_sampling/EdgeTypesTV', 'val_sampling/Disconnected', 'val_sampling/MeanComponents', 'val_sampling/MaxComponents', 'val_sampling/planarity', 'val_sampling/no_cycles', 'val_sampling/lobster_components', 'val_sampling/generated_deg_hist', 'val_sampling/diff_deg_hist', 'val_sampling/abs_diff_deg_hist', 'val_sampling/ring_length_satisfaction', 'val_sampling/Validity', 'val_sampling/Uniqueness', 'val_sampling/Novelty', 'val_sampling/fcd score']
üéØ COMPREHENSIVE CONSTRAINT SATISFACTION ANALYSIS
================================================================================

+---------------------------+-------------------------+
| Metric                    | Value                   |
+===========================+=========================+
| Total Molecules Generated | 200                     |
+---------------------------+-------------------------+
| Valid Molecules (RDKit)   | 195 (97.50%)            |
+---------------------------+-------------------------+
| Invalid Molecules         | 5 (2.50%)               |
+---------------------------+-------------------------+
| Disconnected Molecules    | 1.00%                   |
+---------------------------+-------------------------+
| Constraint Type           | ring_length_at_most ‚â§ 3 |
+---------------------------+-------------------------+

üèóÔ∏è STRUCTURAL CONSTRAINT ENFORCEMENT (ALL Molecules - ConStruct Philosophy):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§3           | 195/200     | 97.5%  | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§4           | 195/200     | 97.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 195/200     | 97.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 195/200     | 97.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§7           | 195/200     | 97.5%  |            |
+--------------+-------------+--------+------------+
| ‚â§8           | 195/200     | 97.5%  |            |
+--------------+-------------+--------+------------+

üß™ CHEMICAL CONSTRAINT ENFORCEMENT (Valid Molecules Only):
+--------------+-------------+--------+------------+
| Constraint   | Satisfied   | Rate   | Status     |
+==============+=============+========+============+
| ‚â§3           | 195/195     | 100.0% | ‚≠ê ENFORCED |
+--------------+-------------+--------+------------+
| ‚â§4           | 195/195     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§5           | 195/195     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§6           | 195/195     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§7           | 195/195     | 100.0% |            |
+--------------+-------------+--------+------------+
| ‚â§8           | 195/195     | 100.0% |            |
+--------------+-------------+--------+------------+

üìä STRUCTURAL RING LENGTH DISTRIBUTION (ALL Molecules):
+---------------+---------+--------------+
| Ring Length   | Count   | Percentage   |
+===============+=========+==============+
| 0             | 100     | 50.0%        |
+---------------+---------+--------------+
| 3             | 95      | 47.5%        |
+---------------+---------+--------------+

üìä CHEMICAL RING LENGTH DISTRIBUTION (Valid Molecules Only):
+---------------+---------+--------------+
| Ring Length   | Count   | Percentage   |
+===============+=========+==============+
| 0             | 100     | 51.3%        |
+---------------+---------+--------------+
| 3             | 95      | 48.7%        |
+---------------+---------+--------------+

üìä MOLECULAR QUALITY METRICS (ALL Molecules):
+---------------------------+-------------+
| Metric                    | Value       |
+===========================+=============+
| Total Molecules Generated | 200         |
+---------------------------+-------------+
| Valid Molecules (RDKit)   | 195 (97.5%) |
+---------------------------+-------------+
| Invalid Molecules         | 5 (2.5%)    |
+---------------------------+-------------+
| Disconnected Molecules    | 1.0%        |
+---------------------------+-------------+
| Average Molecular Weight  | 125.0       |
+---------------------------+-------------+
| Average Number of Atoms   | 8.8         |
+---------------------------+-------------+
| Average Number of Bonds   | 8.4         |
+---------------------------+-------------+
| Average Ring Count        | 0.6         |
+---------------------------+-------------+

üéØ MOLECULAR QUALITY METRICS (Valid Molecules Only):
+--------------------------+--------------+
| Metric                   | Value        |
+==========================+==============+
| Valid Molecules (RDKit)  | 195 (97.50%) |
+--------------------------+--------------+
| Unique Molecules         | 194 (99.49%) |
+--------------------------+--------------+
| Novel Molecules          | 180 (92.78%) |
+--------------------------+--------------+
| FCD Score                | 6.174        |
+--------------------------+--------------+
| Average Molecular Weight | 125.0        |
+--------------------------+--------------+
| Average Number of Atoms  | 8.8          |
+--------------------------+--------------+
| Average Number of Bonds  | 8.4          |
+--------------------------+--------------+
| Average Ring Count       | 0.6          |
+--------------------------+--------------+
| Average Ring Length      | 3.0          |
+--------------------------+--------------+
| Average Valency          | 3.6          |
+--------------------------+--------------+

üîç GAP ANALYSIS (ConStruct Philosophy):
+-------------------------------+-----------------------------------------------------------------------+
| Metric                        | Value                                                                 |
+===============================+=======================================================================+
| Structural Satisfaction (ALL) | 97.5%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Chemical Satisfaction (Valid) | 100.0%                                                                |
+-------------------------------+-----------------------------------------------------------------------+
| Gap (Structural - Chemical)   | -2.5%                                                                 |
+-------------------------------+-----------------------------------------------------------------------+
| Gap Explanation               | Shows difference between structural enforcement and chemical validity |
+-------------------------------+-----------------------------------------------------------------------+

‚è±Ô∏è TIMING METRICS:
+------------------------+----------------+
| Metric                 | Value          |
+========================+================+
| Total Sampling Time    | 119.06 seconds |
+------------------------+----------------+
| Average Time per Batch | 29.76 seconds  |
+------------------------+----------------+
| Number of Batches      | 4              |
+------------------------+----------------+

================================================================================

================================================================================
Val epoch 34 ends
Train epoch 34 ends
Epoch 34 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 142.7s 
Epoch 34: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 35
Train epoch 35 ends
Epoch 35 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 70.3s 
Epoch 35: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 36
Train epoch 36 ends
Epoch 36 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 63.8s 
Epoch 36: {'CarbonCE': 0.356, 'NitroCE': 0.211, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 37
Train epoch 37 ends
Epoch 37 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 69.3s 
Epoch 37: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 38
Train epoch 38 ends
Epoch 38 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 72.5s 
Epoch 38: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 39
Epoch 39: val/epoch_NLL: 69.08 -- val/X_kl: 3.09 -- val/E_kl: 64.85 -- val/charges_kl: 0.62 
Val loss: 69.0766 	 Best val loss:  67.9603

Val epoch 39 ends
Train epoch 39 ends
Epoch 39 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 79.6s 
Epoch 39: {'CarbonCE': 0.356, 'NitroCE': 0.212, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 40
Train epoch 40 ends
Epoch 40 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 65.9s 
Epoch 40: {'CarbonCE': 0.356, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 41
Train epoch 41 ends
Epoch 41 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 62.5s 
Epoch 41: {'CarbonCE': 0.357, 'NitroCE': 0.212, 'OxyCE': 0.259, 'FluorCE': 0.008} -- {'NoBondCE': 0.319, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 42
Train epoch 42 ends
Epoch 42 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 70.9s 
Epoch 42: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 43
Train epoch 43 ends
Epoch 43 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 71.1s 
Epoch 43: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.008} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 44
Epoch 44: val/epoch_NLL: 69.87 -- val/X_kl: 3.06 -- val/E_kl: 65.70 -- val/charges_kl: 0.57 
Val loss: 69.8652 	 Best val loss:  67.9603

Val epoch 44 ends
Train epoch 44 ends
Epoch 44 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 80.0s 
Epoch 44: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 45
Train epoch 45 ends
Epoch 45 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 72.1s 
Epoch 45: {'CarbonCE': 0.356, 'NitroCE': 0.211, 'OxyCE': 0.258, 'FluorCE': 0.009} -- {'NoBondCE': 0.319, 'SingleCE': 0.299, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 46
Train epoch 46 ends
Epoch 46 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 72.3s 
Epoch 46: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.008} -- {'NoBondCE': 0.318, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 47
Train epoch 47 ends
Epoch 47 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 72.6s 
Epoch 47: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 48
Train epoch 48 ends
Epoch 48 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 69.7s 
Epoch 48: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 49
Epoch 49: val/epoch_NLL: 70.60 -- val/X_kl: 3.04 -- val/E_kl: 66.40 -- val/charges_kl: 0.59 
Val loss: 70.6014 	 Best val loss:  67.9603

Val epoch 49 ends
Train epoch 49 ends
Epoch 49 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 75.7s 
Epoch 49: {'CarbonCE': 0.354, 'NitroCE': 0.21, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 50
Train epoch 50 ends
Epoch 50 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 70.5s 
Epoch 50: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.256, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 51
Train epoch 51 ends
Epoch 51 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 71.7s 
Epoch 51: {'CarbonCE': 0.355, 'NitroCE': 0.211, 'OxyCE': 0.256, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 52
Train epoch 52 ends
Epoch 52 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 71.4s 
Epoch 52: {'CarbonCE': 0.355, 'NitroCE': 0.212, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.317, 'SingleCE': 0.297, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 53
Train epoch 53 ends
Epoch 53 finished: X: 0.46 -- charges: 0.08 -- E: 0.37 -- y: -1.00 -- 74.5s 
Epoch 53: {'CarbonCE': 0.354, 'NitroCE': 0.21, 'OxyCE': 0.257, 'FluorCE': 0.009} -- {'NoBondCE': 0.318, 'SingleCE': 0.298, 'DoubleCE': 0.058, 'TripleCE': 0.021, 'AromaticCE': 0.0}
Starting epoch 54
Epoch 54: val/epoch_NLL: 71.52 -- val/X_kl: 3.16 -- val/E_kl: 67.21 -- val/charges_kl: 0.61 
Val loss: 71.5183 	 Best val loss:  67.9603

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
[2025-08-12 04:04:11,328][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0020s, mode=INCREMENTAL
[2025-08-12 04:04:13,944][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0021s, mode=INCREMENTAL
[2025-08-12 04:04:16,576][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0021s, mode=INCREMENTAL
[2025-08-12 04:04:19,196][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0023s, mode=INCREMENTAL
[2025-08-12 04:04:21,831][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0042s, mode=INCREMENTAL
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch54/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_length_at_most_3/epoch54_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_length_at_most_3/epoch54_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_ring_length_at_most_3/epoch54_b50/graph_2.png to wandb
Done.
Sampling a batch with 150 graphs on local rank 0. Saving 0 visualization and 0 full chains.
[2025-08-12 04:04:55,010][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0061s, mode=INCREMENTAL
[2025-08-12 04:04:58,469][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0059s, mode=INCREMENTAL
[2025-08-12 04:05:01,921][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0058s, mode=INCREMENTAL
[2025-08-12 04:05:05,386][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0060s, mode=INCREMENTAL
[2025-08-12 04:05:08,886][ConStruct.projector.projector_utils][INFO] - ‚è±Ô∏è RingLengthAtMostProjector: projection_time=0.0116s, mode=INCREMENTAL
Done.
Sampled 2 batches on local rank 0. Sampling took 60.22 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 3, Kekulize 0, other 0,  -- No error 197
DEBUG: Novelty calculation - unique molecules: 197, novel molecules: 193
DEBUG: Novelty percentage: 97.97%
DEBUG: Sample unique SMILES: 'CCC1(C)CC1(C)CC'
DEBUG: Is in training set? False
DEBUG: Sample training SMILES: 'CO[C@@]1(C)C[C@H]2C[C@H]21'
DEBUG: Direct comparison: 'CCC1(C)CC1(C)CC' == 'CO[C@@]1(C)C[C@H]2C[C@H]21'? False
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
slurmstepd-vgpu8-0: error: *** JOB 1019804 ON vgpu8-0 CANCELLED AT 2025-08-12T15:37:03 ***
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Exception in thread NetStatThr:
Traceback (most recent call last):
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/threading.py", line 980, in _bootstrap_inner
Exception in thread ChkStopThr:
Traceback (most recent call last):
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/threading.py", line 980, in _bootstrap_inner
    self.run()
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/threading.py", line 917, in run
    self.run()
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/threading.py", line 917, in run
    self._target(*self._args, **self._kwargs)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 275, in check_stop_status
    self._target(*self._args, **self._kwargs)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 257, in check_network_status
        self._loop_check_status(
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 213, in _loop_check_status
self._loop_check_status(
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 213, in _loop_check_status
    local_handle = request()
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/interface/interface.py", line 797, in deliver_network_status
    local_handle = request()
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/interface/interface.py", line 789, in deliver_stop_status
    return self._deliver_stop_status(status)
    return self._deliver_network_status(status)  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 585, in _deliver_stop_status

  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 601, in _deliver_network_status
    return self._deliver_record(record)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 560, in _deliver_record
    return self._deliver_record(record)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 560, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    interface._publish(record)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    interface._publish(record)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    self._sock_client.send_record_publish(record)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self._sock_client.send_record_publish(record)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
        self.send_server_request(server_req)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
self.send_server_request(server_req)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self._send_message(msg)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    self._send_message(msg)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
    self._sendall_with_error_handle(header + data)
  File "/home/rislek/.conda/envs/construct-env/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
