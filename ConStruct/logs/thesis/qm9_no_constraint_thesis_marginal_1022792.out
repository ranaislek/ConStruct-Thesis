torch version: 2.0.1+cu118
CUDA available: True
CUDA device: NVIDIA RTX A5000
=== Running Experiment: qm9_no_constraint_thesis ===
Config: thesis/no_constraint/qm9_thesis_no_constraint
Job ID: 1022792
Node: vgpu2-1
Time: Sat 16 Aug 2025 02:26:24 AM UTC
<frozen importlib._bootstrap>:228: RuntimeWarning: to-Python converter for std::pair<double, double> already registered; second conversion method ignored.
[rank: 0] Global seed set to 0
Loading reference metrics.
Marginal distribution of the classes: nodes: tensor([0.7231, 0.1151, 0.1591, 0.0026]) -- edges: tensor([0.7261, 0.2383, 0.0274, 0.0082, 0.0000]) --charges: tensor([0.0078, 0.9705, 0.0218])
[INFO] Early stopping enabled: monitoring 'val/epoch_NLL' with patience 28
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[rank: 0] Global seed set to 0
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
[2025-08-16 02:27:18,815][torch.distributed.distributed_c10d][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
[2025-08-16 02:27:18,816][torch.distributed.distributed_c10d][INFO] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA RTX A5000') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                  | Type                  | Params
----------------------------------------------------------------
0 | train_loss            | TrainLoss             | 0     
1 | train_metrics         | TrainMolecularMetrics | 0     
2 | val_metrics           | MetricCollection      | 0     
3 | val_nll               | NLL                   | 0     
4 | val_sampling_metrics  | SamplingMetrics       | 0     
5 | test_metrics          | MetricCollection      | 0     
6 | test_nll              | NLL                   | 0     
7 | test_sampling_metrics | SamplingMetrics       | 0     
8 | model                 | GraphTransformer      | 3.5 M 
----------------------------------------------------------------
3.5 M     Trainable params
0         Non-trainable params
3.5 M     Total params
13.901    Total estimated model params size (MB)
wandb: Currently logged in as: islekrana (islekrana-universit-di-padova). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.21.1 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /extra/rislek/ConStruct-Thesis/ConStruct/wandb/run-20250816_022721-7o8tnyba
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run qm9_thesis_no_constraint_marginal
wandb: ⭐️ View project at https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9
wandb: 🚀 View run at https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9/runs/7o8tnyba
SLURM auto-requeueing enabled. Setting signal handlers.
Epoch 0: val/epoch_NLL: 138.60 -- val/X_kl: 5.96 -- val/E_kl: 113.28 -- val/charges_kl: 14.70 
Val loss: 138.6036 	 Best val loss:  138.6036

Val epoch 0 ends
Starting epoch 0
[2025-08-16 02:27:30,646][torch.nn.parallel.distributed][INFO] - Reducer buckets have been rebuilt in this iteration.
Train epoch 0 ends
Epoch 0 finished: X: 0.53 -- charges: 0.10 -- E: 0.47 -- y: -1.00 -- 105.9s 
Epoch 0: {'CarbonCE': 0.406, 'NitroCE': 0.241, 'OxyCE': 0.296, 'FluorCE': 0.014} -- {'NoBondCE': 0.396, 'SingleCE': 0.37, 'DoubleCE': 0.079, 'TripleCE': 0.03, 'AromaticCE': 0.003}
Starting epoch 1
Train epoch 1 ends
Epoch 1 finished: X: 0.50 -- charges: 0.09 -- E: 0.45 -- y: -1.00 -- 106.7s 
Epoch 1: {'CarbonCE': 0.385, 'NitroCE': 0.227, 'OxyCE': 0.281, 'FluorCE': 0.011} -- {'NoBondCE': 0.381, 'SingleCE': 0.358, 'DoubleCE': 0.075, 'TripleCE': 0.027, 'AromaticCE': 0.0}
Starting epoch 2
Train epoch 2 ends
Epoch 2 finished: X: 0.50 -- charges: 0.09 -- E: 0.45 -- y: -1.00 -- 109.5s 
Epoch 2: {'CarbonCE': 0.382, 'NitroCE': 0.225, 'OxyCE': 0.279, 'FluorCE': 0.01} -- {'NoBondCE': 0.38, 'SingleCE': 0.357, 'DoubleCE': 0.075, 'TripleCE': 0.027, 'AromaticCE': 0.0}
Starting epoch 3
Train epoch 3 ends
Epoch 3 finished: X: 0.49 -- charges: 0.09 -- E: 0.45 -- y: -1.00 -- 112.7s 
Epoch 3: {'CarbonCE': 0.379, 'NitroCE': 0.223, 'OxyCE': 0.277, 'FluorCE': 0.01} -- {'NoBondCE': 0.377, 'SingleCE': 0.355, 'DoubleCE': 0.074, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 4
Epoch 4: val/epoch_NLL: 29.08 -- val/X_kl: 3.48 -- val/E_kl: 24.41 -- val/charges_kl: 0.63 
Val loss: 29.0811 	 Best val loss:  29.0811

Val epoch 4 ends
Metric val/epoch_NLL improved. New best score: 29.081
Train epoch 4 ends
Epoch 4 finished: X: 0.49 -- charges: 0.09 -- E: 0.45 -- y: -1.00 -- 120.5s 
Epoch 4: {'CarbonCE': 0.38, 'NitroCE': 0.224, 'OxyCE': 0.277, 'FluorCE': 0.01} -- {'NoBondCE': 0.377, 'SingleCE': 0.355, 'DoubleCE': 0.074, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 5
Train epoch 5 ends
Epoch 5 finished: X: 0.49 -- charges: 0.09 -- E: 0.45 -- y: -1.00 -- 105.0s 
Epoch 5: {'CarbonCE': 0.379, 'NitroCE': 0.222, 'OxyCE': 0.277, 'FluorCE': 0.01} -- {'NoBondCE': 0.377, 'SingleCE': 0.355, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 6
Train epoch 6 ends
Epoch 6 finished: X: 0.49 -- charges: 0.08 -- E: 0.45 -- y: -1.00 -- 106.0s 
Epoch 6: {'CarbonCE': 0.379, 'NitroCE': 0.223, 'OxyCE': 0.277, 'FluorCE': 0.01} -- {'NoBondCE': 0.377, 'SingleCE': 0.355, 'DoubleCE': 0.074, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 7
Train epoch 7 ends
Epoch 7 finished: X: 0.49 -- charges: 0.09 -- E: 0.45 -- y: -1.00 -- 113.5s 
Epoch 7: {'CarbonCE': 0.378, 'NitroCE': 0.222, 'OxyCE': 0.277, 'FluorCE': 0.01} -- {'NoBondCE': 0.377, 'SingleCE': 0.355, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 8
Train epoch 8 ends
Epoch 8 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 106.6s 
Epoch 8: {'CarbonCE': 0.377, 'NitroCE': 0.221, 'OxyCE': 0.276, 'FluorCE': 0.01} -- {'NoBondCE': 0.376, 'SingleCE': 0.354, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 9
Epoch 9: val/epoch_NLL: 28.71 -- val/X_kl: 3.41 -- val/E_kl: 24.12 -- val/charges_kl: 0.62 
Val loss: 28.7146 	 Best val loss:  28.7146

Val epoch 9 ends
Metric val/epoch_NLL improved by 0.367 >= min_delta = 0.0001. New best score: 28.715
Train epoch 9 ends
Epoch 9 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 127.3s 
Epoch 9: {'CarbonCE': 0.376, 'NitroCE': 0.221, 'OxyCE': 0.275, 'FluorCE': 0.01} -- {'NoBondCE': 0.375, 'SingleCE': 0.353, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 10
Train epoch 10 ends
Epoch 10 finished: X: 0.49 -- charges: 0.08 -- E: 0.45 -- y: -1.00 -- 113.1s 
Epoch 10: {'CarbonCE': 0.377, 'NitroCE': 0.221, 'OxyCE': 0.275, 'FluorCE': 0.01} -- {'NoBondCE': 0.376, 'SingleCE': 0.354, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 11
Train epoch 11 ends
Epoch 11 finished: X: 0.49 -- charges: 0.08 -- E: 0.45 -- y: -1.00 -- 108.3s 
Epoch 11: {'CarbonCE': 0.378, 'NitroCE': 0.222, 'OxyCE': 0.276, 'FluorCE': 0.01} -- {'NoBondCE': 0.376, 'SingleCE': 0.354, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 12
Train epoch 12 ends
Epoch 12 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.5s 
Epoch 12: {'CarbonCE': 0.376, 'NitroCE': 0.22, 'OxyCE': 0.275, 'FluorCE': 0.01} -- {'NoBondCE': 0.375, 'SingleCE': 0.353, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 13
Train epoch 13 ends
Epoch 13 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 106.7s 
Epoch 13: {'CarbonCE': 0.375, 'NitroCE': 0.22, 'OxyCE': 0.275, 'FluorCE': 0.009} -- {'NoBondCE': 0.375, 'SingleCE': 0.353, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 14
Epoch 14: val/epoch_NLL: 29.21 -- val/X_kl: 3.43 -- val/E_kl: 24.55 -- val/charges_kl: 0.68 
Val loss: 29.2083 	 Best val loss:  28.7146

Val epoch 14 ends
Train epoch 14 ends
Epoch 14 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 119.1s 
Epoch 14: {'CarbonCE': 0.375, 'NitroCE': 0.22, 'OxyCE': 0.275, 'FluorCE': 0.009} -- {'NoBondCE': 0.375, 'SingleCE': 0.353, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 15
Train epoch 15 ends
Epoch 15 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 104.6s 
Epoch 15: {'CarbonCE': 0.376, 'NitroCE': 0.22, 'OxyCE': 0.275, 'FluorCE': 0.01} -- {'NoBondCE': 0.375, 'SingleCE': 0.353, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 16
Train epoch 16 ends
Epoch 16 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 104.5s 
Epoch 16: {'CarbonCE': 0.376, 'NitroCE': 0.22, 'OxyCE': 0.275, 'FluorCE': 0.009} -- {'NoBondCE': 0.376, 'SingleCE': 0.354, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 17
Train epoch 17 ends
Epoch 17 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 114.8s 
Epoch 17: {'CarbonCE': 0.375, 'NitroCE': 0.22, 'OxyCE': 0.275, 'FluorCE': 0.01} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 18
Train epoch 18 ends
Epoch 18 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 105.3s 
Epoch 18: {'CarbonCE': 0.374, 'NitroCE': 0.22, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 19
Epoch 19: val/epoch_NLL: 28.55 -- val/X_kl: 3.39 -- val/E_kl: 23.96 -- val/charges_kl: 0.64 
Val loss: 28.5452 	 Best val loss:  28.5452

Val epoch 19 ends
Metric val/epoch_NLL improved by 0.169 >= min_delta = 0.0001. New best score: 28.545
Train epoch 19 ends
Epoch 19 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 122.4s 
Epoch 19: {'CarbonCE': 0.375, 'NitroCE': 0.22, 'OxyCE': 0.275, 'FluorCE': 0.01} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 20
Train epoch 20 ends
Epoch 20 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 106.4s 
Epoch 20: {'CarbonCE': 0.374, 'NitroCE': 0.22, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 21
Train epoch 21 ends
Epoch 21 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 113.5s 
Epoch 21: {'CarbonCE': 0.377, 'NitroCE': 0.221, 'OxyCE': 0.275, 'FluorCE': 0.009} -- {'NoBondCE': 0.376, 'SingleCE': 0.353, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 22
Train epoch 22 ends
Epoch 22 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.7s 
Epoch 22: {'CarbonCE': 0.373, 'NitroCE': 0.22, 'OxyCE': 0.274, 'FluorCE': 0.01} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 23
Train epoch 23 ends
Epoch 23 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.8s 
Epoch 23: {'CarbonCE': 0.375, 'NitroCE': 0.22, 'OxyCE': 0.275, 'FluorCE': 0.01} -- {'NoBondCE': 0.375, 'SingleCE': 0.353, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 24
Epoch 24: val/epoch_NLL: 28.86 -- val/X_kl: 3.36 -- val/E_kl: 24.25 -- val/charges_kl: 0.66 
Val loss: 28.8647 	 Best val loss:  28.5452

Val epoch 24 ends
Train epoch 24 ends
Epoch 24 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 122.5s 
Epoch 24: {'CarbonCE': 0.375, 'NitroCE': 0.22, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.375, 'SingleCE': 0.352, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 25
Train epoch 25 ends
Epoch 25 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 104.4s 
Epoch 25: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 26
Train epoch 26 ends
Epoch 26 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.0s 
Epoch 26: {'CarbonCE': 0.374, 'NitroCE': 0.219, 'OxyCE': 0.275, 'FluorCE': 0.01} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 27
Train epoch 27 ends
Epoch 27 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 104.3s 
Epoch 27: {'CarbonCE': 0.375, 'NitroCE': 0.221, 'OxyCE': 0.274, 'FluorCE': 0.01} -- {'NoBondCE': 0.375, 'SingleCE': 0.353, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 28
Train epoch 28 ends
Epoch 28 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 104.6s 
Epoch 28: {'CarbonCE': 0.374, 'NitroCE': 0.22, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.375, 'SingleCE': 0.352, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 29
Epoch 29: val/epoch_NLL: 28.55 -- val/X_kl: 3.33 -- val/E_kl: 24.02 -- val/charges_kl: 0.65 
Val loss: 28.5486 	 Best val loss:  28.5452

Val epoch 29 ends
Train epoch 29 ends
Epoch 29 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 121.1s 
Epoch 29: {'CarbonCE': 0.374, 'NitroCE': 0.219, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 30
Train epoch 30 ends
Epoch 30 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 105.6s 
Epoch 30: {'CarbonCE': 0.374, 'NitroCE': 0.22, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 31
Train epoch 31 ends
Epoch 31 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.0s 
Epoch 31: {'CarbonCE': 0.374, 'NitroCE': 0.219, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 32
Train epoch 32 ends
Epoch 32 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 104.8s 
Epoch 32: {'CarbonCE': 0.373, 'NitroCE': 0.22, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 33
Train epoch 33 ends
Epoch 33 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 104.4s 
Epoch 33: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 34
Epoch 34: val/epoch_NLL: 28.87 -- val/X_kl: 3.37 -- val/E_kl: 24.31 -- val/charges_kl: 0.64 
Val loss: 28.8660 	 Best val loss:  28.5452

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
🔧 No constraint training - generating unrestricted graphs
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch34/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch34_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch34_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch34_b50/graph_2.png to wandb
Done.
Sampling a batch with 206 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampled 2 batches on local rank 0. Sampling took 97.27 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 1, Kekulize 0, other 0,  -- No error 255
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: OC12CC1[NH+]1CCC2C1 C1OC2C3CC4(CC24)C13 CCCNc1ccno1 O=CNC1CCC2CC21 Cc1nnc(O)nc1O CC(O)CC1(C#N)CO1 C#CC(CO)OC1CC1 C#CC1(O)CC1C(C)O C1=CC2(CC2)C2CC2C1 CCN1CC(=O)OC1=O

================================================================================
📊 CONSTRAINT SATISFACTION RESULTS
================================================================================

📋 **Definitions**:
• **FCD** — Fréchet ChemNet Distance computed on valid canonical SMILES; lower is better
• **Unique/Novel/Valid** — proportions computed over all generated molecules (not only valid)
• **Disconnected** — share of graphs with >1 connected component
• **Property satisfied** — share of generated graphs meeting the enforced structural constraint
• **V.U.N.** — product of Valid × Unique × Novel (in [0,100]%)

🔍 **LOGGING TO WANDB**:
============================================================
  val_sampling/NumNodesW1: 0.013470926322042942
  val_sampling/NodeTypesTV: 0.02309032343327999
  val_sampling/EdgeTypesTV: 0.06413137167692184
  val_sampling/Disconnected: 0.0
  val_sampling/MeanComponents: 1.0
  val_sampling/MaxComponents: 1.0
  val_sampling/planarity: 1.0
  val_sampling/no_cycles: 0.0859375
  val_sampling/lobster_components: 0.0859375
  val_sampling/generated_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4403da940>
  val_sampling/diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4403f8eb0>
  val_sampling/abs_diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4480e62b0>
  val_sampling/Validity: 99.609375
  val_sampling/Uniqueness: 100.0
  val_sampling/Novelty: 93.33333373069763
  val_sampling/fcd score: 2.4667325700749316
============================================================


🎯 CORE METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+-------------------------+--------------------+
| Metric                  | Value                |
+-------------------------+--------------------+
| Molecules generated (N) | 256                  |
| FCD                     | 2.467                |
| Unique (%)              | 100.00%              |
| Novel (%)               | 93.33%               |
| Valid (%)               | 99.61%               |
| Disconnected (%)        | 0.00%                |
| Property satisfied (%)  | —                    |
| V.U.N. (%)              | 92.97%               |
+-------------------------+--------------------+


🏗️ STRUCTURAL CONSTRAINT SATISFACTION:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Structural
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+----------------------------+--------------------------+
| Metric                     | Value                      |
+----------------------------+--------------------------+
| Constraint                 | No structural constraint   |
| Cycle rank 0 (%)           | 8.6%                       |
| Cycle rank 1 (%)           | 44.9%                      |
| Cycle rank 2 (%)           | 28.1%                      |
| Cycle rank 3 (%)           | 15.6%                      |
| Cycle rank 4 (%)           | 2.7%                       |
| Cycle rank 5 (%)           | 0.0%                       |
| Cycle rank 6 (%)           | 0.0%                       |
| Cycle rank 7 (%)           | 0.0%                       |
| Cycle rank 8 (%)           | 0.0%                       |
| Cycle rank 9+ (%)          | 0.0%                       |
| Acyclic (max len 0) (%)    | 8.6%                       |
| Cycle length 3 (max) (%)   | 12.5%                      |
| Cycle length 4 (max) (%)   | 17.6%                      |
| Cycle length 5 (max) (%)   | 42.2%                      |
| Cycle length 6 (max) (%)   | 11.7%                      |
| Cycle length 7 (max) (%)   | 5.1%                       |
| Cycle length 8 (max) (%)   | 2.3%                       |
| Cycle length 9 (max) (%)   | 0.0%                       |
| Cycle length 10 (max) (%)  | 0.0%                       |
| Cycle length 11 (max) (%)  | 0.0%                       |
| Cycle length 12 (max) (%)  | 0.0%                       |
| Cycle length >12 (max) (%) | 0.0%                       |
+----------------------------+--------------------------+


⏱️ TIMING METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Timing
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------------------------------------+
| Metric                          | Value                                              |
+---------------------------------+--------------------------------------------------+
| Sampling time (s) for N         | 97.23 for N=256                                    |
| Per-graph sampling time (ms)    | 379.8                                              |
| Sampling batches                | 2.00                                               |
| Projector mean time (ms)        | 0.0 (no projection)                                |
| Projector share of sampling (%) | 0.0% (no projection)                               |
| Wall-clock (h:mm)               | 01:06                                              |
| Environment                     | gpu=NVIDIA RTX A5000, torch=2.0.1+cu118, cuda=...  |
+---------------------------------+--------------------------------------------------+


🧪 CHEMISTRY METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Chemistry
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------+
| Metric                          | Value                |
+---------------------------------+--------------------+
| Valid molecules used (chem)     | 255                  |
| Molecular weight (Da) mean ± sd | 123.4 ± 7.6          |
| Heavy atoms mean ± sd           | 8.8 ± 0.5            |
| Atom composition % (C/N/O/F)    | 72.0/12.7/15.1/0.2   |
+---------------------------------+--------------------+

Val epoch 34 ends
Train epoch 34 ends
Epoch 34 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 215.8s 
Epoch 34: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 35
Train epoch 35 ends
Epoch 35 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.3s 
Epoch 35: {'CarbonCE': 0.375, 'NitroCE': 0.22, 'OxyCE': 0.275, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 36
Train epoch 36 ends
Epoch 36 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 116.0s 
Epoch 36: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 37
Train epoch 37 ends
Epoch 37 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 113.6s 
Epoch 37: {'CarbonCE': 0.375, 'NitroCE': 0.22, 'OxyCE': 0.275, 'FluorCE': 0.009} -- {'NoBondCE': 0.375, 'SingleCE': 0.353, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 38
Train epoch 38 ends
Epoch 38 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.3s 
Epoch 38: {'CarbonCE': 0.373, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 39
Epoch 39: val/epoch_NLL: 28.58 -- val/X_kl: 3.34 -- val/E_kl: 24.05 -- val/charges_kl: 0.64 
Val loss: 28.5776 	 Best val loss:  28.5452

Val epoch 39 ends
Train epoch 39 ends
Epoch 39 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 121.6s 
Epoch 39: {'CarbonCE': 0.374, 'NitroCE': 0.22, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 40
Train epoch 40 ends
Epoch 40 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.6s 
Epoch 40: {'CarbonCE': 0.374, 'NitroCE': 0.219, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 41
Train epoch 41 ends
Epoch 41 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.9s 
Epoch 41: {'CarbonCE': 0.374, 'NitroCE': 0.22, 'OxyCE': 0.274, 'FluorCE': 0.01} -- {'NoBondCE': 0.374, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 42
Train epoch 42 ends
Epoch 42 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.5s 
Epoch 42: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 43
Train epoch 43 ends
Epoch 43 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.4s 
Epoch 43: {'CarbonCE': 0.374, 'NitroCE': 0.22, 'OxyCE': 0.274, 'FluorCE': 0.01} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 44
Epoch 44: val/epoch_NLL: 28.69 -- val/X_kl: 3.38 -- val/E_kl: 24.12 -- val/charges_kl: 0.65 
Val loss: 28.6891 	 Best val loss:  28.5452

Val epoch 44 ends
Train epoch 44 ends
Epoch 44 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 127.5s 
Epoch 44: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 45
Train epoch 45 ends
Epoch 45 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 115.9s 
Epoch 45: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 46
Train epoch 46 ends
Epoch 46 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.6s 
Epoch 46: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 47
Train epoch 47 ends
Epoch 47 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.4s 
Epoch 47: {'CarbonCE': 0.374, 'NitroCE': 0.221, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 48
Train epoch 48 ends
Epoch 48 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.8s 
Epoch 48: {'CarbonCE': 0.374, 'NitroCE': 0.219, 'OxyCE': 0.274, 'FluorCE': 0.01} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 49
Epoch 49: val/epoch_NLL: 28.46 -- val/X_kl: 3.32 -- val/E_kl: 23.93 -- val/charges_kl: 0.65 
Val loss: 28.4584 	 Best val loss:  28.4584

Val epoch 49 ends
Metric val/epoch_NLL improved by 0.087 >= min_delta = 0.0001. New best score: 28.458
Train epoch 49 ends
Epoch 49 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 126.1s 
Epoch 49: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 50
Train epoch 50 ends
Epoch 50 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.0s 
Epoch 50: {'CarbonCE': 0.374, 'NitroCE': 0.22, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 51
Train epoch 51 ends
Epoch 51 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.4s 
Epoch 51: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 52
Train epoch 52 ends
Epoch 52 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.0s 
Epoch 52: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 53
Train epoch 53 ends
Epoch 53 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.8s 
Epoch 53: {'CarbonCE': 0.374, 'NitroCE': 0.22, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 54
Epoch 54: val/epoch_NLL: 28.80 -- val/X_kl: 3.34 -- val/E_kl: 24.26 -- val/charges_kl: 0.64 
Val loss: 28.7956 	 Best val loss:  28.4584

Val epoch 54 ends
Train epoch 54 ends
Epoch 54 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 121.3s 
Epoch 54: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.35, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 55
Train epoch 55 ends
Epoch 55 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 116.6s 
Epoch 55: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 56
Train epoch 56 ends
Epoch 56 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.1s 
Epoch 56: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 57
Train epoch 57 ends
Epoch 57 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.8s 
Epoch 57: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 58
Train epoch 58 ends
Epoch 58 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 116.8s 
Epoch 58: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 59
Epoch 59: val/epoch_NLL: 28.43 -- val/X_kl: 3.34 -- val/E_kl: 23.91 -- val/charges_kl: 0.64 
Val loss: 28.4284 	 Best val loss:  28.4284

Val epoch 59 ends
Metric val/epoch_NLL improved by 0.030 >= min_delta = 0.0001. New best score: 28.428
Train epoch 59 ends
Epoch 59 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 132.0s 
Epoch 59: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 60
Train epoch 60 ends
Epoch 60 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.5s 
Epoch 60: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 61
Train epoch 61 ends
Epoch 61 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.6s 
Epoch 61: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 62
Train epoch 62 ends
Epoch 62 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.0s 
Epoch 62: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 63
Train epoch 63 ends
Epoch 63 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 113.0s 
Epoch 63: {'CarbonCE': 0.373, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 64
Epoch 64: val/epoch_NLL: 28.60 -- val/X_kl: 3.32 -- val/E_kl: 24.08 -- val/charges_kl: 0.66 
Val loss: 28.6037 	 Best val loss:  28.4284

Val epoch 64 ends
Train epoch 64 ends
Epoch 64 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 126.0s 
Epoch 64: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 65
Train epoch 65 ends
Epoch 65 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.4s 
Epoch 65: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 66
Train epoch 66 ends
Epoch 66 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.5s 
Epoch 66: {'CarbonCE': 0.37, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 67
Train epoch 67 ends
Epoch 67 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.7s 
Epoch 67: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 68
Train epoch 68 ends
Epoch 68 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.3s 
Epoch 68: {'CarbonCE': 0.374, 'NitroCE': 0.218, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 69
Epoch 69: val/epoch_NLL: 28.68 -- val/X_kl: 3.33 -- val/E_kl: 24.13 -- val/charges_kl: 0.66 
Val loss: 28.6776 	 Best val loss:  28.4284

Val epoch 69 ends
Train epoch 69 ends
Epoch 69 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 127.0s 
Epoch 69: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.274, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 70
Train epoch 70 ends
Epoch 70 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 115.8s 
Epoch 70: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 71
Train epoch 71 ends
Epoch 71 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.5s 
Epoch 71: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 72
Train epoch 72 ends
Epoch 72 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.9s 
Epoch 72: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.371, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 73
Train epoch 73 ends
Epoch 73 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.6s 
Epoch 73: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 74
Epoch 74: val/epoch_NLL: 28.22 -- val/X_kl: 3.31 -- val/E_kl: 23.71 -- val/charges_kl: 0.64 
Val loss: 28.2213 	 Best val loss:  28.2213

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch74/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch74_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch74_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch74_b50/graph_2.png to wandb
Done.
Sampling a batch with 206 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampled 2 batches on local rank 0. Sampling took 96.55 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 0, Kekulize 0, other 0,  -- No error 256
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: OCC1CC2C[NH+]2C1 C1=C2CC(C3CC3)C2C1 CC1OC2(C)CC2C1O CC(=O)C(=O)C(O)C#N C#CC1(C)C[NH+]2CC21 COC1(C)C2CC1C2O CC1C=CCC2(O)CC12 COC1C2COC1(C)C2 [NH-]c1c[nH]c(=NO)[nH]1 CCOC1(C)C#CCC1

================================================================================
📊 CONSTRAINT SATISFACTION RESULTS
================================================================================

📋 **Definitions**:
• **FCD** — Fréchet ChemNet Distance computed on valid canonical SMILES; lower is better
• **Unique/Novel/Valid** — proportions computed over all generated molecules (not only valid)
• **Disconnected** — share of graphs with >1 connected component
• **Property satisfied** — share of generated graphs meeting the enforced structural constraint
• **V.U.N.** — product of Valid × Unique × Novel (in [0,100]%)

🔍 **LOGGING TO WANDB**:
============================================================
  val_sampling/NumNodesW1: 0.01275797002017498
  val_sampling/NodeTypesTV: 0.05769728496670723
  val_sampling/EdgeTypesTV: 0.06077811121940613
  val_sampling/Disconnected: 1.171875
  val_sampling/MeanComponents: 1.01171875
  val_sampling/MaxComponents: 2.0
  val_sampling/planarity: 0.99609375
  val_sampling/no_cycles: 0.125
  val_sampling/lobster_components: 0.125
  val_sampling/generated_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4403d2370>
  val_sampling/diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4480e9670>
  val_sampling/abs_diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4480e9760>
  val_sampling/Validity: 100.0
  val_sampling/Uniqueness: 100.0
  val_sampling/Novelty: 92.578125
  val_sampling/fcd score: 2.737611994165718
============================================================


🎯 CORE METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+-------------------------+--------------------+
| Metric                  | Value                |
+-------------------------+--------------------+
| Molecules generated (N) | 256                  |
| FCD                     | 2.738                |
| Unique (%)              | 100.00%              |
| Novel (%)               | 92.58%               |
| Valid (%)               | 100.00%              |
| Disconnected (%)        | 1.17%                |
| Property satisfied (%)  | —                    |
| V.U.N. (%)              | 92.58%               |
+-------------------------+--------------------+


🏗️ STRUCTURAL CONSTRAINT SATISFACTION:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Structural
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+----------------------------+--------------------------+
| Metric                     | Value                      |
+----------------------------+--------------------------+
| Constraint                 | No structural constraint   |
| Cycle rank 0 (%)           | 12.5%                      |
| Cycle rank 1 (%)           | 34.8%                      |
| Cycle rank 2 (%)           | 32.0%                      |
| Cycle rank 3 (%)           | 15.6%                      |
| Cycle rank 4 (%)           | 4.3%                       |
| Cycle rank 5 (%)           | 0.8%                       |
| Cycle rank 6 (%)           | 0.0%                       |
| Cycle rank 7 (%)           | 0.0%                       |
| Cycle rank 8 (%)           | 0.0%                       |
| Cycle rank 9+ (%)          | 0.0%                       |
| Acyclic (max len 0) (%)    | 12.5%                      |
| Cycle length 3 (max) (%)   | 12.5%                      |
| Cycle length 4 (max) (%)   | 24.2%                      |
| Cycle length 5 (max) (%)   | 28.5%                      |
| Cycle length 6 (max) (%)   | 17.6%                      |
| Cycle length 7 (max) (%)   | 4.3%                       |
| Cycle length 8 (max) (%)   | 0.4%                       |
| Cycle length 9 (max) (%)   | 0.0%                       |
| Cycle length 10 (max) (%)  | 0.0%                       |
| Cycle length 11 (max) (%)  | 0.0%                       |
| Cycle length 12 (max) (%)  | 0.0%                       |
| Cycle length >12 (max) (%) | 0.0%                       |
+----------------------------+--------------------------+


⏱️ TIMING METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Timing
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------------------------------------+
| Metric                          | Value                                              |
+---------------------------------+--------------------------------------------------+
| Sampling time (s) for N         | 193.74 for N=256                                   |
| Per-graph sampling time (ms)    | 756.8                                              |
| Sampling batches                | 4.00                                               |
| Projector mean time (ms)        | 0.0 (no projection)                                |
| Projector share of sampling (%) | 0.0% (no projection)                               |
| Wall-clock (h:mm)               | 02:24                                              |
| Environment                     | gpu=NVIDIA RTX A5000, torch=2.0.1+cu118, cuda=...  |
+---------------------------------+--------------------------------------------------+


🧪 CHEMISTRY METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Chemistry
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------+
| Metric                          | Value                |
+---------------------------------+--------------------+
| Valid molecules used (chem)     | 256                  |
| Molecular weight (Da) mean ± sd | 122.3 ± 8.2          |
| Heavy atoms mean ± sd           | 8.8 ± 0.6            |
| Atom composition % (C/N/O/F)    | 75.2/9.8/14.9/0.0    |
+---------------------------------+--------------------+

Val epoch 74 ends
Metric val/epoch_NLL improved by 0.207 >= min_delta = 0.0001. New best score: 28.221
Train epoch 74 ends
Epoch 74 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 220.6s 
Epoch 74: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 75
Train epoch 75 ends
Epoch 75 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.2s 
Epoch 75: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 76
Train epoch 76 ends
Epoch 76 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.6s 
Epoch 76: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 77
Train epoch 77 ends
Epoch 77 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.3s 
Epoch 77: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 78
Train epoch 78 ends
Epoch 78 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.4s 
Epoch 78: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 79
Epoch 79: val/epoch_NLL: 28.72 -- val/X_kl: 3.37 -- val/E_kl: 24.15 -- val/charges_kl: 0.63 
Val loss: 28.7159 	 Best val loss:  28.2213

Val epoch 79 ends
Train epoch 79 ends
Epoch 79 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 118.9s 
Epoch 79: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 80
Train epoch 80 ends
Epoch 80 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.9s 
Epoch 80: {'CarbonCE': 0.371, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 81
Train epoch 81 ends
Epoch 81 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.2s 
Epoch 81: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 82
Train epoch 82 ends
Epoch 82 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.5s 
Epoch 82: {'CarbonCE': 0.371, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 83
Train epoch 83 ends
Epoch 83 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.0s 
Epoch 83: {'CarbonCE': 0.371, 'NitroCE': 0.219, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 84
Epoch 84: val/epoch_NLL: 28.25 -- val/X_kl: 3.33 -- val/E_kl: 23.72 -- val/charges_kl: 0.64 
Val loss: 28.2474 	 Best val loss:  28.2213

Val epoch 84 ends
Train epoch 84 ends
Epoch 84 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 123.2s 
Epoch 84: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 85
Train epoch 85 ends
Epoch 85 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.7s 
Epoch 85: {'CarbonCE': 0.373, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 86
Train epoch 86 ends
Epoch 86 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.8s 
Epoch 86: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 87
Train epoch 87 ends
Epoch 87 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.3s 
Epoch 87: {'CarbonCE': 0.373, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 88
Train epoch 88 ends
Epoch 88 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.4s 
Epoch 88: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 89
Epoch 89: val/epoch_NLL: 28.57 -- val/X_kl: 3.36 -- val/E_kl: 24.02 -- val/charges_kl: 0.65 
Val loss: 28.5656 	 Best val loss:  28.2213

Val epoch 89 ends
Train epoch 89 ends
Epoch 89 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 119.8s 
Epoch 89: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 90
Train epoch 90 ends
Epoch 90 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.4s 
Epoch 90: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 91
Train epoch 91 ends
Epoch 91 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.1s 
Epoch 91: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 92
Train epoch 92 ends
Epoch 92 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.6s 
Epoch 92: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 93
Train epoch 93 ends
Epoch 93 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.7s 
Epoch 93: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 94
Epoch 94: val/epoch_NLL: 28.22 -- val/X_kl: 3.27 -- val/E_kl: 23.76 -- val/charges_kl: 0.63 
Val loss: 28.2230 	 Best val loss:  28.2213

Val epoch 94 ends
Train epoch 94 ends
Epoch 94 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 125.9s 
Epoch 94: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 95
Train epoch 95 ends
Epoch 95 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.5s 
Epoch 95: {'CarbonCE': 0.373, 'NitroCE': 0.218, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.374, 'SingleCE': 0.352, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 96
Train epoch 96 ends
Epoch 96 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.7s 
Epoch 96: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 97
Train epoch 97 ends
Epoch 97 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.8s 
Epoch 97: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 98
Train epoch 98 ends
Epoch 98 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.4s 
Epoch 98: {'CarbonCE': 0.371, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 99
Epoch 99: val/epoch_NLL: 28.49 -- val/X_kl: 3.26 -- val/E_kl: 24.02 -- val/charges_kl: 0.65 
Val loss: 28.4914 	 Best val loss:  28.2213

Val epoch 99 ends
Train epoch 99 ends
Epoch 99 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 123.8s 
Epoch 99: {'CarbonCE': 0.373, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 100
Train epoch 100 ends
Epoch 100 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.9s 
Epoch 100: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 101
Train epoch 101 ends
Epoch 101 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.3s 
Epoch 101: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 102
Train epoch 102 ends
Epoch 102 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.1s 
Epoch 102: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 103
Train epoch 103 ends
Epoch 103 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.3s 
Epoch 103: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 104
Epoch 104: val/epoch_NLL: 28.66 -- val/X_kl: 3.35 -- val/E_kl: 24.12 -- val/charges_kl: 0.64 
Val loss: 28.6614 	 Best val loss:  28.2213

Val epoch 104 ends
Train epoch 104 ends
Epoch 104 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 119.6s 
Epoch 104: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.274, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 105
Train epoch 105 ends
Epoch 105 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.5s 
Epoch 105: {'CarbonCE': 0.371, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 106
Train epoch 106 ends
Epoch 106 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.4s 
Epoch 106: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 107
Train epoch 107 ends
Epoch 107 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.1s 
Epoch 107: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 108
Train epoch 108 ends
Epoch 108 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.7s 
Epoch 108: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 109
Epoch 109: val/epoch_NLL: 28.23 -- val/X_kl: 3.31 -- val/E_kl: 23.75 -- val/charges_kl: 0.62 
Val loss: 28.2340 	 Best val loss:  28.2213

Val epoch 109 ends
Train epoch 109 ends
Epoch 109 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 125.6s 
Epoch 109: {'CarbonCE': 0.37, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 110
Train epoch 110 ends
Epoch 110 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.2s 
Epoch 110: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 111
Train epoch 111 ends
Epoch 111 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.5s 
Epoch 111: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 112
Train epoch 112 ends
Epoch 112 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 116.3s 
Epoch 112: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 113
Train epoch 113 ends
Epoch 113 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.2s 
Epoch 113: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 114
Epoch 114: val/epoch_NLL: 28.62 -- val/X_kl: 3.34 -- val/E_kl: 24.08 -- val/charges_kl: 0.66 
Val loss: 28.6232 	 Best val loss:  28.2213

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch114/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch114/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch114/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch114/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch114/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch114/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch114/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch114/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch114/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch114/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch114_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch114_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch114_b50/graph_2.png to wandb
Done.
Sampling a batch with 206 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampled 2 batches on local rank 0. Sampling took 97.52 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 3, Kekulize 0, other 0,  -- No error 253
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: [NH-]C1OC2C3CC3CC12 C#CC(N)(CO)CC#N N#CC12CC3C1CCC32 COC1CC2(C)CC2[NH2+]1 C#CC1CC(C)=CC1C CC1C2C3C4C1C4(C)[NH+]23 Cc1nc(F)ncc1O C[CH-]C1CC2[NH2+][CH+]OC12 CC1C(O)C[NH+]2C(C)C12 CC1C2C3C(O)C2(C)[NH+]13

================================================================================
📊 CONSTRAINT SATISFACTION RESULTS
================================================================================

📋 **Definitions**:
• **FCD** — Fréchet ChemNet Distance computed on valid canonical SMILES; lower is better
• **Unique/Novel/Valid** — proportions computed over all generated molecules (not only valid)
• **Disconnected** — share of graphs with >1 connected component
• **Property satisfied** — share of generated graphs meeting the enforced structural constraint
• **V.U.N.** — product of Valid × Unique × Novel (in [0,100]%)

🔍 **LOGGING TO WANDB**:
============================================================
  val_sampling/NumNodesW1: 0.04010171815752983
  val_sampling/NodeTypesTV: 0.01959059201180935
  val_sampling/EdgeTypesTV: 0.06203358992934227
  val_sampling/Disconnected: 0.78125
  val_sampling/MeanComponents: 1.0078125
  val_sampling/MaxComponents: 2.0
  val_sampling/planarity: 1.0
  val_sampling/no_cycles: 0.09375
  val_sampling/lobster_components: 0.09375
  val_sampling/generated_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe458399f70>
  val_sampling/diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4480e5a00>
  val_sampling/abs_diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4480e5e20>
  val_sampling/Validity: 98.828125
  val_sampling/Uniqueness: 100.0
  val_sampling/Novelty: 89.32806253433228
  val_sampling/fcd score: 2.403850279935501
============================================================


🎯 CORE METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+-------------------------+--------------------+
| Metric                  | Value                |
+-------------------------+--------------------+
| Molecules generated (N) | 256                  |
| FCD                     | 2.404                |
| Unique (%)              | 100.00%              |
| Novel (%)               | 89.33%               |
| Valid (%)               | 98.83%               |
| Disconnected (%)        | 78.12%               |
| Property satisfied (%)  | —                    |
| V.U.N. (%)              | 88.28%               |
+-------------------------+--------------------+


🏗️ STRUCTURAL CONSTRAINT SATISFACTION:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Structural
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+----------------------------+--------------------------+
| Metric                     | Value                      |
+----------------------------+--------------------------+
| Constraint                 | No structural constraint   |
| Cycle rank 0 (%)           | 9.4%                       |
| Cycle rank 1 (%)           | 40.6%                      |
| Cycle rank 2 (%)           | 30.1%                      |
| Cycle rank 3 (%)           | 16.8%                      |
| Cycle rank 4 (%)           | 3.1%                       |
| Cycle rank 5 (%)           | 0.0%                       |
| Cycle rank 6 (%)           | 0.0%                       |
| Cycle rank 7 (%)           | 0.0%                       |
| Cycle rank 8 (%)           | 0.0%                       |
| Cycle rank 9+ (%)          | 0.0%                       |
| Acyclic (max len 0) (%)    | 9.4%                       |
| Cycle length 3 (max) (%)   | 8.2%                       |
| Cycle length 4 (max) (%)   | 25.4%                      |
| Cycle length 5 (max) (%)   | 37.1%                      |
| Cycle length 6 (max) (%)   | 14.5%                      |
| Cycle length 7 (max) (%)   | 5.1%                       |
| Cycle length 8 (max) (%)   | 0.4%                       |
| Cycle length 9 (max) (%)   | 0.0%                       |
| Cycle length 10 (max) (%)  | 0.0%                       |
| Cycle length 11 (max) (%)  | 0.0%                       |
| Cycle length 12 (max) (%)  | 0.0%                       |
| Cycle length >12 (max) (%) | 0.0%                       |
+----------------------------+--------------------------+


⏱️ TIMING METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Timing
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------------------------------------+
| Metric                          | Value                                              |
+---------------------------------+--------------------------------------------------+
| Sampling time (s) for N         | 291.21 for N=256                                   |
| Per-graph sampling time (ms)    | 1137.5                                             |
| Sampling batches                | 6.00                                               |
| Projector mean time (ms)        | 0.0 (no projection)                                |
| Projector share of sampling (%) | 0.0% (no projection)                               |
| Wall-clock (h:mm)               | 03:40                                              |
| Environment                     | gpu=NVIDIA RTX A5000, torch=2.0.1+cu118, cuda=...  |
+---------------------------------+--------------------------------------------------+


🧪 CHEMISTRY METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Chemistry
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------+
| Metric                          | Value                |
+---------------------------------+--------------------+
| Valid molecules used (chem)     | 253                  |
| Molecular weight (Da) mean ± sd | 122.1 ± 7.6          |
| Heavy atoms mean ± sd           | 8.8 ± 0.5            |
| Atom composition % (C/N/O/F)    | 73.2/11.5/15.1/0.2   |
+---------------------------------+--------------------+

Val epoch 114 ends
Train epoch 114 ends
Epoch 114 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 223.5s 
Epoch 114: {'CarbonCE': 0.369, 'NitroCE': 0.217, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 115
Train epoch 115 ends
Epoch 115 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.2s 
Epoch 115: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 116
Train epoch 116 ends
Epoch 116 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.3s 
Epoch 116: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 117
Train epoch 117 ends
Epoch 117 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.2s 
Epoch 117: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 118
Train epoch 118 ends
Epoch 118 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.8s 
Epoch 118: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 119
Epoch 119: val/epoch_NLL: 28.62 -- val/X_kl: 3.33 -- val/E_kl: 24.11 -- val/charges_kl: 0.61 
Val loss: 28.6160 	 Best val loss:  28.2213

Val epoch 119 ends
Train epoch 119 ends
Epoch 119 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 120.7s 
Epoch 119: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 120
Train epoch 120 ends
Epoch 120 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.6s 
Epoch 120: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 121
Train epoch 121 ends
Epoch 121 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 115.1s 
Epoch 121: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 122
Train epoch 122 ends
Epoch 122 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 119.4s 
Epoch 122: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 123
Train epoch 123 ends
Epoch 123 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 115.4s 
Epoch 123: {'CarbonCE': 0.373, 'NitroCE': 0.22, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 124
Epoch 124: val/epoch_NLL: 28.49 -- val/X_kl: 3.32 -- val/E_kl: 23.97 -- val/charges_kl: 0.64 
Val loss: 28.4903 	 Best val loss:  28.2213

Val epoch 124 ends
Train epoch 124 ends
Epoch 124 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 127.9s 
Epoch 124: {'CarbonCE': 0.373, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 125
Train epoch 125 ends
Epoch 125 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 115.6s 
Epoch 125: {'CarbonCE': 0.37, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 126
Train epoch 126 ends
Epoch 126 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 113.9s 
Epoch 126: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 127
Train epoch 127 ends
Epoch 127 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.8s 
Epoch 127: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 128
Train epoch 128 ends
Epoch 128 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.2s 
Epoch 128: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 129
Epoch 129: val/epoch_NLL: 28.32 -- val/X_kl: 3.28 -- val/E_kl: 23.86 -- val/charges_kl: 0.63 
Val loss: 28.3244 	 Best val loss:  28.2213

Val epoch 129 ends
Train epoch 129 ends
Epoch 129 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 129.6s 
Epoch 129: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 130
Train epoch 130 ends
Epoch 130 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.1s 
Epoch 130: {'CarbonCE': 0.37, 'NitroCE': 0.218, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 131
Train epoch 131 ends
Epoch 131 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.4s 
Epoch 131: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 132
Train epoch 132 ends
Epoch 132 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.2s 
Epoch 132: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 133
Train epoch 133 ends
Epoch 133 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.9s 
Epoch 133: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 134
Epoch 134: val/epoch_NLL: 28.44 -- val/X_kl: 3.36 -- val/E_kl: 23.88 -- val/charges_kl: 0.64 
Val loss: 28.4419 	 Best val loss:  28.2213

Val epoch 134 ends
Train epoch 134 ends
Epoch 134 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 121.4s 
Epoch 134: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 135
Train epoch 135 ends
Epoch 135 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.8s 
Epoch 135: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 136
Train epoch 136 ends
Epoch 136 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.5s 
Epoch 136: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 137
Train epoch 137 ends
Epoch 137 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.3s 
Epoch 137: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 138
Train epoch 138 ends
Epoch 138 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.2s 
Epoch 138: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 139
Epoch 139: val/epoch_NLL: 28.29 -- val/X_kl: 3.32 -- val/E_kl: 23.78 -- val/charges_kl: 0.63 
Val loss: 28.2865 	 Best val loss:  28.2213

Val epoch 139 ends
Train epoch 139 ends
Epoch 139 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 121.0s 
Epoch 139: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 140
Train epoch 140 ends
Epoch 140 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.5s 
Epoch 140: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 141
Train epoch 141 ends
Epoch 141 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.4s 
Epoch 141: {'CarbonCE': 0.372, 'NitroCE': 0.217, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 142
Train epoch 142 ends
Epoch 142 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.0s 
Epoch 142: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 143
Train epoch 143 ends
Epoch 143 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.1s 
Epoch 143: {'CarbonCE': 0.374, 'NitroCE': 0.219, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 144
Epoch 144: val/epoch_NLL: 28.59 -- val/X_kl: 3.39 -- val/E_kl: 24.05 -- val/charges_kl: 0.61 
Val loss: 28.5937 	 Best val loss:  28.2213

Val epoch 144 ends
Train epoch 144 ends
Epoch 144 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 121.0s 
Epoch 144: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 145
Train epoch 145 ends
Epoch 145 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.5s 
Epoch 145: {'CarbonCE': 0.371, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 146
Train epoch 146 ends
Epoch 146 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.9s 
Epoch 146: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 147
Train epoch 147 ends
Epoch 147 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.4s 
Epoch 147: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 148
Train epoch 148 ends
Epoch 148 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.2s 
Epoch 148: {'CarbonCE': 0.373, 'NitroCE': 0.218, 'OxyCE': 0.274, 'FluorCE': 0.01} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 149
Epoch 149: val/epoch_NLL: 27.87 -- val/X_kl: 3.26 -- val/E_kl: 23.40 -- val/charges_kl: 0.65 
Val loss: 27.8654 	 Best val loss:  27.8654

Val epoch 149 ends
Metric val/epoch_NLL improved by 0.356 >= min_delta = 0.0001. New best score: 27.865
Train epoch 149 ends
Epoch 149 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 121.9s 
Epoch 149: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 150
Train epoch 150 ends
Epoch 150 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.0s 
Epoch 150: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 151
Train epoch 151 ends
Epoch 151 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.5s 
Epoch 151: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 152
Train epoch 152 ends
Epoch 152 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 113.7s 
Epoch 152: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 153
Train epoch 153 ends
Epoch 153 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.6s 
Epoch 153: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 154
Epoch 154: val/epoch_NLL: 28.58 -- val/X_kl: 3.32 -- val/E_kl: 24.05 -- val/charges_kl: 0.65 
Val loss: 28.5819 	 Best val loss:  27.8654

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch154/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch154/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch154/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch154/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch154/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch154/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch154/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch154/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch154/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch154/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch154_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch154_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch154_b50/graph_2.png to wandb
Done.
Sampling a batch with 206 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampled 2 batches on local rank 0. Sampling took 98.90 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 3, Kekulize 0, other 0,  -- No error 253
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: C#CC1(O)CC(=O)C1C CC12COC1CC(=O)O2 COC1C(O)C1C1CC1 O=C1NC2C[NH+]3C1CC23 CCC(=O)OC(C)C COCc1ncn(C)n1 ONc1cnc[nH]1 NC(=O)C=C1CC2CC12 OC1CC2CCC13CC23 COC1(C=O)CC=CC1

================================================================================
📊 CONSTRAINT SATISFACTION RESULTS
================================================================================

📋 **Definitions**:
• **FCD** — Fréchet ChemNet Distance computed on valid canonical SMILES; lower is better
• **Unique/Novel/Valid** — proportions computed over all generated molecules (not only valid)
• **Disconnected** — share of graphs with >1 connected component
• **Property satisfied** — share of generated graphs meeting the enforced structural constraint
• **V.U.N.** — product of Valid × Unique × Novel (in [0,100]%)

🔍 **LOGGING TO WANDB**:
============================================================
  val_sampling/NumNodesW1: 0.027726929634809494
  val_sampling/NodeTypesTV: 0.010419766418635845
  val_sampling/EdgeTypesTV: 0.0648539736866951
  val_sampling/Disconnected: 0.0
  val_sampling/MeanComponents: 1.0
  val_sampling/MaxComponents: 1.0
  val_sampling/planarity: 0.9921875
  val_sampling/no_cycles: 0.1328125
  val_sampling/lobster_components: 0.1328125
  val_sampling/generated_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4403b5e80>
  val_sampling/diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4403d4d90>
  val_sampling/abs_diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4403d4be0>
  val_sampling/Validity: 98.828125
  val_sampling/Uniqueness: 100.0
  val_sampling/Novelty: 90.51383137702942
  val_sampling/fcd score: 2.3658661385432467
============================================================


🎯 CORE METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+-------------------------+--------------------+
| Metric                  | Value                |
+-------------------------+--------------------+
| Molecules generated (N) | 256                  |
| FCD                     | 2.366                |
| Unique (%)              | 100.00%              |
| Novel (%)               | 90.51%               |
| Valid (%)               | 98.83%               |
| Disconnected (%)        | 0.00%                |
| Property satisfied (%)  | —                    |
| V.U.N. (%)              | 89.45%               |
+-------------------------+--------------------+


🏗️ STRUCTURAL CONSTRAINT SATISFACTION:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Structural
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+----------------------------+--------------------------+
| Metric                     | Value                      |
+----------------------------+--------------------------+
| Constraint                 | No structural constraint   |
| Cycle rank 0 (%)           | 13.3%                      |
| Cycle rank 1 (%)           | 35.5%                      |
| Cycle rank 2 (%)           | 33.6%                      |
| Cycle rank 3 (%)           | 13.7%                      |
| Cycle rank 4 (%)           | 3.5%                       |
| Cycle rank 5 (%)           | 0.4%                       |
| Cycle rank 6 (%)           | 0.0%                       |
| Cycle rank 7 (%)           | 0.0%                       |
| Cycle rank 8 (%)           | 0.0%                       |
| Cycle rank 9+ (%)          | 0.0%                       |
| Acyclic (max len 0) (%)    | 13.3%                      |
| Cycle length 3 (max) (%)   | 9.4%                       |
| Cycle length 4 (max) (%)   | 20.7%                      |
| Cycle length 5 (max) (%)   | 35.9%                      |
| Cycle length 6 (max) (%)   | 14.5%                      |
| Cycle length 7 (max) (%)   | 6.2%                       |
| Cycle length 8 (max) (%)   | 0.0%                       |
| Cycle length 9 (max) (%)   | 0.0%                       |
| Cycle length 10 (max) (%)  | 0.0%                       |
| Cycle length 11 (max) (%)  | 0.0%                       |
| Cycle length 12 (max) (%)  | 0.0%                       |
| Cycle length >12 (max) (%) | 0.0%                       |
+----------------------------+--------------------------+


⏱️ TIMING METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Timing
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------------------------------------+
| Metric                          | Value                                              |
+---------------------------------+--------------------------------------------------+
| Sampling time (s) for N         | 390.08 for N=256                                   |
| Per-graph sampling time (ms)    | 1523.7                                             |
| Sampling batches                | 8.00                                               |
| Projector mean time (ms)        | 0.0 (no projection)                                |
| Projector share of sampling (%) | 0.0% (no projection)                               |
| Wall-clock (h:mm)               | 04:58                                              |
| Environment                     | gpu=NVIDIA RTX A5000, torch=2.0.1+cu118, cuda=...  |
+---------------------------------+--------------------------------------------------+


🧪 CHEMISTRY METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Chemistry
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------+
| Metric                          | Value                |
+---------------------------------+--------------------+
| Valid molecules used (chem)     | 253                  |
| Molecular weight (Da) mean ± sd | 123.5 ± 6.9          |
| Heavy atoms mean ± sd           | 8.8 ± 0.5            |
| Atom composition % (C/N/O/F)    | 72.3/11.4/16.3/0.0   |
+---------------------------------+--------------------+

Val epoch 154 ends
Train epoch 154 ends
Epoch 154 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 223.0s 
Epoch 154: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 155
Train epoch 155 ends
Epoch 155 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.7s 
Epoch 155: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 156
Train epoch 156 ends
Epoch 156 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.7s 
Epoch 156: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 157
Train epoch 157 ends
Epoch 157 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.4s 
Epoch 157: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 158
Train epoch 158 ends
Epoch 158 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 114.6s 
Epoch 158: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 159
Epoch 159: val/epoch_NLL: 28.59 -- val/X_kl: 3.29 -- val/E_kl: 24.10 -- val/charges_kl: 0.64 
Val loss: 28.5868 	 Best val loss:  27.8654

Val epoch 159 ends
Train epoch 159 ends
Epoch 159 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 127.5s 
Epoch 159: {'CarbonCE': 0.372, 'NitroCE': 0.217, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 160
Train epoch 160 ends
Epoch 160 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.2s 
Epoch 160: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 161
Train epoch 161 ends
Epoch 161 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.4s 
Epoch 161: {'CarbonCE': 0.371, 'NitroCE': 0.219, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 162
Train epoch 162 ends
Epoch 162 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.2s 
Epoch 162: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 163
Train epoch 163 ends
Epoch 163 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 113.9s 
Epoch 163: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 164
Epoch 164: val/epoch_NLL: 28.43 -- val/X_kl: 3.32 -- val/E_kl: 23.91 -- val/charges_kl: 0.65 
Val loss: 28.4259 	 Best val loss:  27.8654

Val epoch 164 ends
Train epoch 164 ends
Epoch 164 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 124.7s 
Epoch 164: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 165
Train epoch 165 ends
Epoch 165 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.7s 
Epoch 165: {'CarbonCE': 0.373, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 166
Train epoch 166 ends
Epoch 166 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.2s 
Epoch 166: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.01} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 167
Train epoch 167 ends
Epoch 167 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.2s 
Epoch 167: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 168
Train epoch 168 ends
Epoch 168 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.1s 
Epoch 168: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 169
Epoch 169: val/epoch_NLL: 28.54 -- val/X_kl: 3.34 -- val/E_kl: 23.99 -- val/charges_kl: 0.65 
Val loss: 28.5360 	 Best val loss:  27.8654

Val epoch 169 ends
Train epoch 169 ends
Epoch 169 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 125.6s 
Epoch 169: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 170
Train epoch 170 ends
Epoch 170 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 114.5s 
Epoch 170: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 171
Train epoch 171 ends
Epoch 171 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 115.3s 
Epoch 171: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.349, 'DoubleCE': 0.071, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 172
Train epoch 172 ends
Epoch 172 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.6s 
Epoch 172: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 173
Train epoch 173 ends
Epoch 173 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.8s 
Epoch 173: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.373, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 174
Epoch 174: val/epoch_NLL: 28.19 -- val/X_kl: 3.33 -- val/E_kl: 23.66 -- val/charges_kl: 0.65 
Val loss: 28.1922 	 Best val loss:  27.8654

Val epoch 174 ends
Train epoch 174 ends
Epoch 174 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 122.7s 
Epoch 174: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.073, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 175
Train epoch 175 ends
Epoch 175 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.5s 
Epoch 175: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 176
Train epoch 176 ends
Epoch 176 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.8s 
Epoch 176: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 177
Train epoch 177 ends
Epoch 177 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.1s 
Epoch 177: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 178
Train epoch 178 ends
Epoch 178 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.4s 
Epoch 178: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 179
Epoch 179: val/epoch_NLL: 28.33 -- val/X_kl: 3.31 -- val/E_kl: 23.85 -- val/charges_kl: 0.64 
Val loss: 28.3344 	 Best val loss:  27.8654

Val epoch 179 ends
Train epoch 179 ends
Epoch 179 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 124.5s 
Epoch 179: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 180
Train epoch 180 ends
Epoch 180 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 113.8s 
Epoch 180: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.274, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 181
Train epoch 181 ends
Epoch 181 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.7s 
Epoch 181: {'CarbonCE': 0.37, 'NitroCE': 0.216, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 182
Train epoch 182 ends
Epoch 182 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 114.9s 
Epoch 182: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 183
Train epoch 183 ends
Epoch 183 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 115.6s 
Epoch 183: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 184
Epoch 184: val/epoch_NLL: 28.68 -- val/X_kl: 3.33 -- val/E_kl: 24.13 -- val/charges_kl: 0.67 
Val loss: 28.6767 	 Best val loss:  27.8654

Val epoch 184 ends
Train epoch 184 ends
Epoch 184 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 130.5s 
Epoch 184: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 185
Train epoch 185 ends
Epoch 185 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.0s 
Epoch 185: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 186
Train epoch 186 ends
Epoch 186 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.3s 
Epoch 186: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 187
Train epoch 187 ends
Epoch 187 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.4s 
Epoch 187: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 188
Train epoch 188 ends
Epoch 188 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.4s 
Epoch 188: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 189
Epoch 189: val/epoch_NLL: 28.10 -- val/X_kl: 3.27 -- val/E_kl: 23.67 -- val/charges_kl: 0.61 
Val loss: 28.1007 	 Best val loss:  27.8654

Val epoch 189 ends
Train epoch 189 ends
Epoch 189 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 126.2s 
Epoch 189: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 190
Train epoch 190 ends
Epoch 190 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.5s 
Epoch 190: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 191
Train epoch 191 ends
Epoch 191 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.2s 
Epoch 191: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 192
Train epoch 192 ends
Epoch 192 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.3s 
Epoch 192: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 193
Train epoch 193 ends
Epoch 193 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.4s 
Epoch 193: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 194
Epoch 194: val/epoch_NLL: 28.89 -- val/X_kl: 3.35 -- val/E_kl: 24.35 -- val/charges_kl: 0.64 
Val loss: 28.8857 	 Best val loss:  27.8654

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch194/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch194/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch194/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch194/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch194/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch194/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch194/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch194/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch194/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch194/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch194_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch194_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch194_b50/graph_2.png to wandb
Done.
Sampling a batch with 206 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampled 2 batches on local rank 0. Sampling took 99.10 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 1, Kekulize 0, other 0,  -- No error 255
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: N#CC12CC(=O)C[NH+]1C2 C#CC1CC(C)(C=O)O1 CCC1(O)C(=O)CC1C CC1OC1C1OC2CC21 COCC12C[NH2+]C1C2O [NH-]c1onc(O)c1N N#CC1OCC2(O)CC12 CC#CC1=CCC(=O)C1 O=CC1CC2CCC1O2 O=C1CC=CCCO1

================================================================================
📊 CONSTRAINT SATISFACTION RESULTS
================================================================================

📋 **Definitions**:
• **FCD** — Fréchet ChemNet Distance computed on valid canonical SMILES; lower is better
• **Unique/Novel/Valid** — proportions computed over all generated molecules (not only valid)
• **Disconnected** — share of graphs with >1 connected component
• **Property satisfied** — share of generated graphs meeting the enforced structural constraint
• **V.U.N.** — product of Valid × Unique × Novel (in [0,100]%)

🔍 **LOGGING TO WANDB**:
============================================================
  val_sampling/NumNodesW1: 0.031633179634809494
  val_sampling/NodeTypesTV: 0.009373003616929054
  val_sampling/EdgeTypesTV: 0.06817066669464111
  val_sampling/Disconnected: 0.0
  val_sampling/MeanComponents: 1.0
  val_sampling/MaxComponents: 1.0
  val_sampling/planarity: 1.0
  val_sampling/no_cycles: 0.11328125
  val_sampling/lobster_components: 0.11328125
  val_sampling/generated_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe46005bee0>
  val_sampling/diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe440368b80>
  val_sampling/abs_diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4403686d0>
  val_sampling/Validity: 99.609375
  val_sampling/Uniqueness: 100.0
  val_sampling/Novelty: 87.05882430076599
  val_sampling/fcd score: 2.4475668925492897
============================================================


🎯 CORE METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+-------------------------+--------------------+
| Metric                  | Value                |
+-------------------------+--------------------+
| Molecules generated (N) | 256                  |
| FCD                     | 2.448                |
| Unique (%)              | 100.00%              |
| Novel (%)               | 87.06%               |
| Valid (%)               | 99.61%               |
| Disconnected (%)        | 0.00%                |
| Property satisfied (%)  | —                    |
| V.U.N. (%)              | 86.72%               |
+-------------------------+--------------------+


🏗️ STRUCTURAL CONSTRAINT SATISFACTION:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Structural
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+----------------------------+--------------------------+
| Metric                     | Value                      |
+----------------------------+--------------------------+
| Constraint                 | No structural constraint   |
| Cycle rank 0 (%)           | 11.3%                      |
| Cycle rank 1 (%)           | 38.7%                      |
| Cycle rank 2 (%)           | 37.1%                      |
| Cycle rank 3 (%)           | 10.9%                      |
| Cycle rank 4 (%)           | 2.0%                       |
| Cycle rank 5 (%)           | 0.0%                       |
| Cycle rank 6 (%)           | 0.0%                       |
| Cycle rank 7 (%)           | 0.0%                       |
| Cycle rank 8 (%)           | 0.0%                       |
| Cycle rank 9+ (%)          | 0.0%                       |
| Acyclic (max len 0) (%)    | 11.3%                      |
| Cycle length 3 (max) (%)   | 12.9%                      |
| Cycle length 4 (max) (%)   | 23.0%                      |
| Cycle length 5 (max) (%)   | 34.4%                      |
| Cycle length 6 (max) (%)   | 13.7%                      |
| Cycle length 7 (max) (%)   | 3.9%                       |
| Cycle length 8 (max) (%)   | 0.8%                       |
| Cycle length 9 (max) (%)   | 0.0%                       |
| Cycle length 10 (max) (%)  | 0.0%                       |
| Cycle length 11 (max) (%)  | 0.0%                       |
| Cycle length 12 (max) (%)  | 0.0%                       |
| Cycle length >12 (max) (%) | 0.0%                       |
+----------------------------+--------------------------+


⏱️ TIMING METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Timing
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------------------------------------+
| Metric                          | Value                                              |
+---------------------------------+--------------------------------------------------+
| Sampling time (s) for N         | 489.14 for N=256                                   |
| Per-graph sampling time (ms)    | 1910.7                                             |
| Sampling batches                | 10.00                                              |
| Projector mean time (ms)        | 0.0 (no projection)                                |
| Projector share of sampling (%) | 0.0% (no projection)                               |
| Wall-clock (h:mm)               | 06:16                                              |
| Environment                     | gpu=NVIDIA RTX A5000, torch=2.0.1+cu118, cuda=...  |
+---------------------------------+--------------------------------------------------+


🧪 CHEMISTRY METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Chemistry
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------+
| Metric                          | Value                |
+---------------------------------+--------------------+
| Valid molecules used (chem)     | 255                  |
| Molecular weight (Da) mean ± sd | 123.8 ± 6.8          |
| Heavy atoms mean ± sd           | 8.8 ± 0.4            |
| Atom composition % (C/N/O/F)    | 72.7/11.1/15.9/0.3   |
+---------------------------------+--------------------+

Val epoch 194 ends
Train epoch 194 ends
Epoch 194 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 232.6s 
Epoch 194: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.371, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 195
Train epoch 195 ends
Epoch 195 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.4s 
Epoch 195: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 196
Train epoch 196 ends
Epoch 196 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.0s 
Epoch 196: {'CarbonCE': 0.37, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 197
Train epoch 197 ends
Epoch 197 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.2s 
Epoch 197: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 198
Train epoch 198 ends
Epoch 198 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 113.9s 
Epoch 198: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 199
Epoch 199: val/epoch_NLL: 28.29 -- val/X_kl: 3.32 -- val/E_kl: 23.80 -- val/charges_kl: 0.62 
Val loss: 28.2926 	 Best val loss:  27.8654

Val epoch 199 ends
Train epoch 199 ends
Epoch 199 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 129.0s 
Epoch 199: {'CarbonCE': 0.371, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 200
Train epoch 200 ends
Epoch 200 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.1s 
Epoch 200: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 201
Train epoch 201 ends
Epoch 201 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.8s 
Epoch 201: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 202
Train epoch 202 ends
Epoch 202 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.4s 
Epoch 202: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 203
Train epoch 203 ends
Epoch 203 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.8s 
Epoch 203: {'CarbonCE': 0.37, 'NitroCE': 0.216, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 204
Epoch 204: val/epoch_NLL: 28.12 -- val/X_kl: 3.34 -- val/E_kl: 23.58 -- val/charges_kl: 0.64 
Val loss: 28.1216 	 Best val loss:  27.8654

Val epoch 204 ends
Train epoch 204 ends
Epoch 204 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 132.4s 
Epoch 204: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 205
Train epoch 205 ends
Epoch 205 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 116.8s 
Epoch 205: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 206
Train epoch 206 ends
Epoch 206 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 118.2s 
Epoch 206: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 207
Train epoch 207 ends
Epoch 207 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.8s 
Epoch 207: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 208
Train epoch 208 ends
Epoch 208 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 113.4s 
Epoch 208: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 209
Epoch 209: val/epoch_NLL: 28.66 -- val/X_kl: 3.34 -- val/E_kl: 24.13 -- val/charges_kl: 0.63 
Val loss: 28.6571 	 Best val loss:  27.8654

Val epoch 209 ends
Train epoch 209 ends
Epoch 209 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 120.1s 
Epoch 209: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 210
Train epoch 210 ends
Epoch 210 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.4s 
Epoch 210: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 211
Train epoch 211 ends
Epoch 211 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.2s 
Epoch 211: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 212
Train epoch 212 ends
Epoch 212 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.9s 
Epoch 212: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 213
Train epoch 213 ends
Epoch 213 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.4s 
Epoch 213: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 214
Epoch 214: val/epoch_NLL: 28.22 -- val/X_kl: 3.32 -- val/E_kl: 23.73 -- val/charges_kl: 0.62 
Val loss: 28.2157 	 Best val loss:  27.8654

Val epoch 214 ends
Train epoch 214 ends
Epoch 214 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 124.2s 
Epoch 214: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 215
Train epoch 215 ends
Epoch 215 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 115.6s 
Epoch 215: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 216
Train epoch 216 ends
Epoch 216 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 118.1s 
Epoch 216: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.271, 'FluorCE': 0.01} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 217
Train epoch 217 ends
Epoch 217 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.3s 
Epoch 217: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 218
Train epoch 218 ends
Epoch 218 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 114.3s 
Epoch 218: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 219
Epoch 219: val/epoch_NLL: 28.26 -- val/X_kl: 3.34 -- val/E_kl: 23.72 -- val/charges_kl: 0.65 
Val loss: 28.2615 	 Best val loss:  27.8654

Val epoch 219 ends
Train epoch 219 ends
Epoch 219 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 121.0s 
Epoch 219: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 220
Train epoch 220 ends
Epoch 220 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.9s 
Epoch 220: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 221
Train epoch 221 ends
Epoch 221 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.8s 
Epoch 221: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 222
Train epoch 222 ends
Epoch 222 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.0s 
Epoch 222: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 223
Train epoch 223 ends
Epoch 223 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 114.9s 
Epoch 223: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 224
Epoch 224: val/epoch_NLL: 28.44 -- val/X_kl: 3.33 -- val/E_kl: 23.92 -- val/charges_kl: 0.65 
Val loss: 28.4445 	 Best val loss:  27.8654

Val epoch 224 ends
Train epoch 224 ends
Epoch 224 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 125.7s 
Epoch 224: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 225
Train epoch 225 ends
Epoch 225 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.6s 
Epoch 225: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 226
Train epoch 226 ends
Epoch 226 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.3s 
Epoch 226: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 227
Train epoch 227 ends
Epoch 227 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.8s 
Epoch 227: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 228
Train epoch 228 ends
Epoch 228 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 115.1s 
Epoch 228: {'CarbonCE': 0.37, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 229
Epoch 229: val/epoch_NLL: 28.46 -- val/X_kl: 3.31 -- val/E_kl: 23.98 -- val/charges_kl: 0.64 
Val loss: 28.4628 	 Best val loss:  27.8654

Val epoch 229 ends
Train epoch 229 ends
Epoch 229 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 123.8s 
Epoch 229: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 230
Train epoch 230 ends
Epoch 230 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.9s 
Epoch 230: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 231
Train epoch 231 ends
Epoch 231 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.3s 
Epoch 231: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 232
Train epoch 232 ends
Epoch 232 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.9s 
Epoch 232: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 233
Train epoch 233 ends
Epoch 233 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.7s 
Epoch 233: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 234
Epoch 234: val/epoch_NLL: 28.16 -- val/X_kl: 3.33 -- val/E_kl: 23.63 -- val/charges_kl: 0.64 
Val loss: 28.1592 	 Best val loss:  27.8654

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch234/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch234/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch234/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch234/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch234/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch234/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch234/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch234/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch234/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch234/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch234_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch234_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch234_b50/graph_2.png to wandb
Done.
Sampling a batch with 206 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampled 2 batches on local rank 0. Sampling took 97.71 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 0, Kekulize 0, other 0,  -- No error 256
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: C#CC(N)=CC(C)C#N [NH-]C1C=C2CCC2O1 COc1cnnoc1=O CC1CCOC1CC#N CC1(C(O)C2CC2)CN1 C#CC1NC1(C)C#N CCCC(C)C1CO1 C1CC2CC2CCO1 CNC1=NCOC1=O CC12CCC(C1)C2C#N

================================================================================
📊 CONSTRAINT SATISFACTION RESULTS
================================================================================

📋 **Definitions**:
• **FCD** — Fréchet ChemNet Distance computed on valid canonical SMILES; lower is better
• **Unique/Novel/Valid** — proportions computed over all generated molecules (not only valid)
• **Disconnected** — share of graphs with >1 connected component
• **Property satisfied** — share of generated graphs meeting the enforced structural constraint
• **V.U.N.** — product of Valid × Unique × Novel (in [0,100]%)

🔍 **LOGGING TO WANDB**:
============================================================
  val_sampling/NumNodesW1: 0.04593517258763313
  val_sampling/NodeTypesTV: 0.030107256025075912
  val_sampling/EdgeTypesTV: 0.06136596202850342
  val_sampling/Disconnected: 0.390625
  val_sampling/MeanComponents: 1.00390625
  val_sampling/MaxComponents: 2.0
  val_sampling/planarity: 0.99609375
  val_sampling/no_cycles: 0.12890625
  val_sampling/lobster_components: 0.12890625
  val_sampling/generated_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe448145700>
  val_sampling/diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4481d52e0>
  val_sampling/abs_diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4481d5cd0>
  val_sampling/Validity: 100.0
  val_sampling/Uniqueness: 100.0
  val_sampling/Novelty: 91.796875
  val_sampling/fcd score: 2.1891701782541375
============================================================


🎯 CORE METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+-------------------------+--------------------+
| Metric                  | Value                |
+-------------------------+--------------------+
| Molecules generated (N) | 256                  |
| FCD                     | 2.189                |
| Unique (%)              | 100.00%              |
| Novel (%)               | 91.80%               |
| Valid (%)               | 100.00%              |
| Disconnected (%)        | 39.06%               |
| Property satisfied (%)  | —                    |
| V.U.N. (%)              | 91.80%               |
+-------------------------+--------------------+


🏗️ STRUCTURAL CONSTRAINT SATISFACTION:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Structural
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+----------------------------+--------------------------+
| Metric                     | Value                      |
+----------------------------+--------------------------+
| Constraint                 | No structural constraint   |
| Cycle rank 0 (%)           | 12.9%                      |
| Cycle rank 1 (%)           | 34.8%                      |
| Cycle rank 2 (%)           | 35.5%                      |
| Cycle rank 3 (%)           | 13.3%                      |
| Cycle rank 4 (%)           | 3.1%                       |
| Cycle rank 5 (%)           | 0.4%                       |
| Cycle rank 6 (%)           | 0.0%                       |
| Cycle rank 7 (%)           | 0.0%                       |
| Cycle rank 8 (%)           | 0.0%                       |
| Cycle rank 9+ (%)          | 0.0%                       |
| Acyclic (max len 0) (%)    | 12.9%                      |
| Cycle length 3 (max) (%)   | 9.0%                       |
| Cycle length 4 (max) (%)   | 19.5%                      |
| Cycle length 5 (max) (%)   | 38.7%                      |
| Cycle length 6 (max) (%)   | 15.2%                      |
| Cycle length 7 (max) (%)   | 4.3%                       |
| Cycle length 8 (max) (%)   | 0.4%                       |
| Cycle length 9 (max) (%)   | 0.0%                       |
| Cycle length 10 (max) (%)  | 0.0%                       |
| Cycle length 11 (max) (%)  | 0.0%                       |
| Cycle length 12 (max) (%)  | 0.0%                       |
| Cycle length >12 (max) (%) | 0.0%                       |
+----------------------------+--------------------------+


⏱️ TIMING METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Timing
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------------------------------------+
| Metric                          | Value                                              |
+---------------------------------+--------------------------------------------------+
| Sampling time (s) for N         | 586.81 for N=256                                   |
| Per-graph sampling time (ms)    | 2292.2                                             |
| Sampling batches                | 12.00                                              |
| Projector mean time (ms)        | 0.0 (no projection)                                |
| Projector share of sampling (%) | 0.0% (no projection)                               |
| Wall-clock (h:mm)               | 07:34                                              |
| Environment                     | gpu=NVIDIA RTX A5000, torch=2.0.1+cu118, cuda=...  |
+---------------------------------+--------------------------------------------------+


🧪 CHEMISTRY METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Chemistry
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------+
| Metric                          | Value                |
+---------------------------------+--------------------+
| Valid molecules used (chem)     | 256                  |
| Molecular weight (Da) mean ± sd | 122.7 ± 7.7          |
| Heavy atoms mean ± sd           | 8.8 ± 0.5            |
| Atom composition % (C/N/O/F)    | 72.8/10.0/16.8/0.4   |
+---------------------------------+--------------------+

Val epoch 234 ends
Train epoch 234 ends
Epoch 234 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 223.9s 
Epoch 234: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 235
Train epoch 235 ends
Epoch 235 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.1s 
Epoch 235: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 236
Train epoch 236 ends
Epoch 236 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.9s 
Epoch 236: {'CarbonCE': 0.371, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 237
Train epoch 237 ends
Epoch 237 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.2s 
Epoch 237: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 238
Train epoch 238 ends
Epoch 238 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.4s 
Epoch 238: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 239
Epoch 239: val/epoch_NLL: 28.49 -- val/X_kl: 3.37 -- val/E_kl: 23.94 -- val/charges_kl: 0.64 
Val loss: 28.4878 	 Best val loss:  27.8654

Val epoch 239 ends
Train epoch 239 ends
Epoch 239 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 126.8s 
Epoch 239: {'CarbonCE': 0.37, 'NitroCE': 0.216, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 240
Train epoch 240 ends
Epoch 240 finished: X: 0.49 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.5s 
Epoch 240: {'CarbonCE': 0.373, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 241
Train epoch 241 ends
Epoch 241 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.1s 
Epoch 241: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 242
Train epoch 242 ends
Epoch 242 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.2s 
Epoch 242: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 243
Train epoch 243 ends
Epoch 243 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.9s 
Epoch 243: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.01} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 244
Epoch 244: val/epoch_NLL: 28.28 -- val/X_kl: 3.32 -- val/E_kl: 23.78 -- val/charges_kl: 0.63 
Val loss: 28.2827 	 Best val loss:  27.8654

Val epoch 244 ends
Train epoch 244 ends
Epoch 244 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 122.0s 
Epoch 244: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 245
Train epoch 245 ends
Epoch 245 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.2s 
Epoch 245: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 246
Train epoch 246 ends
Epoch 246 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 118.7s 
Epoch 246: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 247
Train epoch 247 ends
Epoch 247 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.3s 
Epoch 247: {'CarbonCE': 0.372, 'NitroCE': 0.217, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 248
Train epoch 248 ends
Epoch 248 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 116.0s 
Epoch 248: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 249
Epoch 249: val/epoch_NLL: 28.39 -- val/X_kl: 3.35 -- val/E_kl: 23.85 -- val/charges_kl: 0.64 
Val loss: 28.3860 	 Best val loss:  27.8654

Val epoch 249 ends
Train epoch 249 ends
Epoch 249 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 127.2s 
Epoch 249: {'CarbonCE': 0.369, 'NitroCE': 0.216, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 250
Train epoch 250 ends
Epoch 250 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 114.2s 
Epoch 250: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.351, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 251
Train epoch 251 ends
Epoch 251 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.2s 
Epoch 251: {'CarbonCE': 0.371, 'NitroCE': 0.219, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 252
Train epoch 252 ends
Epoch 252 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.4s 
Epoch 252: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 253
Train epoch 253 ends
Epoch 253 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.1s 
Epoch 253: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 254
Epoch 254: val/epoch_NLL: 28.17 -- val/X_kl: 3.33 -- val/E_kl: 23.65 -- val/charges_kl: 0.64 
Val loss: 28.1666 	 Best val loss:  27.8654

Val epoch 254 ends
Train epoch 254 ends
Epoch 254 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 126.7s 
Epoch 254: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 255
Train epoch 255 ends
Epoch 255 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 119.5s 
Epoch 255: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 256
Train epoch 256 ends
Epoch 256 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 115.9s 
Epoch 256: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 257
Train epoch 257 ends
Epoch 257 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 114.7s 
Epoch 257: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 258
Train epoch 258 ends
Epoch 258 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.8s 
Epoch 258: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 259
Epoch 259: val/epoch_NLL: 28.49 -- val/X_kl: 3.32 -- val/E_kl: 23.99 -- val/charges_kl: 0.64 
Val loss: 28.4851 	 Best val loss:  27.8654

Val epoch 259 ends
Train epoch 259 ends
Epoch 259 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 131.7s 
Epoch 259: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 260
Train epoch 260 ends
Epoch 260 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.0s 
Epoch 260: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 261
Train epoch 261 ends
Epoch 261 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.0s 
Epoch 261: {'CarbonCE': 0.372, 'NitroCE': 0.219, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 262
Train epoch 262 ends
Epoch 262 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.5s 
Epoch 262: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 263
Train epoch 263 ends
Epoch 263 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 114.6s 
Epoch 263: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 264
Epoch 264: val/epoch_NLL: 28.33 -- val/X_kl: 3.33 -- val/E_kl: 23.80 -- val/charges_kl: 0.66 
Val loss: 28.3293 	 Best val loss:  27.8654

Val epoch 264 ends
Train epoch 264 ends
Epoch 264 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 122.1s 
Epoch 264: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 265
Train epoch 265 ends
Epoch 265 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.1s 
Epoch 265: {'CarbonCE': 0.369, 'NitroCE': 0.217, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 266
Train epoch 266 ends
Epoch 266 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.7s 
Epoch 266: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 267
Train epoch 267 ends
Epoch 267 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 106.9s 
Epoch 267: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 268
Train epoch 268 ends
Epoch 268 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.3s 
Epoch 268: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 269
Epoch 269: val/epoch_NLL: 28.30 -- val/X_kl: 3.31 -- val/E_kl: 23.79 -- val/charges_kl: 0.65 
Val loss: 28.3000 	 Best val loss:  27.8654

Val epoch 269 ends
Train epoch 269 ends
Epoch 269 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 119.4s 
Epoch 269: {'CarbonCE': 0.369, 'NitroCE': 0.216, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 270
Train epoch 270 ends
Epoch 270 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.8s 
Epoch 270: {'CarbonCE': 0.371, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 271
Train epoch 271 ends
Epoch 271 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 107.8s 
Epoch 271: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 272
Train epoch 272 ends
Epoch 272 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.5s 
Epoch 272: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 273
Train epoch 273 ends
Epoch 273 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.3s 
Epoch 273: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 274
Epoch 274: val/epoch_NLL: 28.22 -- val/X_kl: 3.26 -- val/E_kl: 23.78 -- val/charges_kl: 0.63 
Val loss: 28.2193 	 Best val loss:  27.8654

Sampling start
Sampling a batch with 50 graphs on local rank 0. Saving 50 visualization and 10 full chains.
Batch sampled. Visualizing chains starts!
1/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch274/batch50_GR0/molecule_50_0.gif to wandb
2/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch274/batch50_GR0/molecule_51_0.gif to wandb
3/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch274/batch50_GR0/molecule_52_0.gif to wandb
4/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch274/batch50_GR0/molecule_53_0.gif to wandb
5/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch274/batch50_GR0/molecule_54_0.gif to wandb
6/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch274/batch50_GR0/molecule_55_0.gif to wandb
7/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch274/batch50_GR0/molecule_56_0.gif to wandb
8/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch274/batch50_GR0/molecule_57_0.gif to wandb
9/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch274/batch50_GR0/molecule_58_0.gif to wandb
10/10 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch274/batch50_GR0/molecule_59_0.gif to wandb
Visualizing 50 graphs out of 50
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch274_b50/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch274_b50/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch274_b50/graph_2.png to wandb
Done.
Sampling a batch with 206 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampled 2 batches on local rank 0. Sampling took 138.60 seconds

Computing sampling metrics on 0...
Error messages: AtomValence 1, Kekulize 0, other 0,  -- No error 255
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: CC1CC(O)C2(C)CC12 C[NH+]1CC1C(=O)C1CO1 OC12COC3C(C1)C32O COC1CN(C=N)C1=O OC1CCc2[nH]ncc21 CC1CCC(O)C1C N#CC12NC3CC1C32O CC1(CO)C2[NH2+]CC[NH+]21 CC1OC=CC(O)=C1N O=C1CC2OC2CN1

================================================================================
📊 CONSTRAINT SATISFACTION RESULTS
================================================================================

📋 **Definitions**:
• **FCD** — Fréchet ChemNet Distance computed on valid canonical SMILES; lower is better
• **Unique/Novel/Valid** — proportions computed over all generated molecules (not only valid)
• **Disconnected** — share of graphs with >1 connected component
• **Property satisfied** — share of generated graphs meeting the enforced structural constraint
• **V.U.N.** — product of Valid × Unique × Novel (in [0,100]%)

🔍 **LOGGING TO WANDB**:
============================================================
  val_sampling/NumNodesW1: 0.03956300765275955
  val_sampling/NodeTypesTV: 0.027600040659308434
  val_sampling/EdgeTypesTV: 0.06043784320354462
  val_sampling/Disconnected: 0.0
  val_sampling/MeanComponents: 1.0
  val_sampling/MaxComponents: 1.0
  val_sampling/planarity: 1.0
  val_sampling/no_cycles: 0.08203125
  val_sampling/lobster_components: 0.08203125
  val_sampling/generated_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe44804a460>
  val_sampling/diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe44804ab80>
  val_sampling/abs_diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe44804aee0>
  val_sampling/Validity: 99.609375
  val_sampling/Uniqueness: 100.0
  val_sampling/Novelty: 89.01960849761963
  val_sampling/fcd score: 2.2416077630527624
============================================================


🎯 CORE METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+-------------------------+--------------------+
| Metric                  | Value                |
+-------------------------+--------------------+
| Molecules generated (N) | 256                  |
| FCD                     | 2.242                |
| Unique (%)              | 100.00%              |
| Novel (%)               | 89.02%               |
| Valid (%)               | 99.61%               |
| Disconnected (%)        | 0.00%                |
| Property satisfied (%)  | —                    |
| V.U.N. (%)              | 88.67%               |
+-------------------------+--------------------+


🏗️ STRUCTURAL CONSTRAINT SATISFACTION:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Structural
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+----------------------------+--------------------------+
| Metric                     | Value                      |
+----------------------------+--------------------------+
| Constraint                 | No structural constraint   |
| Cycle rank 0 (%)           | 8.2%                       |
| Cycle rank 1 (%)           | 37.9%                      |
| Cycle rank 2 (%)           | 36.7%                      |
| Cycle rank 3 (%)           | 14.8%                      |
| Cycle rank 4 (%)           | 2.3%                       |
| Cycle rank 5 (%)           | 0.0%                       |
| Cycle rank 6 (%)           | 0.0%                       |
| Cycle rank 7 (%)           | 0.0%                       |
| Cycle rank 8 (%)           | 0.0%                       |
| Cycle rank 9+ (%)          | 0.0%                       |
| Acyclic (max len 0) (%)    | 8.2%                       |
| Cycle length 3 (max) (%)   | 7.8%                       |
| Cycle length 4 (max) (%)   | 22.7%                      |
| Cycle length 5 (max) (%)   | 40.2%                      |
| Cycle length 6 (max) (%)   | 16.0%                      |
| Cycle length 7 (max) (%)   | 5.1%                       |
| Cycle length 8 (max) (%)   | 0.0%                       |
| Cycle length 9 (max) (%)   | 0.0%                       |
| Cycle length 10 (max) (%)  | 0.0%                       |
| Cycle length 11 (max) (%)  | 0.0%                       |
| Cycle length 12 (max) (%)  | 0.0%                       |
| Cycle length >12 (max) (%) | 0.0%                       |
+----------------------------+--------------------------+


⏱️ TIMING METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Timing
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------------------------------------+
| Metric                          | Value                                              |
+---------------------------------+--------------------------------------------------+
| Sampling time (s) for N         | 725.38 for N=256                                   |
| Per-graph sampling time (ms)    | 2833.5                                             |
| Sampling batches                | 14.00                                              |
| Projector mean time (ms)        | 0.0 (no projection)                                |
| Projector share of sampling (%) | 0.0% (no projection)                               |
| Wall-clock (h:mm)               | 08:53                                              |
| Environment                     | gpu=NVIDIA RTX A5000, torch=2.0.1+cu118, cuda=...  |
+---------------------------------+--------------------------------------------------+


🧪 CHEMISTRY METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — VAL — QM9 — Chemistry
Constraint: No structural constraint · N=256 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------+
| Metric                          | Value                |
+---------------------------------+--------------------+
| Valid molecules used (chem)     | 255                  |
| Molecular weight (Da) mean ± sd | 122.1 ± 8.2          |
| Heavy atoms mean ± sd           | 8.8 ± 0.6            |
| Atom composition % (C/N/O/F)    | 73.7/10.6/15.5/0.2   |
+---------------------------------+--------------------+

Val epoch 274 ends
Train epoch 274 ends
Epoch 274 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 265.7s 
Epoch 274: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 275
Train epoch 275 ends
Epoch 275 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.4s 
Epoch 275: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 276
Train epoch 276 ends
Epoch 276 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.7s 
Epoch 276: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 277
Train epoch 277 ends
Epoch 277 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.3s 
Epoch 277: {'CarbonCE': 0.369, 'NitroCE': 0.216, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 278
Train epoch 278 ends
Epoch 278 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 109.3s 
Epoch 278: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 279
Epoch 279: val/epoch_NLL: 28.05 -- val/X_kl: 3.28 -- val/E_kl: 23.58 -- val/charges_kl: 0.64 
Val loss: 28.0537 	 Best val loss:  27.8654

Val epoch 279 ends
Train epoch 279 ends
Epoch 279 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 122.8s 
Epoch 279: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 280
Train epoch 280 ends
Epoch 280 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 108.2s 
Epoch 280: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 281
Train epoch 281 ends
Epoch 281 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.3s 
Epoch 281: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 282
Train epoch 282 ends
Epoch 282 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 120.2s 
Epoch 282: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 283
Train epoch 283 ends
Epoch 283 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 117.7s 
Epoch 283: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 284
Epoch 284: val/epoch_NLL: 28.21 -- val/X_kl: 3.27 -- val/E_kl: 23.75 -- val/charges_kl: 0.64 
Val loss: 28.2119 	 Best val loss:  27.8654

Val epoch 284 ends
Train epoch 284 ends
Epoch 284 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 127.4s 
Epoch 284: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 285
Train epoch 285 ends
Epoch 285 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 111.8s 
Epoch 285: {'CarbonCE': 0.372, 'NitroCE': 0.218, 'OxyCE': 0.273, 'FluorCE': 0.009} -- {'NoBondCE': 0.372, 'SingleCE': 0.35, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 286
Train epoch 286 ends
Epoch 286 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 110.0s 
Epoch 286: {'CarbonCE': 0.37, 'NitroCE': 0.218, 'OxyCE': 0.271, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 287
Train epoch 287 ends
Epoch 287 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 120.3s 
Epoch 287: {'CarbonCE': 0.37, 'NitroCE': 0.217, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.37, 'SingleCE': 0.348, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 288
Train epoch 288 ends
Epoch 288 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 112.9s 
Epoch 288: {'CarbonCE': 0.371, 'NitroCE': 0.218, 'OxyCE': 0.272, 'FluorCE': 0.009} -- {'NoBondCE': 0.371, 'SingleCE': 0.349, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
Starting epoch 289
Epoch 289: val/epoch_NLL: 28.58 -- val/X_kl: 3.38 -- val/E_kl: 24.01 -- val/charges_kl: 0.64 
Val loss: 28.5762 	 Best val loss:  27.8654

Val epoch 289 ends
Monitored metric val/epoch_NLL did not improve in the last 28 records. Best score: 27.865. Signaling Trainer to stop.
Train epoch 289 ends
Epoch 289 finished: X: 0.48 -- charges: 0.08 -- E: 0.44 -- y: -1.00 -- 121.9s 
Epoch 289: {'CarbonCE': 0.369, 'NitroCE': 0.217, 'OxyCE': 0.27, 'FluorCE': 0.009} -- {'NoBondCE': 0.369, 'SingleCE': 0.347, 'DoubleCE': 0.072, 'TripleCE': 0.026, 'AromaticCE': 0.0}
[rank: 0] Global seed set to 0
You are using a CUDA device ('NVIDIA RTX A5000') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:                           epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:                train/AromaticCE █▄▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  train/CarbonCE █▇▅▅▄▄▄▃▃▂▄▂▃▃▂▂▂▃▃▂▂▂▂▂▂▂▂▂▁▂▂▃▂▂▃▁▂▂▂▁
wandb:                  train/DoubleCE █▇▅▆▄▃▄▄▃▄▄▂▃▃▂▂▂▃▄▂▄▃▃▂▃▁▂▂▁▂▃▃▂▂▃▁▂▂▁▁
wandb:                   train/FluorCE ██▆▆▃▃▅▃▃▅▂▃▄▁▃▂▃▄▂▂▆▄▄▂▂▆▄▃▄▂▃▄▂▅▄▂▃▃▃▁
wandb:                   train/NitroCE █▇▅▅▄▄▅▄▃▃▄▄▃▃▂▂▂▄▄▂▃▂▃▂▃▂▂▃▁▂▃▄▂▃▂▂▂▃▃▂
wandb:                  train/NoBondCE ██▆▆▄▅▅▄▃▃▄▂▃▅▃▃▂▄▃▂▃▂▃▂▂▁▃▃▁▂▂▃▂▂▃▂▂▃▂▁
wandb:                     train/OxyCE █▇▆▆▄▄▄▃▃▃▃▁▄▄▃▃▂▃▃▂▂▂▃▃▃▂▂▂▁▁▃▃▂▂▃▁▂▃▁▂
wandb:                  train/SingleCE ██▆▆▄▄▅▄▃▃▄▂▃▄▃▃▂▄▃▂▃▂▃▂▂▁▂▃▁▂▂▂▂▂▃▂▂▃▂▁
wandb:                  train/TripleCE ██▅▅▄▄▇▅▃▄▂▂▂▇▃▃▄▅▄▃▅▁▅▃▃▃▂▄▃▂▄▃▁▅▅▃▃▄▄▄
wandb:                train_epoch/E_CE ██▆▆▄▄▅▄▃▃▄▂▃▄▂▃▂▄▃▂▃▂▃▂▂▁▂▃▁▁▂▃▂▂▃▂▂▃▂▁
wandb:          train_epoch/charges_CE ██▅▅▅▄▆▄▃▃▃▄▄▄▄▃▃▄▃▃▃▄▃▄▃▃▃▃▁▃▂▃▄▁▂▃▄▄▂▃
wandb:     train_epoch/epochAromaticCE █▄▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       train_epoch/epochCarbonCE ██▅▅▄▄▄▃▃▂▃▂▃▃▂▂▂▃▃▂▃▂▂▂▂▂▂▂▁▂▂▃▂▂▃▁▂▂▂▂
wandb:       train_epoch/epochDoubleCE █▇▅▅▄▃▄▄▃▃▃▂▃▃▂▂▁▃▃▂▄▃▃▂▂▁▂▂▁▁▂▃▂▂▃▁▂▂▁▁
wandb:        train_epoch/epochFluorCE ██▆▅▃▃▅▃▃▅▂▃▅▂▃▂▃▄▂▂▆▄▄▂▂▆▄▃▄▂▂▅▂▅▄▂▄▄▃▁
wandb:        train_epoch/epochNitroCE █▇▅▅▄▄▅▄▃▃▄▄▃▃▂▂▂▅▄▃▃▂▃▃▃▂▂▄▁▂▃▄▂▃▂▂▂▃▃▂
wandb:       train_epoch/epochNoBondCE ██▆▆▅▅▅▄▃▃▄▂▃▅▃▃▂▄▃▂▃▂▃▂▂▁▃▃▁▂▂▃▂▂▃▂▂▃▂▁
wandb:          train_epoch/epochOxyCE █▇▆▅▄▄▄▃▃▃▃▁▄▄▃▃▃▃▃▂▂▂▃▃▃▂▂▂▁▁▃▃▂▂▃▂▂▃▂▂
wandb:       train_epoch/epochSingleCE ██▆▆▄▄▅▄▃▃▄▂▃▄▃▃▂▄▃▂▃▂▃▂▂▁▂▃▁▂▂▂▂▂▃▂▂▃▂▁
wandb:       train_epoch/epochTripleCE ██▅▅▅▄▇▅▃▄▂▂▂▇▃▃▄▅▃▄▅▁▅▃▃▃▂▅▃▁▄▄▁▅▅▃▂▄▄▄
wandb:                train_epoch/x_CE █▇▅▅▄▄▄▃▃▃▃▂▃▃▂▂▂▄▃▂▃▂▂▂▂▂▂▂▁▁▂▃▂▂▂▁▂▂▂▁
wandb:                train_epoch/y_CE ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 train_loss/E_CE ██▆▆▄▄▅▄▃▃▄▂▃▄▂▃▂▄▃▂▃▂▃▂▂▁▂▃▁▁▂▂▂▂▃▂▂▃▂▁
wandb:                 train_loss/X_CE █▇▅▅▄▄▄▃▃▃▃▂▃▃▂▂▂▃▃▂▃▂▂▂▂▂▂▂▁▁▂▃▂▂▂▁▂▂▂▁
wandb:           train_loss/batch_loss ▇▅▃▅▇▃▅▄▆▃▅▄▁▇▇▆▅▅▄▅█▅▅▇▅▇▆▅▄▇▄▄▆▆▅▆▁▆▆▃
wandb:           train_loss/charges_CE ██▅▅▅▄▆▄▃▃▃▄▄▄▄▃▃▄▃▃▃▄▃▃▃▃▃▃▁▃▂▃▄▁▂▃▄▄▂▃
wandb:                 train_loss/y_CE ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                        val/E_kl █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                        val/X_kl █▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val/charges_kl █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                   val/epoch_NLL █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:               val_ratio/average ▅█▄▃▄▁▂
wandb:             val_ratio/fcd score ▅█▄▃▄▁▂
wandb:           val_sampling/ChargeW1 ▅▇▁▇▃▂█
wandb:       val_sampling/Disconnected ▁█▆▁▁▃▁
wandb:        val_sampling/EdgeTypesTV ▄▁▂▅█▂▁
wandb:      val_sampling/MaxComponents ▁██▁▁█▁
wandb:     val_sampling/MeanComponents ▁█▆▁▁▃▁
wandb:        val_sampling/NodeTypesTV ▃█▂▁▁▄▄
wandb:            val_sampling/Novelty █▇▄▅▁▆▃
wandb:         val_sampling/NumNodesW1 ▁▁▇▄▅█▇
wandb:         val_sampling/Uniqueness ▁▁▁▁▁▁▁
wandb:          val_sampling/ValencyW1 █▅▁▂▆▂█
wandb:           val_sampling/Validity ▆█▁▁▆█▆
wandb:          val_sampling/fcd score ▅█▄▃▄▁▂
wandb: val_sampling/lobster_components ▂▇▃█▅▇▁
wandb:          val_sampling/no_cycles ▂▇▃█▅▇▁
wandb:          val_sampling/planarity █▅█▁█▅█
wandb: 
wandb: Run summary:
wandb:                           epoch 289
wandb:                train/AromaticCE 0.0
wandb:                  train/CarbonCE 0.36925
wandb:                  train/DoubleCE 0.07186
wandb:                   train/FluorCE 0.00907
wandb:                   train/NitroCE 0.21735
wandb:                  train/NoBondCE 0.3689
wandb:                     train/OxyCE 0.27031
wandb:                  train/SingleCE 0.34711
wandb:                  train/TripleCE 0.02583
wandb:                train_epoch/E_CE 0.43679
wandb:          train_epoch/charges_CE 0.08234
wandb:     train_epoch/epochAromaticCE 0.0
wandb:       train_epoch/epochCarbonCE 0.36938
wandb:       train_epoch/epochDoubleCE 0.07188
wandb:        train_epoch/epochFluorCE 0.0091
wandb:        train_epoch/epochNitroCE 0.21733
wandb:       train_epoch/epochNoBondCE 0.36902
wandb:          train_epoch/epochOxyCE 0.27043
wandb:       train_epoch/epochSingleCE 0.34723
wandb:       train_epoch/epochTripleCE 0.02583
wandb:                train_epoch/x_CE 0.48068
wandb:                train_epoch/y_CE -1.0
wandb:                 train_loss/E_CE 2.18326
wandb:                 train_loss/X_CE 0.48054
wandb:           train_loss/batch_loss 2.67188
wandb:           train_loss/charges_CE 0.16493
wandb:                 train_loss/y_CE -1.0
wandb:                        val/E_kl 24.01267
wandb:                        val/X_kl 3.38057
wandb:                  val/charges_kl 0.63603
wandb:                   val/epoch_NLL 28.57623
wandb:               val_ratio/average 2.59777
wandb:             val_ratio/fcd score 2.59777
wandb:           val_sampling/ChargeW1 0.01264
wandb:       val_sampling/Disconnected 0.0
wandb:        val_sampling/EdgeTypesTV 0.06044
wandb:      val_sampling/MaxComponents 1.0
wandb:     val_sampling/MeanComponents 1.0
wandb:        val_sampling/NodeTypesTV 0.0276
wandb:            val_sampling/Novelty 89.01961
wandb:         val_sampling/NumNodesW1 0.03956
wandb:         val_sampling/Uniqueness 100.0
wandb:          val_sampling/ValencyW1 0.05574
wandb:           val_sampling/Validity 99.60938
wandb:          val_sampling/fcd score 2.24161
wandb: val_sampling/lobster_components 0.08203
wandb:          val_sampling/no_cycles 0.08203
wandb:          val_sampling/planarity 1.0
wandb: 
wandb: 🚀 View run qm9_thesis_no_constraint_marginal at: https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9/runs/7o8tnyba
wandb: Synced 6 W&B file(s), 490 media file(s), 0 artifact file(s) and 10 other file(s)
wandb: Find logs at: ./wandb/run-20250816_022721-7o8tnyba/logs
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.21.1 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /extra/rislek/ConStruct-Thesis/ConStruct/wandb/run-20250816_114904-m5mdq4p6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run qm9_thesis_no_constraint_marginal
wandb: ⭐️ View project at https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9
wandb: 🚀 View run at https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9/runs/m5mdq4p6
Test loss: 28.4148
Epoch 290: test/epoch_NLL: 28.4148 -- test/X_kl: 3.3824 -- test/E_kl: 23.8745 -- test/charges_kl: 0.6022 
Sampling start on GR0
Samples to generate: 10000 for each of the 1 devices
Samples to save: 1000
Sampling a batch with 230 graphs on local rank 0. Saving 230 visualization and 200 full chains.
Batch sampled. Visualizing chains starts!
1/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_230_0.gif to wandb
2/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_231_0.gif to wandb
3/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_232_0.gif to wandb
4/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_233_0.gif to wandb
5/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_234_0.gif to wandb
6/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_235_0.gif to wandb
7/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_236_0.gif to wandb
8/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_237_0.gif to wandb
9/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_238_0.gif to wandb
10/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_239_0.gif to wandb
11/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_240_0.gif to wandb
12/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_241_0.gif to wandb
13/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_242_0.gif to wandb
14/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_243_0.gif to wandb
15/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_244_0.gif to wandb
16/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_245_0.gif to wandb
17/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_246_0.gif to wandb
18/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_247_0.gif to wandb
19/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_248_0.gif to wandb
20/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_249_0.gif to wandb
21/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_250_0.gif to wandb
22/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_251_0.gif to wandb
23/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_252_0.gif to wandb
24/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_253_0.gif to wandb
25/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_254_0.gif to wandb
26/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_255_0.gif to wandb
27/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_256_0.gif to wandb
28/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_257_0.gif to wandb
29/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_258_0.gif to wandb
30/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_259_0.gif to wandb
31/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_260_0.gif to wandb
32/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_261_0.gif to wandb
33/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_262_0.gif to wandb
34/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_263_0.gif to wandb
35/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_264_0.gif to wandb
36/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_265_0.gif to wandb
37/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_266_0.gif to wandb
38/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_267_0.gif to wandb
39/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_268_0.gif to wandb
40/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_269_0.gif to wandb
41/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_270_0.gif to wandb
42/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_271_0.gif to wandb
43/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_272_0.gif to wandb
44/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_273_0.gif to wandb
45/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_274_0.gif to wandb
46/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_275_0.gif to wandb
47/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_276_0.gif to wandb
48/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_277_0.gif to wandb
49/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_278_0.gif to wandb
50/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_279_0.gif to wandb
51/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_280_0.gif to wandb
52/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_281_0.gif to wandb
53/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_282_0.gif to wandb
54/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_283_0.gif to wandb
55/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_284_0.gif to wandb
56/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_285_0.gif to wandb
57/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_286_0.gif to wandb
58/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_287_0.gif to wandb
59/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_288_0.gif to wandb
60/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_289_0.gif to wandb
61/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_290_0.gif to wandb
62/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_291_0.gif to wandb
63/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_292_0.gif to wandb
64/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_293_0.gif to wandb
65/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_294_0.gif to wandb
66/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_295_0.gif to wandb
67/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_296_0.gif to wandb
68/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_297_0.gif to wandb
69/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_298_0.gif to wandb
70/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_299_0.gif to wandb
71/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_300_0.gif to wandb
72/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_301_0.gif to wandb
73/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_302_0.gif to wandb
74/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_303_0.gif to wandb
75/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_304_0.gif to wandb
76/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_305_0.gif to wandb
77/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_306_0.gif to wandb
78/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_307_0.gif to wandb
79/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_308_0.gif to wandb
80/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_309_0.gif to wandb
81/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_310_0.gif to wandb
82/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_311_0.gif to wandb
83/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_312_0.gif to wandb
84/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_313_0.gif to wandb
85/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_314_0.gif to wandb
86/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_315_0.gif to wandb
87/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_316_0.gif to wandb
88/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_317_0.gif to wandb
89/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_318_0.gif to wandb
90/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_319_0.gif to wandb
91/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_320_0.gif to wandb
92/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_321_0.gif to wandb
93/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_322_0.gif to wandb
94/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_323_0.gif to wandb
95/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_324_0.gif to wandb
96/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_325_0.gif to wandb
97/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_326_0.gif to wandb
98/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_327_0.gif to wandb
99/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_328_0.gif to wandb
100/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_329_0.gif to wandb
101/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_330_0.gif to wandb
102/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_331_0.gif to wandb
103/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_332_0.gif to wandb
104/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_333_0.gif to wandb
105/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_334_0.gif to wandb
106/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_335_0.gif to wandb
107/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_336_0.gif to wandb
108/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_337_0.gif to wandb
109/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_338_0.gif to wandb
110/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_339_0.gif to wandb
111/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_340_0.gif to wandb
112/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_341_0.gif to wandb
113/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_342_0.gif to wandb
114/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_343_0.gif to wandb
115/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_344_0.gif to wandb
116/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_345_0.gif to wandb
117/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_346_0.gif to wandb
118/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_347_0.gif to wandb
119/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_348_0.gif to wandb
120/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_349_0.gif to wandb
121/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_350_0.gif to wandb
122/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_351_0.gif to wandb
123/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_352_0.gif to wandb
124/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_353_0.gif to wandb
125/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_354_0.gif to wandb
126/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_355_0.gif to wandb
127/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_356_0.gif to wandb
128/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_357_0.gif to wandb
129/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_358_0.gif to wandb
130/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_359_0.gif to wandb
131/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_360_0.gif to wandb
132/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_361_0.gif to wandb
133/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_362_0.gif to wandb
134/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_363_0.gif to wandb
135/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_364_0.gif to wandb
136/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_365_0.gif to wandb
137/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_366_0.gif to wandb
138/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_367_0.gif to wandb
139/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_368_0.gif to wandb
140/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_369_0.gif to wandb
141/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_370_0.gif to wandb
142/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_371_0.gif to wandb
143/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_372_0.gif to wandb
144/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_373_0.gif to wandb
145/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_374_0.gif to wandb
146/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_375_0.gif to wandb
147/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_376_0.gif to wandb
148/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_377_0.gif to wandb
149/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_378_0.gif to wandb
150/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_379_0.gif to wandb
151/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_380_0.gif to wandb
152/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_381_0.gif to wandb
153/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_382_0.gif to wandb
154/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_383_0.gif to wandb
155/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_384_0.gif to wandb
156/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_385_0.gif to wandb
157/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_386_0.gif to wandb
158/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_387_0.gif to wandb
159/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_388_0.gif to wandb
160/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_389_0.gif to wandb
161/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_390_0.gif to wandb
162/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_391_0.gif to wandb
163/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_392_0.gif to wandb
164/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_393_0.gif to wandb
165/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_394_0.gif to wandb
166/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_395_0.gif to wandb
167/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_396_0.gif to wandb
168/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_397_0.gif to wandb
169/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_398_0.gif to wandb
170/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_399_0.gif to wandb
171/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_400_0.gif to wandb
172/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_401_0.gif to wandb
173/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_402_0.gif to wandb
174/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_403_0.gif to wandb
175/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_404_0.gif to wandb
176/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_405_0.gif to wandb
177/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_406_0.gif to wandb
178/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_407_0.gif to wandb
179/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_408_0.gif to wandb
180/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_409_0.gif to wandb
181/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_410_0.gif to wandb
182/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_411_0.gif to wandb
183/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_412_0.gif to wandb
184/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_413_0.gif to wandb
185/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_414_0.gif to wandb
186/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_415_0.gif to wandb
187/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_416_0.gif to wandb
188/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_417_0.gif to wandb
189/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_418_0.gif to wandb
190/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_419_0.gif to wandb
191/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_420_0.gif to wandb
192/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_421_0.gif to wandb
193/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_422_0.gif to wandb
194/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_423_0.gif to wandb
195/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_424_0.gif to wandb
196/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_425_0.gif to wandb
197/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_426_0.gif to wandb
198/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_427_0.gif to wandb
199/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_428_0.gif to wandb
200/200 chains saved on local rank 0.Saving /extra/rislek/ConStruct-Thesis/ConStruct/chains/epoch290/batch230_GR0/molecule_429_0.gif to wandb
Visualizing 230 graphs out of 230
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b230/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b230/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b230/graph_2.png to wandb
Done.
Sampling a batch with 230 graphs on local rank 0. Saving 230 visualization and 0 full chains.
Visualizing 230 graphs out of 230
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b460/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b460/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b460/graph_2.png to wandb
Done.
Sampling a batch with 230 graphs on local rank 0. Saving 230 visualization and 0 full chains.
Visualizing 230 graphs out of 230
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b690/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b690/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b690/graph_2.png to wandb
Done.
Sampling a batch with 230 graphs on local rank 0. Saving 230 visualization and 0 full chains.
Visualizing 230 graphs out of 230
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b920/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b920/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b920/graph_2.png to wandb
Done.
Sampling a batch with 80 graphs on local rank 0. Saving 80 visualization and 0 full chains.
Visualizing 80 graphs out of 80
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b1000/graph_0.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b1000/graph_1.png to wandb
Saving /extra/rislek/ConStruct-Thesis/ConStruct/graphs/qm9_thesis_no_constraint_marginal/epoch290_b1000/graph_2.png to wandb
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 231 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Sampling a batch with 222 graphs on local rank 0. Saving 0 visualization and 0 full chains.
Done.
Saving the generated graphs
Saved.
📊 Computing final sampling metrics...
Error messages: AtomValence 122, Kekulize 0, other 0,  -- No error 9878
[rank: 0] Received SIGTERM: 15
[rank: 0] Received SIGTERM: 15
Bypassing SIGTERM: 15
Bypassing SIGTERM: 15
Some generated smiles: N#CC1C(CO)C2NC12 CCC(O)C1CC1CO CCC1(C)CCCC1=O CC12CC3CCCC1C32 C1OC2C3CC2C32OC12 CCC(=O)C1C[NH+]1CC N#CCC(=O)CC1CN1 C#CC(C)(O)C(C)CC [NH-][C+](O)OCC(F)(F)F [NH-]C(C#CCN)OC=O

================================================================================
📊 CONSTRAINT SATISFACTION RESULTS
================================================================================

📋 **Definitions**:
• **FCD** — Fréchet ChemNet Distance computed on valid canonical SMILES; lower is better
• **Unique/Novel/Valid** — proportions computed over all generated molecules (not only valid)
• **Disconnected** — share of graphs with >1 connected component
• **Property satisfied** — share of generated graphs meeting the enforced structural constraint
• **V.U.N.** — product of Valid × Unique × Novel (in [0,100]%)

🔍 **LOGGING TO WANDB**:
============================================================
  test_sampling/NumNodesW1: 0.007581339683383703
  test_sampling/NodeTypesTV: 0.0064049335196614265
  test_sampling/EdgeTypesTV: 0.061579253524541855
  test_sampling/Disconnected: 0.419999985024333
  test_sampling/MeanComponents: 1.0041999816894531
  test_sampling/MaxComponents: 2.0
  test_sampling/planarity: 0.9968000054359436
  test_sampling/no_cycles: 0.09730000048875809
  test_sampling/lobster_components: 0.09730000048875809
  test_sampling/generated_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4704351f0>
  test_sampling/diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe4704353a0>
  test_sampling/abs_diff_deg_hist: <wandb.sdk.data_types.histogram.Histogram object at 0x7fe470371fa0>
  test_sampling/Validity: 98.78000020980835
  test_sampling/Uniqueness: 97.02368900587163
  test_sampling/Novelty: 87.59390711784363
  test_sampling/fcd score: 0.9862916091993021
============================================================


🎯 CORE METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — TEST — QM9
Constraint: No structural constraint · N=10,000 · diffusion_steps=500 · sampler=reverse

+-------------------------+--------------------+
| Metric                  | Value                |
+-------------------------+--------------------+
| Molecules generated (N) | 10,000               |
| FCD                     | 0.986                |
| Unique (%)              | 97.02%               |
| Novel (%)               | 87.59%               |
| Valid (%)               | 98.78%               |
| Disconnected (%)        | 42.00%               |
| Property satisfied (%)  | —                    |
| V.U.N. (%)              | 83.95%               |
+-------------------------+--------------------+


🏗️ STRUCTURAL CONSTRAINT SATISFACTION:
================================================================================
qm9_thesis_no_constraint_marginal — TEST — QM9 — Structural
Constraint: No structural constraint · N=10,000 · diffusion_steps=500 · sampler=reverse

+----------------------------+--------------------------+
| Metric                     | Value                      |
+----------------------------+--------------------------+
| Constraint                 | No structural constraint   |
| Cycle rank 0 (%)           | 9.7%                       |
| Cycle rank 1 (%)           | 38.2%                      |
| Cycle rank 2 (%)           | 32.7%                      |
| Cycle rank 3 (%)           | 15.7%                      |
| Cycle rank 4 (%)           | 3.3%                       |
| Cycle rank 5 (%)           | 0.4%                       |
| Cycle rank 6 (%)           | 0.0%                       |
| Cycle rank 7 (%)           | 0.0%                       |
| Cycle rank 8 (%)           | 0.0%                       |
| Cycle rank 9+ (%)          | 0.0%                       |
| Acyclic (max len 0) (%)    | 9.7%                       |
| Cycle length 3 (max) (%)   | 10.2%                      |
| Cycle length 4 (max) (%)   | 22.6%                      |
| Cycle length 5 (max) (%)   | 35.8%                      |
| Cycle length 6 (max) (%)   | 15.8%                      |
| Cycle length 7 (max) (%)   | 5.0%                       |
| Cycle length 8 (max) (%)   | 1.0%                       |
| Cycle length 9 (max) (%)   | 0.0%                       |
| Cycle length 10 (max) (%)  | 0.0%                       |
| Cycle length 11 (max) (%)  | 0.0%                       |
| Cycle length 12 (max) (%)  | 0.0%                       |
| Cycle length >12 (max) (%) | 0.0%                       |
+----------------------------+--------------------------+


⏱️ TIMING METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — TEST — QM9 — Timing
Constraint: No structural constraint · N=10,000 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------------------------------------+
| Metric                          | Value                                              |
+---------------------------------+--------------------------------------------------+
| Sampling time (s) for N         | 2563.42 for N=10,000                               |
| Per-graph sampling time (ms)    | 256.3                                              |
| Sampling batches                | 44.00                                              |
| Projector mean time (ms)        | 0.0 (no projection)                                |
| Projector share of sampling (%) | 0.0% (no projection)                               |
| Wall-clock (h:mm)               | 10:05                                              |
| Environment                     | gpu=NVIDIA RTX A5000, torch=2.0.1+cu118, cuda=...  |
+---------------------------------+--------------------------------------------------+


🧪 CHEMISTRY METRICS:
================================================================================
qm9_thesis_no_constraint_marginal — TEST — QM9 — Chemistry
Constraint: No structural constraint · N=10,000 · diffusion_steps=500 · sampler=reverse

+---------------------------------+--------------------+
| Metric                          | Value                |
+---------------------------------+--------------------+
| Valid molecules used (chem)     | 9,878                |
| Molecular weight (Da) mean ± sd | 122.6 ± 7.8          |
| Heavy atoms mean ± sd           | 8.8 ± 0.5            |
| Atom composition % (C/N/O/F)    | 72.4/11.7/15.6/0.3   |
+---------------------------------+--------------------+

All smiles saved on rank 0
Done. Sampling took 2608.19 seconds

Test ends.
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:                        test/E_kl ▁
wandb:                        test/X_kl ▁
wandb:                  test/charges_kl ▁
wandb:                   test/epoch_NLL ▁
wandb:               test_ratio/average ▁
wandb:             test_ratio/fcd score ▁
wandb:           test_sampling/ChargeW1 ▁
wandb:       test_sampling/Disconnected ▁
wandb:        test_sampling/EdgeTypesTV ▁
wandb:      test_sampling/MaxComponents ▁
wandb:     test_sampling/MeanComponents ▁
wandb:        test_sampling/NodeTypesTV ▁
wandb:            test_sampling/Novelty ▁
wandb:         test_sampling/NumNodesW1 ▁
wandb:         test_sampling/Uniqueness ▁
wandb:          test_sampling/ValencyW1 ▁
wandb:           test_sampling/Validity ▁
wandb:          test_sampling/fcd score ▁
wandb: test_sampling/lobster_components ▁
wandb:          test_sampling/no_cycles ▁
wandb:          test_sampling/planarity ▁
wandb: 
wandb: Run summary:
wandb:                        test/E_kl 23.87447
wandb:                        test/X_kl 3.38238
wandb:                  test/charges_kl 0.60216
wandb:                   test/epoch_NLL 28.4148
wandb:               test_ratio/average 1.143
wandb:             test_ratio/fcd score 1.143
wandb:           test_sampling/ChargeW1 0.00237
wandb:       test_sampling/Disconnected 0.42
wandb:        test_sampling/EdgeTypesTV 0.06158
wandb:      test_sampling/MaxComponents 2.0
wandb:     test_sampling/MeanComponents 1.0042
wandb:        test_sampling/NodeTypesTV 0.0064
wandb:            test_sampling/Novelty 87.59391
wandb:         test_sampling/NumNodesW1 0.00758
wandb:         test_sampling/Uniqueness 97.02369
wandb:          test_sampling/ValencyW1 0.03124
wandb:           test_sampling/Validity 98.78
wandb:          test_sampling/fcd score 0.98629
wandb: test_sampling/lobster_components 0.0973
wandb:          test_sampling/no_cycles 0.0973
wandb:          test_sampling/planarity 0.9968
wandb: 
wandb: 🚀 View run qm9_thesis_no_constraint_marginal at: https://wandb.ai/islekrana-universit-di-padova/ConStruct_qm9/runs/m5mdq4p6
wandb: Synced 6 W&B file(s), 1400 media file(s), 0 artifact file(s) and 10 other file(s)
wandb: Find logs at: ./wandb/run-20250816_114904-m5mdq4p6/logs
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        test/E_kl           23.874469757080078
        test/X_kl           3.3823790550231934
     test/charges_kl         0.602161169052124
     test/epoch_NLL          28.41480255126953
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Experiment completed at Sat 16 Aug 2025 12:33:09 PM UTC
