# @package _global_
general:
  name: 'qm9_debug_ring_count_at_most_1'
  wandb: 'online'
  resume: null
  test_only: null
  check_val_every_n_epochs: 3  # More frequent validation
  sample_every_val: 1          # Sample every validation
  samples_to_generate: 50      # More samples for better evaluation
  samples_to_save: 20          # More samples to save
  chains_to_save: 5            # More chains for analysis
  final_model_samples_to_generate: 100  # More final samples
  final_model_samples_to_save: 50       # More final samples
  final_model_chains_to_save: 20        # More final chains
  number_chain_steps: 200      # More chain steps for better visualization
train:
  n_epochs: 20                 # More epochs for better convergence
  batch_size: 32               # Smaller batch for better gradient estimates
  lr: 0.00005                  # Very conservative learning rate
  save_model: true
model:
  diffusion_steps: 300         # More diffusion steps for better constraint satisfaction
  n_layers: 4                  # More layers for better capacity
  hidden_mlp_dims:
    X: 128                     # Larger for better capacity
    E: 64                      # Larger for better capacity
    y: 64                      # Larger for better capacity
  hidden_dims:
    dx: 128                    # Larger for better capacity
    de: 64                     # Larger for better capacity
    dy: 64                     # Larger for better capacity
    n_head: 4                  # More attention heads
    dim_ffX: 256               # Larger feedforward
    dim_ffE: 128               # Larger feedforward
    dim_ffy: 128               # Larger feedforward
  # Edge-deletion constraint settings:
  max_rings: 1                    # Maximum 1 ring allowed
  rev_proj: ring_count_at_most    # Edge-deletion projector for "at most" constraints
  transition: absorbing_edges      # Edge-deletion transition
dataset:
  name: qm9
  remove_h: true
  datadir: data/qm9
  batch_size: 32                # Match train batch size
  num_workers: 4                # More workers for better data loading
  adaptive_loader: false
  fraction: 0.8                 # Larger fraction for better learning
